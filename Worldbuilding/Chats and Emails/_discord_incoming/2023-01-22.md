# Discord DM – 2023-01-22

[2023-01-22 02:56 PM] Deciusmus: is this expected:
    C:\Users\msackton\personal\OneDrive\taelgar>`python _scripts\convert_markdown.py --date 1719 --campaign Clee --dir  C:\Users\msackton\personal\OneDrive\taelgar\_publishSupport\output\md
    In file C:\Users\msackton\personal\OneDrive\taelgar\_publishSupport\output\md\People\Chardonians\Albus.md, couldn't parse filter at line: `%%`^Date:1748-08-05`%%`
[2023-01-22 02:57 PM] rsulfuratus: ah. yes, the filter assumes just a single YYYY for date. that is easy to change. running for Isaac now but will push a change later this afternoon
[2023-01-22 02:59 PM] Deciusmus: Also, is your publish workflow basically:
    
    1. run obsidianhtml convert with compile_html false
    2. run convert_markdown
    3. run obsidianhtml with compile_md false
    
    ?
[2023-01-22 02:59 PM] rsulfuratus: yes
[2023-01-22 02:59 PM] rsulfuratus: the convert markdown replaces files in place
[2023-01-22 03:00 PM] Deciusmus: I had to make one bugfix to how it reads/writes files
[2023-01-22 03:00 PM] Deciusmus: to explicitly pass in UTF-8 rather than assuming
[2023-01-22 03:04 PM] rsulfuratus: you should be able to fix the date thing by changing this line: 
    `re.search(r'^(.*?)`%%`\^(`[A-Za-z]`+):\s*(\w+)\s*`%%`', line)`
    to:
    `re.search(r'^(.*?)`%%`\^(`[A-Za-z]`+):\s*(w+).*?\s*`%%`', line)`
[2023-01-22 03:05 PM] rsulfuratus: need to test to make sure it doesn't break anything else
[2023-01-22 03:13 PM] Deciusmus: I might not muck around with regex
[2023-01-22 03:13 PM] Deciusmus: but I did fix it to read the current fantasy calendar data
[2023-01-22 03:14 PM] Deciusmus: although you can still pass in a date
[2023-01-22 03:14 PM] Deciusmus: if you want
[2023-01-22 03:16 PM] Deciusmus: --configDir C:\Users\msackton\personal\OneDrive\taelgar\.obsidian
[2023-01-22 03:16 PM] Deciusmus: will cause it to read the json file that fantasy calendar uses
[2023-01-22 03:16 PM] Deciusmus: for the date
[2023-01-22 03:16 PM] Deciusmus: date is now optional
[2023-01-22 03:17 PM] Deciusmus: it errors if you don't specfiy one or the other
[2023-01-22 03:18 PM] Deciusmus: I also fixed it to not error on get_CurrentWhereabouts
[2023-01-22 03:18 PM] Deciusmus: as that is expected to return ""
[2023-01-22 03:21 PM] Deciusmus: on the date stuff, if I pass in 1719-10-21 it gets confused for the current year calculations.
[2023-01-22 03:21 PM] Deciusmus: so just fixing the regex isn't enough
[2023-01-22 03:22 PM] rsulfuratus: right, need to either strip the month/day from the input date and fix the regex or capture full date in both and compare. will fix it later
[2023-01-22 03:22 PM] rsulfuratus: input_date.split("-")]`0]` should work to use year/year comparisons only
[2023-01-22 03:56 PM] rsulfuratus: can you push changes you made to export script?
[2023-01-22 04:47 PM] rsulfuratus: pushed changes to markdown export that should allow YYYY-MM-DD dates in both the input date and the `%%`^Date:`%%` lines. The month and day are ignored, though, so if you have a `%%`^Date:1750-05-01`%%` filter and pass 1750-01-01 as a date, it will still print. if this seems like a useful use case, it is possible to change this
[2023-01-22 04:48 PM] rsulfuratus: also note that the filters for the python script need to start `%%`^ not just `%%`, I added the ^ to avoid the (unlikely) edge case where there is a `%%`Date (some comment text) `%%` edge case
[2023-01-22 04:49 PM] rsulfuratus: so I changed the header template to output `%%`^Campaign:`%%` and `%%`^End`%%` as expected by the python script
[2023-01-22 05:09 PM] rsulfuratus: On a separate topic, I've been playing around with timelines. The obsidian timeline plugin is kind of unsatisfying - it requires that you encode events to display as `<span>``</span>` or `<div>``</div>` elements, which breaks a lot of stuff (e.g., you can't have links in them) and is also a pain to generate.
[2023-01-22 05:10 PM] rsulfuratus: I have a python script that takes a csv file and can generate one note for each row in various ways; this allows me to make an event for each day using fantasy calendar very easily, but then it is not really easy to do much with them
[2023-01-22 05:13 PM] rsulfuratus: I am kind of wondering if a templater template is the best option - the basic idea would be that if you want to insert a timeline/chronology segment into a note, you'd have a template that would figure it out and generate static markdown. in theory given that there would be fc-date: 1747-04-05 or whatever in the metadata it shouldn't be too difficult to find the right notes with dataview, but not sure how easy it is to work with dataview in templater, e.g. get a list of notes matching some criteria and then do some text processing on them
[2023-01-22 05:14 PM] rsulfuratus: there are basically three use cases:
    1) inserting timeline/chronology segments into session notes, which would depend on finding all notes with fantasy dates between a start and end range, and then extracting the correct text (e.g., everything under a ## campaignname header), reformating, and inserting
[2023-01-22 05:17 PM] rsulfuratus: 2) doing the same, but for NPC chronology sections, where start and end might be irrelevant but you want something like every line that mentioned NPC name
[2023-01-22 05:18 PM] rsulfuratus: 3) would be just making a static chronology/timeline page for a specific campaign, just nicer than the kind of ugly formatting that obsidian timeline uses by default. this wouldn't be frequently regenerated
[2023-01-22 05:19 PM] rsulfuratus: the other option is just keeping the official timeline as csv and having a python script that regenerates notes as needed, whenever the timeline is updated...
[2023-01-22 05:19 PM] rsulfuratus: anyway curious about your thoughts
[2023-01-22 07:31 PM] Deciusmus: For events that are happening during a game/in the timeframe of a game, I think the fantasy calendar tagging system (with fc-date and fc-end) and small articles for each "event" makes a lot of sense
[2023-01-22 07:31 PM] Deciusmus: From there, I'm not sure how much it is worth figuring out how to insert them into some other note
[2023-01-22 07:32 PM] Deciusmus: I guess from my perspective, where I am starting a new campaign, my plan would be to just integrate the events into my session note as I write it
[2023-01-22 07:34 PM] Deciusmus: So for example "Celyn and Najeer Garay play dice for a bit in the evening, and hear some rumors about the tragic flood. "
[2023-01-22 07:34 PM] Deciusmus: where tragic flood is linked to an event note
[2023-01-22 07:35 PM] Deciusmus: I can see them all nicely on the fantasy calendar in obsidian, and I don't see a huge need to publish a calendar online as the goal is more for me to keep track
[2023-01-22 07:35 PM] Deciusmus: (and I can make articles for things I know are going to happen as part of session prep and have them available during the game at certain future dates)
[2023-01-22 07:36 PM] Deciusmus: The other place I would want timelines is for "grand sweep of history" stuff, which is where I was hoping to use the timeline plugin, but where it wasn't great
[2023-01-22 07:37 PM] Deciusmus: But the Fantasy Calendar stuff isn't great for that because I don't want to have to make up an exact date, i.e. you might have an event that took place in the 1420s without needing to be more exact
[2023-01-22 07:42 PM] Deciusmus: I guess I'm not sure it is worth doing anything complicated. I guess you are talking about stuff like this https://tsackton.github.io/taelgarverse/Campaigns/Dunmari%20Frontier/Session%20Notes/Session%2051-52%20(DuFr).html
[2023-01-22 07:42 PM] Deciusmus: hrm
[2023-01-22 07:47 PM] rsulfuratus: Yeah that sort of thing. I actually was looking a bit and I think a python script to write static markdown is probably the easiest. It is annoying because you would need to run it outside obsidian but for moving text from one note to another, for example, it is tough to beat just simple text processing via external programs
[2023-01-22 07:48 PM] rsulfuratus: But this isn’t really the sort of thing that would be dynamic - I would use fantasy calendar for that. So I would just update when I export session notes or something
[2023-01-22 08:12 PM] Deciusmus: I guess my main thought would be to keep it a bit external to the obsidian worfklow
[2023-01-22 08:12 PM] Deciusmus: i.e. I don't think I'd use your python script at all
[2023-01-22 08:13 PM] Deciusmus: i.e. if I was adding a section to say, Vistra Fireforge about an event from the Ausson's Crossing mini-series, I would just write the text in her note and link to the event page
[2023-01-22 08:13 PM] Deciusmus: So if you had your "source of truth" in an external file that would be a bit annoying as you'd overwrite when you ran it again
[2023-01-22 08:14 PM] Deciusmus: I will say having an event type is probably a good idea:
    
    type: event
    fc-date:
    fc-end:
    peoplePresent: `[]`
    location: 
    campaign:
[2023-01-22 08:14 PM] Deciusmus: or something like that
[2023-01-22 08:14 PM] Deciusmus: although I'm not sure you even need the campaign
[2023-01-22 08:14 PM] Deciusmus: but I'm not sure how often I'd bother to set say the peoplePresent
[2023-01-22 08:15 PM] Deciusmus: which would mostly be useful if you wanted to generate a dataview-based chronology of a person

