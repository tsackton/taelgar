# Discord DM – 2023-11-29

[2023-11-29 08:54 AM] rsulfuratus: you vindristjarna room page is great, i love it
[2023-11-29 11:25 AM] Deciusmus: I had a few min, so I implemented a new formatting feature: prefix and suffix
    
    `<(prefix)key:format(suffix)>`
[2023-11-29 11:25 AM] Deciusmus: prefix and suffix only added if key has a value
[2023-11-29 11:25 AM] Deciusmus: so
    
    `<(of )primary>`
    
    means if there is a primary value, add of primary, else nothing
[2023-11-29 11:26 AM] Deciusmus: or 
    
    `<(()pronouns())>` means add (he/him) or nothing
[2023-11-29 12:37 PM] rsulfuratus: at some point, i think we need to think a bit about locations like "traveling to Tokra", since I'm not actually sure the capital letter parsing is the correct framework here.
[2023-11-29 12:39 PM] rsulfuratus: I'd argue that there are two distinct things:
    (a) page is in location at time, but you want some flavor text, e.g. imprisoned in Stormcaller Tower
    (b) page is in a location that is not represented by a note, either because it is not a fixed location (sailing to Skaerhem; traveling to Chardon), or because it is an area that doesn't really have a name or any kind of detail (plains east of Tokra)
[2023-11-29 12:39 PM] rsulfuratus: (a) is probably correctly handled with prefix/suffix data - location is Stormcaller Tower, prefix is "imprisoned in"
[2023-11-29 12:40 PM] rsulfuratus: (b) is probably correctly handled by just not expanding the chain. someone who is traveling to Tokra isn't in Tokra and shouldn't show up on a list of NPCs in Tokra, for example
[2023-11-29 12:42 PM] rsulfuratus: but, i'm not sure that string formatting is the best way to handle this. this is what i think a normalized name object would be good for. prefix/suffix is great for changing "in The InnName" to "at TheInnName"
[2023-11-29 12:43 PM] rsulfuratus: anyway, super busy today and also still have session prep, so not going to do anything on this
[2023-11-29 12:48 PM] rsulfuratus: but I would argue for:
    (a) a concept of a normalized name, that provides a universal object interface to handle getting the actual file something represents, as well as linking, display text, title, article, and other name-related topics
    (b) concept of approximate locations that are text descriptions without a location chain, or that imply a different location chain, e.g., perhaps "traveling to Tokra (Central Dunmar area)" or something
    (c) string formatting primarily to replace prepositions, although how much do you use this instead of just replacing the preposition in the displayDefault string? you have to retype the entire string to replace the default prepositions anyway. i guess for whereabouts it could be nice if you can override on a per-whereabout-line basis
[2023-11-29 12:49 PM] rsulfuratus: i guess lumping the prepositions into string formatting helps with trimming extraneous bits of text
[2023-11-29 12:51 PM] Deciusmus: The main goal of the string formatting is to have the default strings be able to be simpler
[2023-11-29 12:51 PM] Deciusmus: i.e dropping the of
[2023-11-29 12:52 PM] Deciusmus: for example, I made the location default something like
    
    ancestry subtype type of primary in current
[2023-11-29 12:52 PM] Deciusmus: so 
    
    a Dunmari monstery of Bhisma in Kharsan
[2023-11-29 12:52 PM] Deciusmus: but it is a pain to drop the of / in easily
[2023-11-29 12:54 PM] Deciusmus: without the prefix / suffix
[2023-11-29 01:17 PM] Deciusmus: So I agree about normalized name (mostly this would be moving the upper casing and article stuff to name manager from string formatter)
[2023-11-29 01:19 PM] Deciusmus: I also agree that whereabouts would really benefit from a "prefix" / "suffix" which is added to the whereabout (i.e. for imprisoned in, trapped in, etc) vs the idea of a whereabout that represents a non-page place
[2023-11-29 01:19 PM] Deciusmus: I do think that for non-page places, I like the "travelling to Embry, Sembara" but that the "in location" checks shouldn't follow the capitalized pieces
[2023-11-29 01:20 PM] Deciusmus: but otherwise, I'd guess the capitalization rule would largely work
[2023-11-29 01:21 PM] Deciusmus: i.e. you'd like to be able to define:
    
    { location: Stormcaller Tower, prefix: trapped in }
    
    which would cause the "current" or "home" or "origin" for that page to display
    
    trapped in Stormcaller Tower
    
    this is different from the location
    
    near Stormcaller Tower
    
    which implies the person is NOT in storm caller tower (but might imply they ARE in the parent location of storm caller tower)
[2023-11-29 01:21 PM] Deciusmus: although it is probably ok for people with vague locations to be considered "no where" as far as dataview queries go
[2023-11-29 01:22 PM] Deciusmus: (and if you wanted, you could always do something like
    
    location: Sembara, locationDisplay: travelling to Embry
    
    which would cause data view searches to find the location as Sembara, but display it as travelling to Embry
    )
[2023-11-29 01:23 PM] Deciusmus: The other piece that comes up a lot is the preposition. If a string is
    
    Met by `<person>` on `<target>` in `<current>`
    
    you'd really like the "in" to come from the `<current>` rather than the format string
[2023-11-29 01:24 PM] Deciusmus: That solves the "in/on" problem
[2023-11-29 01:29 PM] Deciusmus: Which is to say, I'd propose the following set of features:
    
    1. Introduce a "prefix" on a whereabout line. If set, it is prepended to the lcoation for display, but otherwise has no impact on the location searches or other logic about "where" something is
    
    2. Introduce a "prepositionFor" display default which defaults to "in" for places and "" for everything else. It might be nicer to wait to do this until we have a normalized name manager, because you'd like this to be like casing/formatting. That is, the name manager should have an article option of none, prepositional, definite, indefinite (or similar) that can map to format strings with reasonable defaults.
    
    This is to enable changing: 
    `<met:u>` by `<person>` on `<target>` in `<current:3r>`
    
    To
    
    `<met:u>` by `<person>` on `<target>` `<current:3r>`
    
    And having the in/on generated correctly.
    
    
    3. Make sure that the isInLocation logic stops following if the name doesn't match i.e. the capital letter stuff is only for display, not for in-location checks
[2023-11-29 01:30 PM] Deciusmus: The key thing is that the preposition stuff is a property of the *location* whereas the prefix is a property of the whereabout
[2023-11-29 01:51 PM] rsulfuratus: generally yes, agree. I think the prepositions are a bit tricky. e.g. for a location that is "The Singing Fox", you might want:
    Based in: Fairgate Outer, Tollen (`<home:fr>`)
    Last seen by party at The Singing Fox, Tollen ("at `<current:1>`, `<current:3>`")
[2023-11-29 01:52 PM] rsulfuratus: but even if you didn't skip the inn for based in, you probably don't want:
    Based in: at The Singing Fox, Fairgate Outer, Tollen
[2023-11-29 01:53 PM] rsulfuratus: So I guess it implies that the preposition needs to be a property of the location and the type (origin/home etc)
[2023-11-29 01:54 PM] rsulfuratus: which feels complicated
[2023-11-29 01:54 PM] Deciusmus: its just a format specifier
[2023-11-29 01:54 PM] Deciusmus: p = include preposition (default is to not)
[2023-11-29 01:55 PM] rsulfuratus: right but the point is whether you include the preposition feels like it depends on whether the location is origin, home, current
[2023-11-29 01:55 PM] Deciusmus: no, it depends on the format string
[2023-11-29 01:55 PM] Deciusmus: "wHome": "Based in: `<home:3r>`",
                "wPast": "`<end:u>` in `<current:3r>`",
[2023-11-29 01:56 PM] Deciusmus: 1st one - no preposition
[2023-11-29 01:56 PM] Deciusmus: 2nd one - yes
[2023-11-29 01:56 PM] Deciusmus: i.e. you modify the 2nd string to be
    
    `<end:u>` `<current:3rp>`
[2023-11-29 01:56 PM] Deciusmus: (ignore that p is already used)
[2023-11-29 01:56 PM] Deciusmus: then it generates died at The Singing Fox
[2023-11-29 01:57 PM] Deciusmus: and you have one less case where you need to do a display override to get the right thing
[2023-11-29 01:57 PM] Deciusmus: the only problem it is intended to solve is to reduce display overrides
[2023-11-29 01:57 PM] rsulfuratus: but it introduces the new problem you need to set prepositions? i'm not sure which is less typing
[2023-11-29 01:57 PM] Deciusmus: well, the default would be "in"
[2023-11-29 01:58 PM] Deciusmus: so you only need to do so if you don't like in
[2023-11-29 01:58 PM] rsulfuratus: ah okay I see
[2023-11-29 01:58 PM] rsulfuratus: the displayDefault is in The Singing Fox ala defArt
[2023-11-29 01:58 PM] Deciusmus: right
[2023-11-29 01:58 PM] rsulfuratus: I thought you were setting the preposition in the whereabout line
[2023-11-29 01:58 PM] Deciusmus: no
[2023-11-29 01:59 PM] Deciusmus: that would be hard to use, agreed
[2023-11-29 01:59 PM] rsulfuratus: I would change wHome to "Based `<home:3rp>`" then
[2023-11-29 01:59 PM] Deciusmus: right
[2023-11-29 02:00 PM] rsulfuratus: Based in X vs Based in: X kind of meanless but it gets you Based on the Emerald Song naturally
[2023-11-29 02:00 PM] Deciusmus: yeah
[2023-11-29 02:00 PM] rsulfuratus: Originally from probably stays, if you want "Born at sea on the Emerald Song" you need to set wOrigin
[2023-11-29 02:00 PM] Deciusmus: right
[2023-11-29 02:00 PM] Deciusmus: (unless you change origin to `<startStatus>` `<origin>`
[2023-11-29 02:01 PM] Deciusmus: But I like Originally from: better than "Born in"
[2023-11-29 02:01 PM] rsulfuratus: yeah I do to, i'd leave that
[2023-11-29 02:01 PM] Deciusmus: So I think I'd leave it
[2023-11-29 02:02 PM] Deciusmus: you could make the default preposition for a person "by"
[2023-11-29 02:02 PM] Deciusmus: which would also be nice
[2023-11-29 02:02 PM] Deciusmus: because then item origin could just be
    
    `<start>` `<origin>`
    
    and you get
    
    Created in Kharsan
    
    or 
    
    Created by Grash
    
    automatically
[2023-11-29 02:02 PM] rsulfuratus: yeah
[2023-11-29 02:03 PM] rsulfuratus: depending on how complicated, i'd also introduce automatic preposition insertion when you switch type in a location chain
[2023-11-29 02:03 PM] rsulfuratus: e.g., Created by Grash in Kharsan
[2023-11-29 02:03 PM] Deciusmus: ah, that would be nice
[2023-11-29 02:03 PM] Deciusmus: instead of comma
[2023-11-29 02:03 PM] rsulfuratus: rather than Created by Grash, Kharsan
[2023-11-29 02:03 PM] rsulfuratus: yes
[2023-11-29 02:03 PM] Deciusmus: that would actually work really well
[2023-11-29 02:04 PM] Deciusmus: I actually think for items and places you probably don't want both a "page date" and a "location" line
[2023-11-29 02:05 PM] Deciusmus: although that's a separate topic and I gotta go do work
[2023-11-29 02:05 PM] Deciusmus: so not for right now
[2023-11-29 02:05 PM] rsulfuratus: easy enough to just set what you don't want to "" in displayDefaults IMO
[2023-11-29 02:05 PM] rsulfuratus: there are a few items I changed to "Created by X in date"
[2023-11-29 02:05 PM] rsulfuratus: or played with, not sure I committed
[2023-11-29 02:06 PM] rsulfuratus: think it is easier to just do it that way if you don't want both or what a merge of the two
[2023-11-29 03:02 PM] Deciusmus: For someone like Vola with a line that currently says:
    Traveling in Dunmar
    
    I’d assume you’d want them to show up in a filter that finds everyone in Dunmar
[2023-11-29 03:07 PM] rsulfuratus: yes. i think that what you suggested before of display information is the best idea here
[2023-11-29 03:07 PM] rsulfuratus: a location is always the most precisely specified place a note can be located
[2023-11-29 03:08 PM] rsulfuratus: but then there is a way to have it display more information, e.g. traveling in Dunar
[2023-11-29 03:09 PM] rsulfuratus: actually traveling in Dunmar is no different from imprisoned in Stormcaller Tower
[2023-11-29 03:09 PM] rsulfuratus: it is just "traveling east from Tokra" that is diferent
[2023-11-29 03:10 PM] rsulfuratus: depending on whether we care about being able to easily query this information, it might make sense for this to be part of the normalized name
[2023-11-29 03:10 PM] rsulfuratus: since traveling east from Tokra could be thought of as basically just linktext for Dunmar
[2023-11-29 03:41 PM] Deciusmus: Right, so the prefixes are super easy and basically work
[2023-11-29 03:44 PM] Deciusmus: 
![[../_discord_assets/image-FF8AE.png]]
[2023-11-29 03:44 PM] Deciusmus: - {type: away, start: 1748-08-10, end: 1748-08-16, prefix: traveling in, location: Nevos Sea }
[2023-11-29 03:45 PM] Deciusmus: 
![[../_discord_assets/image-5B06E.png]]
[2023-11-29 03:47 PM] Deciusmus: {type: away, start: 1748-03-20, end: 1748-04-22, location: traveling to Chardon}
    
    Still works, i.e. the split on capital letter still happens, but inLocation behaves differently
[2023-11-29 03:47 PM] Deciusmus: The Nevos Sea one, inLocation reports true for Nevos Sea
    the traveling to Chardon, in location does not report true for Chardon
[2023-11-29 03:48 PM] Deciusmus: conceptually could implement a locationDisplayAlias, but I think better to see if it is really useful first
[2023-11-29 03:48 PM] Deciusmus: in general, it is probably fine if "travelling" people don't appear in any actual location
[2023-11-29 03:49 PM] rsulfuratus: the use case would be whereabouts of someone like Havdar or Sura who travel a lot but always in Dunmar. Would be nice to put "Dunmar" as their location, and then "riding east from Tokra" as the text, so they still come up in Dunmar searches
[2023-11-29 03:50 PM] Deciusmus: but do you really want a search of all people in Dunmar?
[2023-11-29 03:50 PM] Deciusmus: I mean, it can be done, I am just not going to do it right now
[2023-11-29 03:50 PM] rsulfuratus: the most useful search would be all people in dunmar not in a city right now
[2023-11-29 03:50 PM] rsulfuratus: for example
[2023-11-29 03:50 PM] rsulfuratus: which theoretically should be possible since we can get a list of cities/towns/villages using typeof
[2023-11-29 03:51 PM] Deciusmus: yeah
[2023-11-29 03:56 PM] Deciusmus: prefix solves a lot of the current ones though
[2023-11-29 04:12 PM] Deciusmus: So I just looked at all the whereabouts lines with of / to / in / near / travel / ride / sail
[2023-11-29 04:12 PM] Deciusmus: + north/south/east/west
[2023-11-29 04:14 PM] Deciusmus: basically, there are exactly 2 cases:
    
    (a) a bunch of Dunmari who are on the plains (north/south/east) of (Songra/Tokra) (or a few other cases, like desert west of Kharsan)
    
    (b) a bunch of travelers, i.e. via traveling to Chardon
[2023-11-29 04:19 PM] Deciusmus: case (a) I think is largely lack of names. In Sembara, I'd probably just say:
    
    prefix: western plains of, location: Barony of Dunfry
[2023-11-29 04:19 PM] Deciusmus: but in Dunmar there really isn't good or sensible names for various stretches of the place
[2023-11-29 04:21 PM] rsulfuratus: I think in Dunmar some of that reflects nomadic people as well. probably their should be names for some of these broad areas
[2023-11-29 04:22 PM] Deciusmus: So for that one specific use case, you probably would prefer something like
    
    location: Central Dunmar, locationDisplayAlias: plains west of Tokra
[2023-11-29 04:22 PM] Deciusmus: alternatively, as you say, there should be a name
[2023-11-29 04:22 PM] Deciusmus: the XXXX plains
[2023-11-29 04:23 PM] rsulfuratus: part of the issue in dunmar is doesn't have the kind of political organization that makes it sensible to have relatively constrained political subunits
[2023-11-29 04:23 PM] rsulfuratus: and it is a bit tedious / hard to name six different plains
[2023-11-29 04:23 PM] rsulfuratus: but in-world the Dunmari surely would have names for the land they travel over and live on
[2023-11-29 04:23 PM] rsulfuratus: that isn't just "the plains west of Tokra"
[2023-11-29 04:24 PM] Deciusmus: I mean, a simple option is ~Plains West of Tokra~
[2023-11-29 04:24 PM] rsulfuratus: sure, that's not a bad idea
[2023-11-29 04:25 PM] rsulfuratus: and if you add "plains west of Tokra" as an alias you can find it without needing to display the ~ / ~
[2023-11-29 04:26 PM] rsulfuratus: traveling to is still a little awkward because you don't want to use a prefix for that. that is actually the case where you want: "location: Chardonian Empire, locationAlias: traveling to Chardon"
[2023-11-29 04:27 PM] rsulfuratus: then you could remove capital letter procesing entirely and have InLocation work a little more seemlessly if you ever want to make a list of everyone in dunmar, etc
[2023-11-29 04:28 PM] rsulfuratus: but a very minor thing
[2023-11-29 04:31 PM] Deciusmus: the only places left that are not linked, that I can find, are:
    
    Grumella    north of Voltara
    Herasto             plains south of Voltara
[2023-11-29 04:31 PM] Deciusmus: + various travelling ones
[2023-11-29 04:32 PM] rsulfuratus: those are both just shorthand for unnamed geographic features
[2023-11-29 04:33 PM] rsulfuratus: could actually set them both as the voltara plains (which has a non-canonical name and I think a ~Voltara Plains~ page), and just put prefix as north for Grumella and south for Herasto
[2023-11-29 04:33 PM] rsulfuratus: or maybe northern part of and southern part of
[2023-11-29 04:33 PM] rsulfuratus: actually, if you have a suffix option, that could be the solution for traveling
[2023-11-29 04:33 PM] rsulfuratus: prefix: traveling through
    location: Chardonian Empire
    suffix: to Chardon
[2023-11-29 04:38 PM] Deciusmus: I was wondering if there should just be a "type: travel"
[2023-11-29 04:38 PM] Deciusmus: with a from: and to:
[2023-11-29 04:38 PM] Deciusmus: not sure if it is worthwhile though
[2023-11-29 04:39 PM] rsulfuratus: from is generally recorded in whereabouts already, at least if it is known
[2023-11-29 05:04 PM] Deciusmus: yeah
[2023-11-29 05:04 PM] Deciusmus: I gotta go but I made a DV query that gets all of the whereabouts that are not linked
[2023-11-29 05:04 PM] Deciusmus: there are currently 43 of them after my cleanup
[2023-11-29 05:04 PM] Deciusmus: most are travelling or the villages of the Deno'qai which don't have pages yet
[2023-11-29 06:19 PM] Deciusmus: So there are 27 whereabouts lines that are not linked to anything now
[2023-11-29 06:19 PM] Deciusmus: I will push later tonight
[2023-11-29 08:15 PM] rsulfuratus: probably about as close as I'll be able to get to twins with Dall-E
![[../_discord_assets/DALLE_2023-11-29_20.14.28_-_A_portrait_of_-4CB4C.png]]
![[../_discord_assets/DALLE_2023-11-29_20.12.21_-_A_portrait_of_-924C9.png]]
[2023-11-29 08:50 PM] Deciusmus: I like them
[2023-11-29 10:01 PM] Deciusmus: 
![[../_discord_assets/image-28E07.png]]
[2023-11-29 10:01 PM] Deciusmus: note the prepositions
[2023-11-29 10:01 PM] Deciusmus: seems to work pretty well
[2023-11-29 11:13 PM] Deciusmus: So I got a little carried away with prepositions and such, it actually works almost perfectly, a few little things to clear up but between prepositions and prefixes you can get a nice chain like:
    Trapped in the Mirror of Soul Trapping, stored on Vindrijarna, piloted by the Dunmar Fellowship, in Tollen

