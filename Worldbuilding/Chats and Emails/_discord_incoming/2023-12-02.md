# Discord DM ‚Äì 2023-12-02

[2023-12-02 07:46 AM] rsulfuratus: a few bug reports, more explicit.
[2023-12-02 07:46 AM] rsulfuratus: 1. Unknown Location bug
    Currently Unknown looks weird to me; to fix it however probably requires going back to an "unknown" displayDefault for wCurrent, which isn't really that bad. haven't implemented in case you have a different clever idea. Should probably be Current Location: Unknown. 
    
    Alton Greenleaf is a good "unknown location" test case
[2023-12-02 07:58 AM] rsulfuratus: 2. Event display cleanup
    (The Battle of Urlich Pass is a test case)
    
    Generally speaking, I think that the header for events is generally not great, but it is a bit hard to fix strictly with defaults. 
    
    Events with DR but no DR_end should not display imputed end, e.g. they should be:
    "Happened in DR 1059"
    not
    "DR 1059 - DR 1059, lasted 0 years"
    
    Conversely, events with defined start and end with a length `<1 year should still display. For some reason War of the Cloak just shows ended, not span. 
    
    Even more complicated, I would generally think that for events with location and a single date, you probably want:
    "Happened in `<date>` in `<loc>`"
    whereas events with start and end you want:
    "`<start>` - `<end>`"
    "Happened in `<loc>`"
    
    There might be a few more event display issues but these are the main ones. 
    
    War of the Cloak and Battle of Urlich Pass are my test cases here
[2023-12-02 08:12 AM] rsulfuratus: 3. Reusing endStatus in the whereabouts line for places might not be the best default, since endStatus if often how they are destroyed, e.g. Isingue. You can override it, of course, so this is just more about defaults, whether it is easier to set wPastHome to something different when you change endStatus or to add endStatus when you want it
    
    Isingue is a test case I have customized, but which looks bad with the default wPastHome. 
    
    But this might be fine to leave
[2023-12-02 08:15 AM] rsulfuratus: 4. Preposition defaults. The best case scenario here would be introduce Q for no prepositions, and then have q/Q be "sticky" - if you have a q, it is not overriden in a whereabouts format spec unless you give Q, and if you have Q same unless you give q. 
    
    So if the default is wHome: "Based `<home:3qr>`" then you set "format: f" you still get prepositions, it is only if you set "format: fQ" that you don't.
[2023-12-02 08:16 AM] rsulfuratus: that is what I've seen so far, but generally it is quite nice
[2023-12-02 08:36 AM] rsulfuratus: another minor thing about prefixes: the Dunmari who are based in locations like "the plains north east of Karawa" are a bit awkward at the moment, not sure whether there is code changes or just format string changes for these. E.g., Akan
[2023-12-02 08:40 AM] Deciusmus: How are they awkward?
[2023-12-02 08:41 AM] rsulfuratus: 
![[../_discord_assets/image-D595D.png]]
[2023-12-02 08:41 AM] rsulfuratus: the arrangement of articles and prepositions is wrong
[2023-12-02 08:41 AM] Deciusmus: Ah
[2023-12-02 08:41 AM] rsulfuratus: should be something like: "Based in the north-eastern plains of Karawa"
[2023-12-02 08:42 AM] rsulfuratus: partly this is caused by default prep being ""
[2023-12-02 08:42 AM] Deciusmus: It‚Äôs tricky because if then prefix was ‚Äúsailing to‚Äù it would work
[2023-12-02 08:42 AM] Deciusmus: Ah, no
[2023-12-02 08:43 AM] Deciusmus: I optimized for the halfling boats where you have a location chain
[2023-12-02 08:43 AM] Deciusmus: i.e. person is on boat sailing to place
[2023-12-02 08:44 AM] Deciusmus: Or alternatively the currently case
[2023-12-02 08:44 AM] rsulfuratus: right, the problem i think is the concept of prefix is a bit loosely defined to make it worth well with automatic prepositions
[2023-12-02 08:44 AM] Deciusmus: Ie traveling to,
    You get currently traveling to Embry
[2023-12-02 08:45 AM] rsulfuratus: location status, location subpart, and approximate location are all overloaded into prefix and it gets complicated because the article/preposition needs differ
[2023-12-02 08:45 AM] Deciusmus: Right
[2023-12-02 08:46 AM] rsulfuratus: the easiest option is probably actually the display alias option
[2023-12-02 08:46 AM] Deciusmus: Yeah
[2023-12-02 08:48 AM] Deciusmus: That solves the ‚Äúsub part‚Äù case
[2023-12-02 08:48 AM] rsulfuratus: e.g. for Akan simplest option would be:
    - {type: home, location: Eastern Dunmar, display: "plains north-east of Karawa" }
[2023-12-02 08:48 AM] Deciusmus: And the approximate I guess
[2023-12-02 08:49 AM] rsulfuratus: technically the prefix is just a complicated preposition in some ways
[2023-12-02 08:50 AM] rsulfuratus: e.g. if a ship were "trapped in the Whirlpool of Death"
[2023-12-02 08:50 AM] rsulfuratus: then really you are replacing the "in" in a wherabout-specific way
[2023-12-02 08:50 AM] rsulfuratus: so someone on the ship should be: "Currently on Black Pearl, trapped in the Whirlpool of Death"
[2023-12-02 08:51 AM] rsulfuratus: so probably having display alias and prefix works fine, where prefix is just a simple way to override the entire preposition for a whereabout
[2023-12-02 08:53 AM] rsulfuratus: again I think a general standarded name object would probably make a lot of this much simpler
[2023-12-02 09:04 AM] Deciusmus: You actually want the prepositions to be able to vary based on type, it the mirror of soul trapping should be able to have a ‚Äútrapped in‚Äù for people, stored on for items, and in for places
[2023-12-02 09:08 AM] rsulfuratus: but "Stormcaller Tower" has a different preposition for different people "imprisoned in" vs "in" so it isn't quite that simple
[2023-12-02 09:08 AM] rsulfuratus: that could be a nice way to generate defaults, though
[2023-12-02 09:10 AM] Deciusmus: Right that‚Äôs where the prefix comes in
[2023-12-02 09:10 AM] Deciusmus: Or maybe you actually get rid of prefix and just have a display alias
[2023-12-02 09:12 AM] Deciusmus: So if you don‚Äôt have a locationAlias it displays as 
    calculated preposition article place
    
    If you do it just displays the alias
[2023-12-02 09:13 AM] Deciusmus: The one thing that doesn‚Äôt work for is ‚Äútraveling to X‚Äù because you‚Äôd like the chain to come from the X not the location
[2023-12-02 09:13 AM] Deciusmus: It would be pretty simple to allow aliases for unknown as well
[2023-12-02 09:15 AM] rsulfuratus: still think a generalized name object would make this a lot simpler. you could have something like a locChain property that would let you follow the chain from a different place, for example
[2023-12-02 09:16 AM] rsulfuratus: so "traveling to Tokra" could be:
    file: Dunmar
    locChain: Tokra
    displayText: traveling to Tokra
[2023-12-02 09:21 AM] rsulfuratus: basically any string can be decomposed to:
    file: the thing it actually represents, or null if unknown
    display: the text to show
    
    where display can be autogenerated based on prepositions and articles, or just overwritten entirely 
    
    you need a few more bells and whistles to handle linking (e.g., you don't want traveling to Tokra to link to Dunmar), and perhaps things like locChain to calculate parts from a different file than file and a few other tweaks
[2023-12-02 09:23 AM] rsulfuratus: the string formatter then could just do: `<prefix>``<article>``<name>``<suffix>`
[2023-12-02 09:24 AM] rsulfuratus: so default would be something like:
[2023-12-02 09:25 AM] rsulfuratus: Currently on the Emerald Song
[2023-12-02 09:25 AM] rsulfuratus: where "Emerald Song" is:
    file: Emerald Song
    prefix: on
    article: the
[2023-12-02 09:27 AM] rsulfuratus: but, you could then imagine a lot more stuff. for example, suffix could be ", a typeof"
    so you get:
    Currently on the Emerald Song, a boat
    Currently at The Red Lily, an inn in Tokra, Central Dunmar
[2023-12-02 09:29 AM] rsulfuratus: Currently sailing on the Emerald Song, a halfing ship
[2023-12-02 09:31 AM] rsulfuratus: Or if you have different display text, you could have:
    file: Central Dunmar
    display: plains south of Tokra
    locChain: Tokra
    prefix: camped on
    art: the
    
    You get:
    Camped on the plains south of Tokra, Central Dunmar, Dunmar
[2023-12-02 09:33 AM] rsulfuratus: or in that case maybe it is easier to include the article in the display text, e.g. "the plains south of Tokra", art: ""
[2023-12-02 09:34 AM] rsulfuratus: still need to figure out exactly the details and implementation, but I think this would be way simpler than increasingly complicated string formatter commands for display overrides and such
[2023-12-02 09:35 AM] Deciusmus: Where are you imagining you are providing this name object? In the whereabouts line?
[2023-12-02 09:37 AM] rsulfuratus: i think it would be constructed from any string. but overrides would come from whereabouts lines mostly I think, yes. 
    
    e.g., location: `<string>` 
    
    `<string>` gets processed by getNormalizedName to generate the name object
    
    location: `<string>`, prefix: imprisoned in
    
    gets processed by getNormalizedName but with prefix: imprisoned in instead of default
[2023-12-02 09:38 AM] Deciusmus: I understand the idea of having a normalized name object for a file (although I'm not actually sure what you ever want to do with the name object other than display it)
[2023-12-02 09:39 AM] Deciusmus: And I gues it is easier to think about if the idea is that you have some definition of a name and then you can override pieces on a whereabouts line if you want the name to be generated differently
[2023-12-02 09:39 AM] Deciusmus: But something like locChain is not part of a name
[2023-12-02 09:40 AM] rsulfuratus: i think normalized name is not a property of a file, it is a property of a string
[2023-12-02 09:40 AM] rsulfuratus: it's not a normalized representation of a note, it is a normalized representation of a bit of text, so it is basically all about display
[2023-12-02 09:41 AM] Deciusmus: sure but in that case I don't know what you do with it other than display it
[2023-12-02 09:41 AM] rsulfuratus: all you do is display it, yes
[2023-12-02 09:41 AM] Deciusmus: so what's the point of having all the properties, any consumer of it is only going to want the string representation
[2023-12-02 09:41 AM] Deciusmus: I can't see why, say, string formatter would ever want to access name.article
[2023-12-02 09:43 AM] rsulfuratus: because in some contexts you might not want to display name.article
[2023-12-02 09:43 AM] Deciusmus: sure, but that's just semantics
[2023-12-02 09:44 AM] Deciusmus: i.e. is it better to have the "a" format string interpreted by string formatter, by calculating the name display string, or have name code decide based on an input
[2023-12-02 09:44 AM] Deciusmus: it isn't visible to the user
[2023-12-02 09:44 AM] rsulfuratus: well, okay, i guess my main point is the string formatter codes are not sufficient. e.g., for variable prefixes, for display alias text, etc
[2023-12-02 09:44 AM] Deciusmus: I do think that there should be a method on name manager, something like getLocationChainName(previousLocation, nextLocation)
[2023-12-02 09:45 AM] Deciusmus: The key point I guess is that generating the location chain and generating the name are two different things, and that generating a name in a location chain is more complex
[2023-12-02 09:46 AM] Deciusmus: So for example the casing and linking format codes work quite well for things like typeof, etc
[2023-12-02 09:47 AM] Deciusmus: but the "following the chain" string format commands (current, home, origin, lastknown) have a bunch of additional complexity to get them perfect which is not well covered right now
[2023-12-02 09:48 AM] Deciusmus: display aliases, variable prefixes, etc are not really part of a name, they are part of a location chain
[2023-12-02 09:52 AM] rsulfuratus: i guess my feeling is that the "location chain" concept is more widely useful.
[2023-12-02 09:53 AM] Deciusmus: but where?
[2023-12-02 09:53 AM] rsulfuratus: and also that at least 50% of pages really just need a good information box so it is worth the time to clean it up
[2023-12-02 09:53 AM] rsulfuratus: events, for one
[2023-12-02 09:53 AM] rsulfuratus: although i guess that is more just that whereabouts are generally useful
[2023-12-02 09:54 AM] Deciusmus: events and organizations have the idea of "part of" as distinct from whereabouts
[2023-12-02 09:54 AM] Deciusmus: which probably does need a bit of thought
[2023-12-02 09:54 AM] Deciusmus: and is logically similar
[2023-12-02 10:01 AM] Deciusmus: I also do think there is this idea of "the name as part of a chain" as distinct from "the name itself"
[2023-12-02 10:04 AM] Deciusmus: there are really three concepts that we are dealing with:
    * the source page
    * the target "page" (which might not exist)
    * the link between them
    
    What you'd like is to have a general function like getChainedDisplayName(source, target, linkInfo)
    
    which would then generate a string like:
    
    owned by the Dunmar Fellowship
    or
    Chardon
    or
    a battle in the War of the Cloak
    or
    an inn on the Tokra-Darba Road
[2023-12-02 10:04 AM] Deciusmus: or
    on the plains east of Karawa
[2023-12-02 10:05 AM] Deciusmus: the problem is, in general, it is tricky to define generic rules that always work
[2023-12-02 10:06 AM] Deciusmus: the simple case is something like:
    
    `<prep of target>` `<name of target>`
[2023-12-02 10:06 AM] Deciusmus: or really `<prep of target if different from prep of source>` `<name of target>`
[2023-12-02 10:07 AM] Deciusmus: allowing you to specify the format string, not for the entire chain but for this specific link might work pretty well though
[2023-12-02 10:10 AM] Deciusmus: no, it gets confusing... let me keep thinking
[2023-12-02 10:13 AM] rsulfuratus: I don't think that names in chains and names out of chains are really that different, you just have a chain length of 1
[2023-12-02 10:14 AM] rsulfuratus: Strings are basically:
    `<prefix>``<name>``<prep>``<prefix>``<name>``<prep>` etc
[2023-12-02 10:15 AM] rsulfuratus: where prep is really shorthand for "linker text"
[2023-12-02 10:17 AM] Deciusmus: well, but there are two contexts for names
[2023-12-02 10:17 AM] Deciusmus: i.e. in a table of "people in Cleenseau" I don't want to see "linker text" at all
[2023-12-02 10:18 AM] Deciusmus: in headers though you probably do...
    
    i.e. in a header it is pretty much always
    
    `<description of line>``<context>``<article>``<prefix>``<name>``<linktext>``<context>``<article>``<prefix>``<name>` etc
[2023-12-02 10:19 AM] Deciusmus: and in fact, "description of link" is really just a link text as well
[2023-12-02 10:20 AM] Deciusmus: so you can think of it as
    
    So for example if you have
    
    Sword of Power owned by Anontia in the Mirror of Soul Trapping on Vindijsjtra piloted by the Dunmar Fellowship travelling across the plains of Central Dunmar, Dunmar
[2023-12-02 10:21 AM] Deciusmus: you have a sequence of pages:
    `[Sword of Power]` ->` `[Antonia]` ->` `[Mirror]` etc
[2023-12-02 10:22 AM] Deciusmus: you want to display a line that is basically
    
    `<link text: Sword of Power To Antonia>``<context: Antonia>``<article: Antonia>``<prefix: Antonia>``<name: Antonia>``<linktext: Antonia to Mirror>` etc
[2023-12-02 10:56 AM] rsulfuratus: relatedly, I think it is also much better to define the default link stuff in page metadata, than in metadata.json
    
    e.g., if I have ancestry: Urskan
    
    I shouldn't need to add an entry in metadata.json
[2023-12-02 11:03 AM] rsulfuratus: i'm not entirely sure why we don't just use an alias for this, like why not just have Sembaran be an alias for Sembara?
[2023-12-02 11:08 AM] Deciusmus: Yeah I had that same though a while ago
[2023-12-02 11:08 AM] Deciusmus: The link map should in theory be obsolete at this point
[2023-12-02 11:26 AM] rsulfuratus: having a way to indicate paths (traveling to, etc) could also be very useful for rivers. e.g., a lot of rivers have just one line of text, describing a source. 
    
    having an autogenerated:
    Flows from `<source>` to `<outflow>`, passing `<place1>`, `<place2>`
    
    might be nice
    
    or might be overkill when you can just type that in the text
[2023-12-02 12:06 PM] Deciusmus: A few updates:
    
    locationAlias, in a whereabout line, works well. It is basically an alias for that location and it doesn't overwrite article or prep. It **does** work for unknown locations.
    
    So:
    
    - {type: home, start: 1051, end: 1582, locationAlias: wandering and hiding}
    
    Means that this is an "unknown" location but it displays as "Currently wandering and hiding" rather than Currently Unknown
[2023-12-02 12:06 PM] Deciusmus: Prefix works with locationAlias as an override to the "link text" basically, so:
    
    {type: home, start: 940, end: 1050, prefix: in, locationAlias: parts unknown}
    
    Displayas as "Currently in parts unknown"
[2023-12-02 12:07 PM] Deciusmus: Perhaps the ideally the prefix would only display if the format string had "q", so that if it was an origin location it would show as
    
    Originally from: parts unknown
[2023-12-02 12:10 PM] Deciusmus: Similarly, 
    
    - {type: home, location: plains of Karawa, locationAlias: plains north-east of Karawa, format: "3" }
    
    Shows
![[../_discord_assets/image-C5D45.png]]
[2023-12-02 12:11 PM] Deciusmus: The locationAlias is not meant to solve all problems, but it gives a handy way to change the description of a location and is analogous to typeOfAlias and speciesAlias
[2023-12-02 12:11 PM] Deciusmus: basically cases where you want a `*`local*, rather than `*`global*, alias for a real thing, or you need an alias for a page that doesn't exist
[2023-12-02 12:12 PM] Deciusmus: (but you don't want the "location" to be the page that doesn't exist because you want to be able to search for that specific location)
[2023-12-02 12:12 PM] rsulfuratus: i think this is fine, and probably a useful exercise, but generally speaking it is hard to tell if it is worth investing a lot in cleaning up display text (as opposed to just cleaning up actual metadata)
[2023-12-02 12:13 PM] rsulfuratus: e.g., I'm not convinced this stuff feels mature enough yet
[2023-12-02 12:13 PM] Deciusmus: well, the alias works well for the case where you don't think "the plains north east of kawara" should be a place
[2023-12-02 12:13 PM] Deciusmus: (because "the plains of karawa" is the place, and you don't want to make more specific types of places within the plains of karawa)
[2023-12-02 12:14 PM] rsulfuratus: right, that isn't really my point though. i don't particularly care whether Akan's bio box is ungrammatical, I mean this is a super minor NPC who weirdly has a lot of information
[2023-12-02 12:14 PM] Deciusmus: doesn't that contradict what you said 2 hours ago? üòÑ
[2023-12-02 12:14 PM] Deciusmus: when you said it was worth spending time to get the boxes correct?
[2023-12-02 12:14 PM] rsulfuratus: the point of pointing out bugs is to identify structural issues with how we process metadata, then come up with a stable fix, then clean them up
[2023-12-02 12:15 PM] rsulfuratus: i feel like the process of "fix each edge case with another layer" is going to end up with an unmaintainable mess
[2023-12-02 12:15 PM] rsulfuratus: hence, pointing out bugs doesn't imply they need to be fixed immediately
[2023-12-02 12:15 PM] rsulfuratus: sorry if that wasn't clear
[2023-12-02 12:16 PM] rsulfuratus: it means: there is an aspect of our current strategy that doesn't capture this case well
[2023-12-02 12:16 PM] Deciusmus: I think the idea of an alias actually captures this case perfectly
[2023-12-02 12:16 PM] Deciusmus: A better example is Hralgar
[2023-12-02 12:16 PM] Deciusmus: His current location is unknown
[2023-12-02 12:16 PM] Deciusmus: But it should display as ‚Äúdrifting on the wind‚Äù
[2023-12-02 12:17 PM] Deciusmus: Using that as a prefix for taelgar is a hack
[2023-12-02 12:17 PM] rsulfuratus: sure
[2023-12-02 12:17 PM] Deciusmus: And overriding wCurrentU for Hralgar is wrong as well because it wouldn‚Äôt work if you wanted to have an item owned by him
[2023-12-02 12:18 PM] rsulfuratus: I think the general idea that we want to be able to control the display alias of pages (including "unknown" or other generic things) in a context-specific way is definitely crucial to making things work
[2023-12-02 12:18 PM] Deciusmus: I think in general the idea of being able to say ‚Äúthis is an unknown location but it should display like this‚Äù and also ‚Äúthis is a known location but it should display like this‚Äù
[2023-12-02 12:18 PM] rsulfuratus: this is what I've been arguing for with a standardized name
[2023-12-02 12:18 PM] Deciusmus: Is useful
[2023-12-02 12:19 PM] rsulfuratus: yes, I don't disagree
[2023-12-02 12:19 PM] Deciusmus: I don‚Äôt think it‚Äôs a name though
[2023-12-02 12:19 PM] rsulfuratus: but are you convinced that the current implementation is definitely the best way to do it?
[2023-12-02 12:19 PM] rsulfuratus: well, sure, standardized string
[2023-12-02 12:19 PM] Deciusmus: But going to eat lunch, more later
[2023-12-02 12:40 PM] Deciusmus: Have you seen this btw? https://help.obsidian.md/import/onenote
[2023-12-02 12:45 PM] Deciusmus: So looking at this some more, I really am not sure that the issue or problem is really related to whether there is a normalized name object or not
[2023-12-02 12:49 PM] rsulfuratus: the onenote importer is amazing
[2023-12-02 12:49 PM] Deciusmus: I just don't see that as a useful model for solving any particular problems. I do think that it is very useful to have
    
    (a) a generalized function that takes a page and returns the "name" of that page (which takes into account titles, prefixes, articles, linking, casing, aliases)
    (b) a generalized function that takes a *source* and a *target* and returns the "relationship text" between those two pages
    
    At the moment, we have (a) via the nameManager.getName, but the format string is overloaded in an unfortunate way. I strongly believe that format strings are a good way to separate display instructions from the metadata itself, but it is not ideal that the chain-following logic and the formating logic are intermixed
[2023-12-02 12:50 PM] Deciusmus: what you really want is:
    * a format string that specifies how you generate the name for something
    * a filter that defines which pieces of a chain you output
    * a link format string that species how you link a and b in a chain
[2023-12-02 12:53 PM] Deciusmus: I think if I was refactoring I'd be tempted to try to split the format and the filter, but I'm not sure it is really actually worthwhile
[2023-12-02 12:53 PM] Deciusmus: because the current code is pretty simple for managing that
[2023-12-02 01:07 PM] rsulfuratus: I am not sure that a normalized name object is the right implementation. but the problem is there are too many ways to set display options, and different display parts have different ways to set them. the shear number of format strings and display defaults makes them hard to efficiently use
[2023-12-02 01:08 PM] Deciusmus: Right. My basic instinct is that display defaults are at some level wrong
[2023-12-02 01:08 PM] Deciusmus: I gotta go take Z to rehersal then I am going to mess around with this for real for a bit
[2023-12-02 01:41 PM] rsulfuratus: eh actually onenote importer is uselessly buggy, will have to try again in a month or so
[2023-12-02 01:41 PM] rsulfuratus: oh well
[2023-12-02 01:44 PM] rsulfuratus: anyway, here is my take on the string formatting stuff. i have a bunch of other projects to work on today so don't have a ton of time to mess around with this.
[2023-12-02 01:44 PM] rsulfuratus: fundamentally, I think the ultimate goal is that we want (a) structured metadata that can be used for querying notes, that (b) can be converted into nice-looking info boxes for each page automatically, which (b1) allows a good fraction of TaelgarVerse to be autogenerated from metadata, and (b2) helps keep key summary information readily visible
[2023-12-02 01:46 PM] rsulfuratus: for (a), structured metadata needs to be (i) accurate, (ii) easily querable, and (iii) use at least a semi-controlled vocabulary
[2023-12-02 01:47 PM] rsulfuratus: for (b), display control needs to be flexible enough to allow page-specific overrides, while general enough to allow most autogenerated pages to look good enough to not require manual editing
[2023-12-02 01:55 PM] rsulfuratus: the problem I feel like we are in right now is that we have a lot of bells and whistles for display control, but (i) they are very inconsistent (e.g., to add startStatus to Originally from: requires overwriting wOrigin but endStatus is built into wPastHome),  (ii) things like approximate locations are mixed up with display control, and (iii) there is a lot of variability in where you need to change display variables to change the output, especially for "linking text" in chains
[2023-12-02 01:56 PM] rsulfuratus: there is also a lot of complication with what is a property of a page in general, vs what is a property of a specific display element, which makes makes updating a lot of pages complicated
[2023-12-02 01:59 PM] rsulfuratus: there is actually I think a fundamental complication which can be seen if we think about the whereabouts of a person like Dee Wildcloak
[2023-12-02 02:00 PM] rsulfuratus: if a whereabouts line is supposed to mark known locations, then these lines should not exist:
    - {type: away, start: 1748-03-20, end: 1748-04-22, location: traveling to Chardon}
[2023-12-02 02:01 PM] rsulfuratus: between 03/20 and 04/22, we don't know where Dee was
[2023-12-02 02:01 PM] rsulfuratus: but we know she left Stormcaller Tower at on 3/19 and arrived in Chardon on 4/23
[2023-12-02 02:02 PM] rsulfuratus: now, for Dee, it probably doesn't matter because it is unlikely we'll ever care her exact location on a specific date in the past
[2023-12-02 02:03 PM] rsulfuratus: but, if for example you later found out that there was another important item that Dee left stormcaller tower with, but that didn't make it to Chardon, then her exact route might turn out to matter
[2023-12-02 02:04 PM] rsulfuratus: however, from a display point of view, we probably don't want Dee to show "unknown location" on 4/10
[2023-12-02 02:04 PM] rsulfuratus: (again, doesn't really matter for Dee specifically)
[2023-12-02 02:04 PM] rsulfuratus: because her location isn't totally unknown, it is "traveling from Stormcaller Tower to Chardon by some unknown route"
[2023-12-02 02:05 PM] Deciusmus: Right but that‚Äôs a problem of representation I haven‚Äôt tackled yet
[2023-12-02 02:05 PM] rsulfuratus: I know, I'm just saying I think it is fundamentally related
[2023-12-02 02:05 PM] rsulfuratus: I'm not sure solving how to display "traveling to" information is worthwhile in isolation, that is
[2023-12-02 02:06 PM] Deciusmus: I‚Äôm not sure I agree. Look at the ‚Äútravelling in Dunmar‚Äù line of Dee
[2023-12-02 02:07 PM] Deciusmus: In that case the word prefix is wrong but it‚Äôs basically overriding the preposition
[2023-12-02 02:07 PM] Deciusmus: It makes perfect sense - Dee is in Dunmar, but adding some color commentary for display is useful
[2023-12-02 02:09 PM] rsulfuratus: so, that is fine, but if that is the solution I think it implies very strongly the following:
    a location is the most specific target note that captures the physical whereabouts of a source
[2023-12-02 02:09 PM] rsulfuratus: that might be the right decision
[2023-12-02 02:09 PM] Deciusmus: I think that is true
[2023-12-02 02:10 PM] Deciusmus: Because that is what makes sense for queries
[2023-12-02 02:10 PM] Deciusmus: The only wrinkle is whether it is worth capturing movement separately
[2023-12-02 02:11 PM] rsulfuratus: That definition has tradeoffs, for example traveling from Stormcaller Tower to Chardon crosses from Central Lowlands to West Coast
[2023-12-02 02:11 PM] rsulfuratus: so the most specific target note for "traveling to Chardon" is "Taelgar"
[2023-12-02 02:11 PM] Deciusmus: That is, should a dataview query be able to distinguish between:
    
    Person A is kinda aimlessly wandering around Dunmar
    
    Person B is specifically traveling from point A to point B
[2023-12-02 02:12 PM] Deciusmus: But that‚Äôs correct. The only known location from a page perspective is Taelgar
[2023-12-02 02:12 PM] rsulfuratus: right, I'm not saying it is incorrect
[2023-12-02 02:12 PM] rsulfuratus: I'm saying it might not be the most useful way to structure information
[2023-12-02 02:13 PM] Deciusmus: Well I agree but I think the other alternative is a first class notion ‚Äútype: travel‚Äù
[2023-12-02 02:13 PM] Deciusmus: One of the advantages of travel is it is easier to track stops and paths.
[2023-12-02 02:14 PM] Deciusmus: And it also works for roads and rivers
[2023-12-02 02:14 PM] rsulfuratus: well, yes and no. a path that moves in time and a path that moves in space are not exactly equivalent
[2023-12-02 02:14 PM] Deciusmus: For our purposes I kinda think they are
[2023-12-02 02:16 PM] rsulfuratus: i'm not convinced but would have to think about it a bit
[2023-12-02 02:17 PM] Deciusmus: My broader point is that I think the locationAlias and linkText concepts  solve all problems *except* traveling and the question of how to ‚Äústart‚Äù the chain. 
    
    The only time origin/home/etc matter is the link text from the page itself to the first part of the chain
[2023-12-02 02:17 PM] Deciusmus: Ie ‚Äúoriginally from: ‚Äú is just the link between page X and the first location in the origin whereabout
[2023-12-02 02:18 PM] rsulfuratus: yes, that makes sense
[2023-12-02 03:04 PM] Deciusmus: So playing around a bit, I think there is basically no need to have wHome, wOrigin, etc. There was no current usage of them that isn't better solved with link text or better defaults. Also, the format on a whereabout isn't really used either, except for 2 things
    
    (a) to force regions to appear when the whereabout doesn't make sense without regions
    (b) to skip the first line in some cases
[2023-12-02 03:08 PM] rsulfuratus: so, take a look at Morkalan which I just pushed
[2023-12-02 03:08 PM] rsulfuratus: (you might need to test on pageTargetDate: 1749)
[2023-12-02 03:09 PM] rsulfuratus: any edits should ideally make that kind of header generation easier, not harder
[2023-12-02 03:13 PM] Deciusmus: in theory, all you should have to do is:
    
    displayDefaults: {startStatus:  brought into being, endStatus: "destroyed by [[Riswynnn]] and companions" }
[2023-12-02 03:13 PM] Deciusmus: the rest of it is, I think, just bad defaults
[2023-12-02 03:14 PM] Deciusmus: places are going to be more of a mess because we haven't really thought about what the defaults should be
[2023-12-02 03:14 PM] Deciusmus: In particular, I think places and organizations, unlike people, shouldn't have a separate origin and created lines
[2023-12-02 03:17 PM] rsulfuratus: constrast with Isingue
[2023-12-02 03:21 PM] rsulfuratus: which kind of works with: `displayDefaults: {endStatus: Consumed by Cha'mutte's plague in, wPastHome: "`<subtypeof:UA>` `<typeof:UA>` `<(of )primary>` `<current:5q>`, once part of `<origin:rA>`\n`<end>` `<target>`", dPast: ""}`
[2023-12-02 03:22 PM] rsulfuratus: with: `whereabouts:
    - {type: home, location: Istabor Alliance}
    - {type: home, start: 1545, location: Plaguelands, format: Fq}`
[2023-12-02 03:23 PM] rsulfuratus: which you could probably clean up a bit
[2023-12-02 03:24 PM] rsulfuratus: but since they are incompatible you need a way to have fine control over the actual strings displayed
[2023-12-02 03:24 PM] rsulfuratus: probably wHome, wOrigin, all that isn't the right way
[2023-12-02 03:25 PM] rsulfuratus: this is cleaner for Isingue: 
    `displayDefaults: {endStatus: Consumed by Cha'mutte's plague in, wOrigin: "`<subtypeof:UA>` `<typeof:UA>` `<(of )primary>` `<current:Fq>`, once part of `<origin:rA>`", wPastHome: "`<end>` `<target>`", dPast: ""}`
[2023-12-02 03:28 PM] rsulfuratus: but, that doesn't work perfectly for dates prior to 1545, since now you get: "An Isinguer ruined city in the Istabor Alliance"
[2023-12-02 03:30 PM] rsulfuratus: which is mostly driven by "ruined" as a subtype being a permanent, and not time-dependent, property of the page
[2023-12-02 03:30 PM] rsulfuratus: maybe not worth fixing
[2023-12-02 03:34 PM] rsulfuratus: you can fix if it you really want like so:
    ```
    ---
    headerVersion: 2023.11.25
    tags: `[place, status/unknown, testcase]`
    displayDefaults: {endStatus: Consumed by Cha'mutte's plague in, wOrigin: "A `<primary:UA>` `<ancestry>` `<typeof:UA>` `<home:Fq>`, once part of `<origin:rA>`", wPastHome: "`<end>` `<target>`", dPast: ""}
    campaignInfo: `[]`
    name: Isingue
    pageTargetDate: 1542
    destroyed: 1545
    typeOf: city
    ancestry: Isinguer
    affiliations: 
    - { org: ruined, type: primary, start: 1545}
    whereabouts:
    - {type: home, location: Istabor Alliance}
    - {type: home, start: 1545, location: Plaguelands}
    ---
    ```
[2023-12-02 03:39 PM] rsulfuratus: one could imagine taking this to the extreme and basically making ALL descriptors be page-dated. even species might change if someone cases reincarnate on you.
[2023-12-02 03:41 PM] rsulfuratus: you could have a standard format like:
    - { label, start, end } 
    and then just a default string processor that converts bare strings to { label: string, start: 0001, end: 9999 }
[2023-12-02 03:42 PM] rsulfuratus: it makes dataview queries a bit more complicated because if you care about the page-dated value you need to use a dataviewjs function
[2023-12-02 03:42 PM] rsulfuratus: it might be overkill
[2023-12-02 03:43 PM] rsulfuratus: but also might unlock a lot of format simplification
[2023-12-02 03:58 PM] rsulfuratus: anyway, to summarize:
    - the current approach as is is extremely powerful and allows construction of essentially arbitrary page headers if you understand the quirks, albeit in some kind of complicated ways that often involve using metadata a little suboptimally
    - it is likely that there is a way to simplify by abstracting some of the linkText and linkAlias ideas and perhaps combining with a way to get the description of something at time X, or other ideas
    - the simplification may be fun and useful to play around with but (a) should probably be done on a branch and (b) should not remove the customization power of the current approach, it should just make it simpler to use and more consistent
[2023-12-02 03:58 PM] rsulfuratus: - separately for query purposes it is worth thinking about stuff like approximate locations and path-style locations
[2023-12-02 04:25 PM] rsulfuratus: So, spending 30 minutes entering data for places, I am starting to wonder if the whole concept of overloading everything into whereabouts is correct
[2023-12-02 04:26 PM] rsulfuratus: For example I was looking at inns in Tokra. There really isn‚Äôt a good way to record who built an inn
[2023-12-02 04:27 PM] rsulfuratus: Technically you can by putting origin as person and setting the location of a person at the founding date to the current location and the overwriting the display strings
[2023-12-02 04:29 PM] rsulfuratus: But this isn‚Äôt really great because for a place, ‚Äúorigin‚Äù might mean:
    - the founder / builder 
    - the political ‚Äúpart of‚Äù for a time in the past
    - a geographic location that doesn‚Äôt currently exist
[2023-12-02 04:39 PM] Deciusmus: There is an argument that overloading whereabouts for item owners was a mistake
[2023-12-02 04:40 PM] Deciusmus: However, I also feel like this is moving too fast üôÇ
[2023-12-02 04:41 PM] Deciusmus: What I really wanted to do is get the basic structure of whereabouts for representing actual locations of things finalized
[2023-12-02 04:47 PM] Deciusmus: To that end, I was going to propose the following mini-spec
    
    A whereabouts line has the following properties:
    
    * type: home or away
    * location: the target page / target place the person/vehicle/etc is in. This is the place that will return true when asked "is the person in this place"
    * alias: used as an alternative display for the location. works even if the location is empty (meaning "unknown")
    * filter: the filter string (f, 1-2, 2-,  etc) for filtering whereabouts from here onward
    * format: a format string to pass to string formatter to format this specific whereabout
    * linkText: a string to join the previous whereabout to this one
[2023-12-02 04:49 PM] Deciusmus: the default format is: `<name:q>`
[2023-12-02 04:49 PM] Deciusmus: sorry that is wrong. q goes away
[2023-12-02 04:49 PM] Deciusmus: the default format is `<name>`
[2023-12-02 04:49 PM] Deciusmus: the default link text is the link text from the target page
[2023-12-02 04:50 PM] Deciusmus: whereabouts would no longer support wOrigin etc. I don't think those make sense
[2023-12-02 04:50 PM] Deciusmus: (the display defaults for the PAGE still would)
[2023-12-02 04:51 PM] rsulfuratus: you don't think there is use in "generate this specific display string only if this location is the origin?"
[2023-12-02 04:51 PM] Deciusmus: No
[2023-12-02 04:51 PM] rsulfuratus: well, I guess wOrigin specifically is a bit silly
[2023-12-02 04:52 PM] Deciusmus: I think you might set link Text differently
[2023-12-02 04:52 PM] rsulfuratus: I guess I don't really understand exactly what you are proposing
[2023-12-02 04:53 PM] rsulfuratus: the problem is something like linkText depends on whether something is origin or home
[2023-12-02 04:53 PM] rsulfuratus: e.g., person born in 1715, lived in Cleenseau until 1725, moved to Tollen
[2023-12-02 04:53 PM] Deciusmus: does it? in practice the usages I've seen don't really
[2023-12-02 04:54 PM] rsulfuratus: in 1749, that should be:
    "originally from: Cleenseau"
    "based in Tollen"
[2023-12-02 04:54 PM] rsulfuratus: in 1720 presumably you don't want:
    "Originally from: Cleenseau"
[2023-12-02 04:54 PM] Deciusmus: think of it this way.
    
    the format tokens `<home>`, `<current>`, `<origin>`, and `<lastknown>` all generate the same string
[2023-12-02 04:54 PM] Deciusmus: the different is the wOrigin string
[2023-12-02 04:55 PM] Deciusmus: so if the page has
    
    wOrigin: "Originally from: `<origin>`"
[2023-12-02 04:55 PM] Deciusmus: that would generate the same string as
    
    wOrigin: "Originally from: `<home>`"
    
    except that the actual selected whereabouts would be different
[2023-12-02 04:55 PM] rsulfuratus: ah so you aren't using linkText as the "Oriignally from", "Based in" part
[2023-12-02 04:55 PM] Deciusmus: No
[2023-12-02 04:55 PM] Deciusmus: not yet
[2023-12-02 04:56 PM] Deciusmus: conceptually, you might be able to do away with wOrigin if you could set the "originLinkText, homeLinkText, etc" in the display defaults of the page
[2023-12-02 04:56 PM] Deciusmus: At the moment, all I am triyng to do is define how the `<origin>` or `<current>` string gets built
[2023-12-02 04:56 PM] Deciusmus: But I'm not sure it is worth getting more complex because why not just set wOrigin on the page?
[2023-12-02 04:57 PM] Deciusmus: So basically the idea is... given a page Q and a string `<current|home|origin|lastknown>` how to you generate the replacement value for `<current|home|origin|lastknown>`
[2023-12-02 05:00 PM] Deciusmus: My proposal is those 4 values are generated as follows:
    
    starting from Q, select the correct whereabout from the list of whereabouts in Q. 
    
    then the text you generate is something like
    
    `<link text>` [[target|alias??target]]
[2023-12-02 05:01 PM] Deciusmus: but with the ability to override that via a standard string format, so you could do something like
    
    format: "`<typeof>` `<ancestry>` `<name>`"
    
    which would use the target page's values
[2023-12-02 05:02 PM] Deciusmus: q\Q and prepositions go aay, instead there is a `<linkType>` or `<linkText>`
[2023-12-02 05:02 PM] Deciusmus: so the default format is actually `<linkText>` `<name>`
[2023-12-02 05:02 PM] Deciusmus: then if you want something complicated you can do 
    
    `<linkText>` `<ancestry:a>` `<subtype>` `<typeof>` `<name>`
[2023-12-02 05:03 PM] Deciusmus: and you'd get
    
    in an elven forest realm, Orelands
[2023-12-02 05:03 PM] rsulfuratus: so, I think the idea is very powerful
[2023-12-02 05:06 PM] rsulfuratus: but I still think there is a subtlety either I'm missing or this doesn't capture
[2023-12-02 05:08 PM] rsulfuratus: although maybe actually making whereabouts represent an actual location always and separating out things like owner/maker/founder would be sufficient
[2023-12-02 05:08 PM] Deciusmus: For the most part, it works even if we don't do that
[2023-12-02 05:08 PM] Deciusmus: there are likely some subtle issues that depend on convention
[2023-12-02 05:09 PM] rsulfuratus: ah, okay, here is an example
[2023-12-02 05:09 PM] Deciusmus: i.e. for an item, if you assume that the home location type means owner and away means no owner, you can define
    
    wHome: "Owned `<home>`"
    wCurrent: "Currently `<current>`"
[2023-12-02 05:09 PM] Deciusmus: and it works
[2023-12-02 05:10 PM] Deciusmus: for places, it gets a bit murkier I suspect
[2023-12-02 05:10 PM] Deciusmus: I haven't looked
[2023-12-02 05:11 PM] rsulfuratus: again, maybe I'm missing something, but here is an example
    - {type: home, end: 1745, location: originalPlace }
    what if you want that formatted differently when it is in the origin line vs when it is the last known line?
[2023-12-02 05:12 PM] rsulfuratus: e.g. someone like Apollyon
[2023-12-02 05:13 PM] Deciusmus: but do you actually want it to be formatted differently?
[2023-12-02 05:13 PM] Deciusmus: what's the actual example
[2023-12-02 05:13 PM] rsulfuratus: I mean I haven't messed around with the possibilities yet
[2023-12-02 05:14 PM] rsulfuratus: but for example what if I want:
    "Last known location: facing down Cha'mutte in Drankor, DR 1059"
[2023-12-02 05:15 PM] rsulfuratus: "Originally from Drankor, the Drankorian Empire"
[2023-12-02 05:15 PM] rsulfuratus: the format for the whereabout has to be different in the "origin" context and the "lastknown" context
[2023-12-02 05:16 PM] rsulfuratus: but, you don't want to set a page-wide "wLastKnown" to "facing down Cha'mutte in `<lastknown>`, `<date>`" because it only makes sense for that specific line
[2023-12-02 05:16 PM] rsulfuratus: if the last known is something else ("utterly destroyed by The Dunmar Fellowship in the ruined city of Drankor")
[2023-12-02 05:17 PM] rsulfuratus: it is also true for wParty (which is a bit of a special case)
[2023-12-02 05:17 PM] Deciusmus: I think that is overloading whereabouts too much
[2023-12-02 05:18 PM] rsulfuratus: i mean, one decision could be: this is not what the summary box is for
[2023-12-02 05:18 PM] Deciusmus: I actually am not sure I agree with that, I am just not sure it is what whereabouts is for
[2023-12-02 05:19 PM] Deciusmus: What you really want it
    
    campaignInfo: { person: Cha'mutte, format: Faced down `<person>` in `<current>`, date: 1059 }
[2023-12-02 05:19 PM] Deciusmus: I think
[2023-12-02 05:19 PM] Deciusmus: and the wLastKnown: ""
[2023-12-02 05:20 PM] Deciusmus: broadly, I think you are looking for interactions or events, not whereabouts
[2023-12-02 05:20 PM] Deciusmus: and trying to overload whereabouts to include interactions or events is probably a mistake
[2023-12-02 05:20 PM] Deciusmus: Now, last known location is a bit funny, because it kinda is a flavor of event
[2023-12-02 05:21 PM] rsulfuratus: right
[2023-12-02 05:21 PM] rsulfuratus: I actually think it would make sense to actually never export last known
[2023-12-02 05:21 PM] rsulfuratus: it is just really useful information to be able to query and see
[2023-12-02 05:21 PM] rsulfuratus: but, that is a lot of data entry hassle
[2023-12-02 05:22 PM] Deciusmus: what is a lot of data entry hassle?
[2023-12-02 05:22 PM] rsulfuratus: because you always need to have a campaignInfo line to show last known kind of information
[2023-12-02 05:22 PM] Deciusmus: well, not necessarily
[2023-12-02 05:22 PM] Deciusmus: it is actually more like the page date stuff
[2023-12-02 05:24 PM] Deciusmus: I think this is a bit separate from the original case though which was about chaining
[2023-12-02 05:25 PM] Deciusmus: I'm trying to solve the problem of halfling on a boat or whatever
[2023-12-02 05:25 PM] Deciusmus: which mostly works, but it has some weird bits
[2023-12-02 05:26 PM] Deciusmus: although I guess they mostly involve the mismatch between owner and location
[2023-12-02 05:27 PM] rsulfuratus: I'm not fully convinced that conditional whereabout formatting (format X when origin, format Y when home) is never useful, but I am convinced that trying to use whereabout formatting as a way to display significant events/interactions in the header box is not correct
[2023-12-02 05:28 PM] rsulfuratus: if it is simpiler to refactor the code without conditional formatting, it seems fine to go that way, and then add it back if needed
[2023-12-02 05:28 PM] Deciusmus: 
![[../_discord_assets/image-6C3CF.png]]
[2023-12-02 05:28 PM] Deciusmus: i.e. this annoys me
[2023-12-02 05:29 PM] rsulfuratus: well, that is exactly what I was talking about
[2023-12-02 05:29 PM] rsulfuratus: conditional formatting based on what it is used for
[2023-12-02 05:29 PM] Deciusmus: but that isn't based on it is used for
[2023-12-02 05:29 PM] rsulfuratus: well, in this case the solution is probably to set wParty differently in the "Imprisoned by" line
[2023-12-02 05:30 PM] Deciusmus: No, the thing that annoys me is the "by Dunmar Fellowship
[2023-12-02 05:30 PM] rsulfuratus: don't you just need to set the article?
[2023-12-02 05:31 PM] rsulfuratus: or is the issue that following the location chain somehow drops the article?
[2023-12-02 05:31 PM] Deciusmus: well, I want to be able to set the link text for Vindisjratan ->` Dunmar Fellowship as "owned by"
[2023-12-02 05:32 PM] Deciusmus: and potentially set the format to skip people
[2023-12-02 05:32 PM] Deciusmus: I think this is all close to doable
[2023-12-02 05:32 PM] rsulfuratus: why are you ever following into Dunmar Fellowship from Vindristjarna?
[2023-12-02 05:32 PM] Deciusmus: because its the current location
[2023-12-02 05:33 PM] rsulfuratus: Vindristjarna's location is "Dunmar Fellowship"?
[2023-12-02 05:33 PM] Deciusmus: aha
[2023-12-02 05:33 PM] Deciusmus: its because the home is set to dufr
[2023-12-02 05:33 PM] Deciusmus: you've been making it work nicely for you
[2023-12-02 05:33 PM] rsulfuratus: home is set because that is the only way to generate "Owned by: "
[2023-12-02 05:33 PM] Deciusmus: by setting the location
[2023-12-02 05:34 PM] rsulfuratus: yes
[2023-12-02 05:34 PM] Deciusmus: yeah, but if I lazily set the page target date to 1750
[2023-12-02 05:34 PM] Deciusmus: the current location becomes Dunmar Fellowship
[2023-12-02 05:34 PM] rsulfuratus: right but that is because of the fact that home is overloaded both as a location and as "owned by:"
[2023-12-02 05:35 PM] rsulfuratus: e.g. if you had a separate "Current Owners: Dunmar Fellowship"
[2023-12-02 05:35 PM] rsulfuratus: then you could set home to "Stormcaller Tower"
[2023-12-02 05:35 PM] rsulfuratus: and origin to unknown
[2023-12-02 05:36 PM] rsulfuratus: (with an end date for home as 1748 whenever)
[2023-12-02 05:36 PM] rsulfuratus: then in 1750 location would correctly be unknown
[2023-12-02 05:36 PM] Deciusmus: right
[2023-12-02 05:36 PM] rsulfuratus: and in 1720 location would correctly be Stormcaller Tower
[2023-12-02 05:36 PM] Deciusmus: It is a good argument for having ownership by separate from whereabouts
[2023-12-02 05:36 PM] rsulfuratus: that said, there are still reasons for things to be "located in" organizations
[2023-12-02 05:36 PM] Deciusmus: but by default you'd like an item's whereabouts to be its owners whereabouts
[2023-12-02 05:37 PM] Deciusmus: unless it doesn't have an owner
[2023-12-02 05:37 PM] rsulfuratus: yes
[2023-12-02 05:37 PM] rsulfuratus: so you do want to be able to set the location of an item to a person or an organization
[2023-12-02 05:38 PM] Deciusmus: but how is that different than owner?
[2023-12-02 05:38 PM] Deciusmus: isn't the idea that the default whereabout for an item is "owner"
[2023-12-02 05:38 PM] rsulfuratus: because an item can be somewhere that is not its owner while still being owned by that person, for one
[2023-12-02 05:39 PM] Deciusmus: but would that be a person
[2023-12-02 05:40 PM] Deciusmus: I mean, wouldn't that be something like
    
    whereabouts:
    - { location: xxx, type: away, start: xxx }
    - { location: owner, type: home }
[2023-12-02 05:42 PM] Deciusmus: the idea would be that you could set the owner, like:
    
    - { owner: Dunmar Fellowshop, start: x, end: y}
[2023-12-02 05:42 PM] Deciusmus: then you could set the whereabouts to be:
    
    whereabouts: owner
    
    which just means the whereabouts of this item is whatever the owner is
[2023-12-02 05:44 PM] Deciusmus: At some level owned by is just an affiliation. It goes back to the ruledBy vs leaderOf issue
[2023-12-02 05:45 PM] Deciusmus: You don‚Äôt want to set on the owners page all the items they own
[2023-12-02 05:46 PM] Deciusmus: Actually what you really want is a with tag
[2023-12-02 05:46 PM] Deciusmus: { type: with, with: (some other page) }
[2023-12-02 05:47 PM] Deciusmus: Which just means for this period of time, the page is wherever that other page is
[2023-12-02 05:49 PM] Deciusmus: That actually solves a lot of issues because if you have a group of people traveling around you can pick one and set the rest as with the other person
[2023-12-02 05:49 PM] rsulfuratus: how is that different from just setting the location?
[2023-12-02 05:49 PM] Deciusmus: You don‚Äôt get the intermediate person / whatever in the page
[2023-12-02 05:50 PM] Deciusmus: And you correctly get unknown if the other person is unknown
[2023-12-02 05:50 PM] rsulfuratus: sure, but that is basically just a shorthand for "format:plo" or whatever is it not?
[2023-12-02 05:51 PM] Deciusmus: Well, you won‚Äôt get unknown
[2023-12-02 05:51 PM] rsulfuratus: (with the additional correct setting of unknown locations, which probably should always happen if the whereabouts of the target are unknown when you follow a chain)
[2023-12-02 05:52 PM] rsulfuratus: i would argue that is just a bug
[2023-12-02 05:52 PM] rsulfuratus: if the location of something is a place with an unknown whereabout, the chain should be: "target, Unknown"
[2023-12-02 05:53 PM] Deciusmus: But a place can‚Äôt have an unknown whereabout
[2023-12-02 05:53 PM] Deciusmus: The whereabout is the place. I don‚Äôt know what you mean
[2023-12-02 05:53 PM] rsulfuratus: "The Lost Inn", an inn ~somewhere~ that can only be reached by teleportation
[2023-12-02 05:53 PM] rsulfuratus: Wizard Y is in "The Lost Inn"
[2023-12-02 05:54 PM] rsulfuratus: there location should be: 
    "The Lost Inn, Unknown"
[2023-12-02 05:54 PM] rsulfuratus: (with nicer formatting)
[2023-12-02 05:54 PM] rsulfuratus: but conceptually that is their location
[2023-12-02 05:54 PM] Deciusmus: and that would work if you explicitly made the location of the lost inn unknown by adding whereabouts: Unknown
[2023-12-02 05:55 PM] rsulfuratus: I just don't see why you need a special "with" type when you can exactly cover the use case with the current setup
[2023-12-02 05:55 PM] Deciusmus: I'm talking about the case of:
    
    3 NPCs (A, B, C) travelling together
[2023-12-02 05:55 PM] Deciusmus: are you suggesting I set, on NPC B, type: away, location: A
[2023-12-02 05:56 PM] rsulfuratus: sure, why not?
[2023-12-02 05:56 PM] rsulfuratus: format: p
[2023-12-02 05:56 PM] rsulfuratus: although if you have a group traveling together for a while it might make sense for them to be an organization
[2023-12-02 05:57 PM] rsulfuratus: this is how I was going to set up all my halfling families and such
[2023-12-02 05:57 PM] rsulfuratus: it was the original use case for the "skip organizations/people" in the format specification
[2023-12-02 05:57 PM] Deciusmus: I think the main issue is that it doesn't handle unknown correctly
[2023-12-02 05:58 PM] rsulfuratus: but that should be fixable without needing to invent a "with" type
[2023-12-02 05:58 PM] Deciusmus: I don't think so, you can't distinguish
[2023-12-02 05:58 PM] Deciusmus: i.e. how do you tell the difference between "the next level has no location, so I stop" vs "the next level has no location, so I say my location is unknown"
[2023-12-02 05:59 PM] Deciusmus: you can't just always output unknown or you get things like
    
    Dunmar, the West Coast Region, Unknown
[2023-12-02 05:59 PM] Deciusmus: the idea behind with is it would actually be handled during whereabouts normalization, not during display
[2023-12-02 06:00 PM] rsulfuratus: theoretically if everything is set properly you always end at Taelgar or Unknown
[2023-12-02 06:01 PM] rsulfuratus: Taelgar can't be unknown (although I guess technically you could always stop at one of `[Echo Realms, Spiritual Realms, Energy Realms, Material Plane]`
[2023-12-02 06:01 PM] rsulfuratus: maybe that is better because then you can have demiplanes in unknown locations
[2023-12-02 06:01 PM] Deciusmus: right I think I first saw this issue with fey realms
[2023-12-02 06:01 PM] Deciusmus: but it feels like a bunch of ugly special casing to me
[2023-12-02 06:02 PM] rsulfuratus: what is the special casing?
[2023-12-02 06:02 PM] Deciusmus: the chain termination
[2023-12-02 06:02 PM] Deciusmus: actually, in general, i think the location filters were a bit of a mistake
[2023-12-02 06:03 PM] Deciusmus: I think it encourages representing everything under the sun as a whereabout, but that isn't really necessarily sensible
[2023-12-02 06:03 PM] Deciusmus: it is just what was working
[2023-12-02 06:04 PM] Deciusmus: I dunno, I'm not sure this is really what I want to be spending my energy on
[2023-12-02 06:05 PM] rsulfuratus: i mean, fair
[2023-12-02 06:05 PM] Deciusmus: but my basic argument for with is that 
    * {type: with, person: Dunmar Fellowship, start: X, end Y }
    
    is way more clear than
    
    * { type: away, location: Dunmar Fellowship, start: X, end Y, format: plo }
[2023-12-02 06:06 PM] rsulfuratus: sure
[2023-12-02 06:07 PM] rsulfuratus: I think with is a good shorthand
[2023-12-02 06:07 PM] Deciusmus: and it encourages using whereabouts to represent locations in space
[2023-12-02 06:07 PM] rsulfuratus: but I guess my argument is there are plenty of gray areas
[2023-12-02 06:09 PM] rsulfuratus: so if for example I want to represent a person in one of Cha'mutte's shadow realms, is that "with" or "away"?
[2023-12-02 06:10 PM] rsulfuratus: I agree that it is good practice to have clear metadata that can be understood at a glance, and with helps a lot with that
[2023-12-02 06:10 PM] rsulfuratus: but that also leaves problems
[2023-12-02 06:10 PM] rsulfuratus: like how to dates work? if you set a start but not an end, does it behave like home or away?
[2023-12-02 06:13 PM] Deciusmus: I think with is like home
[2023-12-02 06:13 PM] Deciusmus: i.e. no start = 0001, no end = 9999
[2023-12-02 06:14 PM] Deciusmus: the key thing about with is that it would elide the thing you are with
[2023-12-02 06:17 PM] rsulfuratus: This feels a bit like going in circles. Eg Garret Tealeaf was with Charmhearts, but I don‚Äôt know if he still is,
[2023-12-02 06:18 PM] rsulfuratus: So now I‚Äôm back to using away
[2023-12-02 06:18 PM] rsulfuratus: I think we have really different preferences with unknown information
[2023-12-02 06:20 PM] rsulfuratus: I also really want to be able to record the minimally ‚Äúknown‚Äù information without having to fill out a ton of detail
[2023-12-02 06:20 PM] rsulfuratus: So for example I want to be able to say: ‚ÄúGarret was with Charmhearts on 1748-11-12, but I‚Äôm not sure what happened after‚Äù
[2023-12-02 06:21 PM] rsulfuratus: If I later update Charmhearts location without deciding it Garret is with them, I don‚Äôt want Garret‚Äôs location to update
[2023-12-02 06:22 PM] rsulfuratus: Maybe you scry Ander Charmheart for some unknown reason and I just improvise a location. But you only see him and Calle in an inn together
[2023-12-02 06:23 PM] rsulfuratus: Now I want to record ‚Äúcharmhearts at X location on Y date, delwath scryed‚Äù
[2023-12-02 06:23 PM] rsulfuratus: But maybe I just invented a random inn and I don‚Äôt even know where it is yet.
[2023-12-02 06:23 PM] rsulfuratus: The inn should then have unknown whereabouts
[2023-12-02 06:25 PM] rsulfuratus: basically my two goals with metadata are:
    1) capture the minimal canonical information I need without having to invent details I'm not ready to
    2) have Obsidian automatically tell me what other relevant canonical information exists
[2023-12-02 06:26 PM] rsulfuratus: so having all these densely interlinked pages should be *possible* but it shouldn't be *necessary*
[2023-12-02 06:26 PM] rsulfuratus: which is not to say the idea of with is bad, I like that, but I guess I'd just be inclined to rethink a bit how everything is structured before jumping ahead to write another piece of special-parsing code
[2023-12-02 06:28 PM] rsulfuratus: maybe for example we should be revisiting the distinction between explicit "this is unknown" and implicit "this is blank so it is unknown"
[2023-12-02 06:28 PM] rsulfuratus: I don't know
[2023-12-02 06:29 PM] rsulfuratus: at some point when I have time I will probably look at this in code but I just can't write or understand javascript nearly as fast as you, so you have a tendency to generate new things before I can possibly grasp how you are representing old things
[2023-12-02 06:33 PM] rsulfuratus: anyway, I've mostly been working on a photobook for Matt and Nancy for christmas this afternoon and haven't really been thinking about this too deeply, so some of this might not have been carefully thought out
[2023-12-02 07:26 PM] rsulfuratus: I pushed some metadata brainstorming to MoC but now Kate and I are going out so won‚Äôt think about this more until tomorrow
[2023-12-02 09:15 PM] Deciusmus: So, to circle back to the very simple thing I wanted to do, here is my proposal for new whereabouts, with examples.
    
    whereabouts on a halfing:
    - {type: home, location: Wave Dancer, format: "`<linktext>` `<name>`, `<ancestry:a>` `<maintype>`" }
    
    next in chain, Wave Dancer:
    - {type: away, start: 1748-09-30, end: 1748-10-11, location: sailing to Wahacha, startFilter: "2" }
    
    Generates:
    >` Based on the Wave Dancer, a halfling boat, sailing to Wahacha, in the Vermillion Isles
    
    ---
    
    If the date changes, the next in chain is:
    
    - {type: away, start: 1748-10-12, end: 1748-10-14, location: Wahacha, linkText: at port in, startFilter: "2" }
    
    Generates:
    >` Based on the Wave Dancer, a halfling boat, at port in Wahacha, in the Vermillion Isles
    
    This is demonstrating two features: the format and the link text.
[2023-12-02 09:16 PM] Deciusmus: Alternatively, you could do:
    
    - {type: away, start: 1748-10-12, end: 1748-10-14, alias: main port of Wacahca, location: Wahacha, linkText: moored in, startFilter: "2" }
    
    >` Currently moored in the main port of Wacahca, in the Vermillion Isles
[2023-12-02 09:16 PM] Deciusmus: There are basically four features this is demostrating:
    
    1) startFilter. This replaces the old "format", and defines the filter (using the existing rules) `*`if the whereabout chain starts with this item*. The filter doesn't change as you go through the chain, so if the whereabouts chain starts somewhere else, this is ignored
[2023-12-02 09:18 PM] Deciusmus: So for example Wave Dancer has a startFilter of "2", which eans that it only goes 2 in the chain (Wahacha, Vermillion Isles). but that filter has no impact on the location of the halfling on the boat
[2023-12-02 09:18 PM] Deciusmus: This isn't really a functional change, but it makes the rules much more clear
[2023-12-02 09:19 PM] Deciusmus: 2) format string. This is a format string for this particular whereabout.
    
    So for example format: "`<linktext>` `<name>`, `<ancestry:a>` `<maintype>`" in the location: Wave Dancer whereabout means
    
    * Pass that format string into string formatter, using all the usual rules, and use the return for `*`this piece of the chain*
[2023-12-02 09:19 PM] Deciusmus: i.e that generates on the Wave Dancer, a halfling boat
[2023-12-02 09:20 PM] Deciusmus: 3) linkText override. By default, the linkText comes from the displayDefaults of the *target* page. So for example in this line:
    
    { type: home, location: The Red Lily Inn, format: "`<linktext>` `<name>`" }
    
    The linktext comes from The Red Lily Inn's page (either the display default for the type, or an overridden one for the page)
[2023-12-02 09:21 PM] Deciusmus: but if you specify it on the line, it gets overridden. So for example:
    
    { type: away, location: The Red Lily Inn, format: "`<linktext>` `<name>`", linkText: staying at }
    
    Means that instead of using the default linkText from the Red Lily Inn, we use staying at
[2023-12-02 09:21 PM] Deciusmus: Note that you could achieve the same thing via:
    
    format: "staying at `<name>`"
[2023-12-02 09:22 PM] Deciusmus: (the default format string is "`<linktext>` `<name>`")
[2023-12-02 09:22 PM] Deciusmus: Finally, alias.
    
    Alias is special, it replaces the name `*`inside the link*
[2023-12-02 09:23 PM] Deciusmus: So if you have
    
    - {type: away, start: 1748-10-12, end: 1748-10-14, alias: main port of Wacahca, location: Wahacha, linkText: moored in, startFilter: "2" }
    
    You get:
    
    Currently moored in the [[main port of Wacahca]], in the Vermillion Isles
[2023-12-02 09:24 PM] Deciusmus: The same thing could be achieved with format string like
    
    format: "moorred in the main port of `<name:x>`" (x = no article)
[2023-12-02 09:24 PM] Deciusmus: except that only Wacahca will be linked in that case
[2023-12-02 09:24 PM] Deciusmus: as opposed to main port of Wacaha being linked via an alias (i.e. technically it is Currently moored in the [[main port of Wacahca|Wacahca]], in the Vermillion Isles
[2023-12-02 09:28 PM] rsulfuratus: that all seems really nice
[2023-12-02 09:29 PM] Deciusmus: The one thing I want to fix is the ability to have different default link text based on source and target types
[2023-12-02 09:30 PM] Deciusmus: Because right now it generates 
    
    In Cleenseau, in the Barony of Averil, in Sembara
[2023-12-02 09:30 PM] Deciusmus: I‚Äôd like to be able to define the place-place link text as empty
[2023-12-02 09:30 PM] Deciusmus: By default
[2023-12-02 09:31 PM] rsulfuratus: one thing that I was doing for some places is setting it so that instead of "A city in Ursk" it is just "An Urskan city"
[2023-12-02 09:32 PM] rsulfuratus: but if that is the middle part of a chain you don't necessarily want that behavior
[2023-12-02 09:32 PM] Deciusmus: Right,  but for that you are setting the wCurrent or wHome
[2023-12-02 09:33 PM] rsulfuratus: yes that is probably the correct way to do it
[2023-12-02 09:34 PM] rsulfuratus: you can also achieve it was format strings in the current setup
[2023-12-02 09:34 PM] Deciusmus: Right those still work
[2023-12-02 09:34 PM] Deciusmus: But they only apply to the first element
[2023-12-02 09:35 PM] Deciusmus: Ie the wHome on a whereabouts line replaces the wHome on a page when that whereabout is the home whereabout
[2023-12-02 09:36 PM] Deciusmus: But that has no impact on what happens if that whereabout is the second location in a chain
[2023-12-02 09:36 PM] rsulfuratus: so this: 
    - {type: home, location: Ursk, format: f}
    will only skip "Ursk" when that whereaout is displayed on the current page (which is existing behavior)
[2023-12-02 09:36 PM] rsulfuratus: okay, that makes sense
[2023-12-02 09:36 PM] Deciusmus: Yeah except I renamed format to startFilter
[2023-12-02 09:39 PM] Deciusmus: To make it clear that
    (a) this is a filter - qxa etc are ignored 
    (b) it only applies when this whereabout is the start of the chain
[2023-12-02 09:40 PM] rsulfuratus: that makes sense
[2023-12-02 09:40 PM] rsulfuratus: I like that
[2023-12-02 09:41 PM] rsulfuratus: do things like the region filter / type filters still apply up the chain?
[2023-12-02 09:42 PM] rsulfuratus: what if you put a person as the location but don't want that person to show up? you need something like P on the start chain right?
[2023-12-02 09:42 PM] rsulfuratus: although this would ultimately be the use case for e.g. a "with" type
[2023-12-02 09:42 PM] Deciusmus: The start filter is carried all the way along
[2023-12-02 09:43 PM] Deciusmus: So if you have r in the startFilter you get no regions anywhere along the chain
[2023-12-02 09:43 PM] rsulfuratus: can you still apply filters as part of format, e.g. wCurrent: Currently `<current:r>`?
[2023-12-02 09:43 PM] Deciusmus: Yes
[2023-12-02 09:44 PM] Deciusmus: Those are the default start filter
[2023-12-02 09:44 PM] rsulfuratus: but presumably the startFilter overrides
[2023-12-02 09:44 PM] Deciusmus: Yes
[2023-12-02 09:44 PM] rsulfuratus: if there is conflict
[2023-12-02 09:44 PM] Deciusmus: Unless you have !
[2023-12-02 09:44 PM] rsulfuratus: right
[2023-12-02 09:45 PM] rsulfuratus: I will have to play around to see
[2023-12-02 09:45 PM] rsulfuratus: but it sounds like a nice system
[2023-12-02 09:46 PM] rsulfuratus: need to think about how it interacts with campaignInfo / lastknown a bit
[2023-12-02 09:46 PM] rsulfuratus: but perhaps that is not an issue if those will be handled in a different way
[2023-12-02 09:50 PM] rsulfuratus: I guess it is mostly an issue for campaignInfo lines. for example I wouldn't want to repeat "a halfling boat" every time Emerald Song shows up, just once. so for a person like Wella Brightmoon you might want:
    - Based on the Wave Dancer, a halfling ship
    - Met by Wellby on September 30th, 1748 on the Wave Dancer, sailing to Wahacha, the Vermillion Isles
    - Last seen by Wellby on October 12th, 1748 on the Wave Dancer, at port in Wahacha, the Vermillion Isles
[2023-12-02 09:50 PM] rsulfuratus: anyway, Kate is done ordering pjs so I
[2023-12-02 09:51 PM] rsulfuratus: so I'm signing off. if you push this stuff I will play around tomorrow and get a better feel for it
[2023-12-02 10:18 PM] Deciusmus: pushed to  new-whereabouts

