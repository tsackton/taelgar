# Discord DM â€“ 2023-01-10

[2023-01-10 07:35 AM] Deciusmus: My NPC list is manual at the moment
[2023-01-10 11:53 AM] Deciusmus: NPC tags a little tricky given shared npcs
[2023-01-10 11:53 AM] Deciusmus: should we do NPC/`<campaign>`/`<importance>`
[2023-01-10 11:53 AM] rsulfuratus: I am using:
    campaign/major, campaign/minor, campaign/background to indicate significance (mutually exclusive)
    campaign/met, campaign/aware, campaign/unaware to indicate whether the party has met the person, knows of the person, or does not know of the person (mutually exclusive and hierarchical, so met implies aware and aware implies unmet)
    historical to indicate the NPC is a historical figure. usually reserved for people who died a while ago. can be added to campaign tags.
[2023-01-10 11:53 AM] rsulfuratus: yes
[2023-01-10 11:54 AM] rsulfuratus: will push some updates momentarily so you can see how I'm doing it
[2023-01-10 11:54 AM] rsulfuratus: but NPC/campaign/`<whatever>` can diverge
[2023-01-10 11:54 AM] Deciusmus: so you'd have
    
    tags: `[NPC/DuFr/Major, NPC/DuFr/unaware]`
    
    or something else might have
    
    `[NPC/Historical]`?
[2023-01-10 11:55 AM] rsulfuratus: I'm tagging all NPCs with NPC/DuFr/`<something>`
[2023-01-10 11:55 AM] Deciusmus: ah, ok
[2023-01-10 11:55 AM] rsulfuratus: so for example some random sembaran royalty would be NPC/DuFr/unaware, NPC/historical
[2023-01-10 11:56 AM] rsulfuratus: and Apollyon would be NPC/DuFr/major, NPC/DuFr/aware, NPC/historical
[2023-01-10 11:56 AM] rsulfuratus: something like that
[2023-01-10 11:56 AM] Deciusmus: right, I see
[2023-01-10 11:56 AM] rsulfuratus: the ultimate goal is to remove the auto-export of people and build a nice NPC index with dataview for each campaign separately
[2023-01-10 11:57 AM] rsulfuratus: although you can click through to some random NPC pages in your export because of the way linking works. e.g. you can find Delwath if you click through enough backlinks
[2023-01-10 11:58 AM] Deciusmus: Is that because of links via the Gazeeteer, or because of tags?
[2023-01-10 11:58 AM] rsulfuratus: because of Gazetteer links
[2023-01-10 11:58 AM] Deciusmus: its hard to avoid that at some level
[2023-01-10 11:59 AM] rsulfuratus: e.g. elf ->` forest of dreams ->` ko'zula ->` forest of nightmares ->` delwath
[2023-01-10 11:59 AM] rsulfuratus: but  I actually kind of like it. all important secrets are hidden with `%%` so if any player is curious enough to just click around and find things to ask about that is 100% fine with me
[2023-01-10 12:00 PM] Deciusmus: I just need to make sure the sembaran history is sanitized
[2023-01-10 12:00 PM] rsulfuratus: right, it is a bit trickier for your gam.e
[2023-01-10 12:01 PM] rsulfuratus: the javascript replacement for the npc header helps a fair bit
[2023-01-10 12:01 PM] Deciusmus: I'm perfectly happy for someone who bothers to read to know more about Chardon and Dunmar than someone else
[2023-01-10 12:01 PM] rsulfuratus: in fact it would probably be possible to set it up so that if dateBorn >` currentYear, the entire content of the note is wrapped in `%%`
[2023-01-10 12:01 PM] Deciusmus: that would be clever
[2023-01-10 12:02 PM] rsulfuratus: history notes are trickier
[2023-01-10 12:02 PM] rsulfuratus: probably need to be manually sanitized
[2023-01-10 12:05 PM] Deciusmus: you are using dataview and what other plugin?
[2023-01-10 12:05 PM] rsulfuratus: customjs
[2023-01-10 12:05 PM] rsulfuratus: that is what lets you load arbitrary javascript into a dataviewjs codeblock
[2023-01-10 12:06 PM] Deciusmus: Evaluation Error: TypeError: Cannot read properties of undefined (reading 'getPronouns')
        at eval (eval at `<anonymous>` (plugin:dataview), `<anonymous>`:4:25)
        at async DataviewJSRenderer.render (plugin:dataview:19766:13)
[2023-01-10 12:08 PM] rsulfuratus: huh it was working last night
[2023-01-10 12:09 PM] rsulfuratus: I added a bunch of comments to the end of the file, seems to work if you remove the comments for some reason
[2023-01-10 01:26 PM] Deciusmus: i just moved them to the front
[2023-01-10 01:27 PM] Deciusmus: fyi CTL-SHIFT-I (at least on windows) opens the javascript debug console which is very useful
[2023-01-10 02:57 PM] rsulfuratus: pushed a prototype of an NPC template that autogenerates an NPC page from separate subnotes. allows an easy way to report information about that NPC at a specific time. 
    
    the major downside is that as best as I can tell, it requires that the main NPC page simply be an autogenerated template, and you keep the actual meaningful text in a separate file (or potentially multiple files for different sections). 
    
    this could be enough of an annoyance that it isn't worthwhile, primarily because of the way it messes with links. you would presumably want links to hit the autogenerated template, but that means that you can't look at links while you edit.
[2023-01-10 02:59 PM] rsulfuratus: on the other hand, you could set up the NPCNAME.text page with a dataview frontend code block that would include backlinks from the template, yaml from the template, and a few other things.
[2023-01-10 04:14 PM] Deciusmus: does it work with html export?
[2023-01-10 04:15 PM] rsulfuratus: it would work with the obs.html package you found
[2023-01-10 04:15 PM] rsulfuratus: but I haven't tested it
[2023-01-10 04:16 PM] Deciusmus: did you actually push? I don't see a change
[2023-01-10 04:17 PM] rsulfuratus: oops got caught in a meeting
[2023-01-10 04:17 PM] rsulfuratus: pushed now
[2023-01-10 04:17 PM] rsulfuratus: although was just messing around so the current version doesn't actually quite work
[2023-01-10 04:18 PM] rsulfuratus: trying to get it to insert section links instead of full files
[2023-01-10 04:21 PM] Deciusmus: I'm not sure I follow the downside with links
[2023-01-10 04:21 PM] Deciusmus: you just link to [[Tester]` what is the issue?
[2023-01-10 04:22 PM] rsulfuratus: ah. right, that's fine. but when I am translating my NPC notes from the scattered OneNote format to a consistent note in Obsidian, I often rely on the backlines to an NPC, like in which Session Notes is this NPC mentioned?
[2023-01-10 04:22 PM] rsulfuratus: can't see that with this system, since you only edit the text in tester.text which has no incoming links
[2023-01-10 04:22 PM] Deciusmus: Ah, I see
[2023-01-10 04:23 PM] Deciusmus: But realistically it would crazy to go to this much trouble for every NPC
[2023-01-10 04:23 PM] Deciusmus: And also you are ahead, so for you it would never really matter
[2023-01-10 04:24 PM] Deciusmus: Unless we end up in Sembara or something and you are expanding on my Sembara stuff
[2023-01-10 04:24 PM] rsulfuratus: I only have like 12-13 NPCs / groups of NPCs that I care about tracking their movement and chronology, so yes it is not that many
[2023-01-10 04:24 PM] Deciusmus: But even then, why bother with this?
[2023-01-10 04:25 PM] rsulfuratus: it annoys my sense of organization to have some NPC pages autogenerated from a template and some NPC pages freeform? no real reason
[2023-01-10 04:25 PM] Deciusmus: Ah
[2023-01-10 04:25 PM] Deciusmus: well
[2023-01-10 04:25 PM] Deciusmus: tell your sense of organization you have better things to do ðŸ™‚
[2023-01-10 04:26 PM] Deciusmus: For me... this would be extremely useful for a couple of key pages, like say Robert I.
    
    I could write a section about the lich thing and only import it if current date >` 1722
[2023-01-10 04:26 PM] Deciusmus: and so on
[2023-01-10 04:27 PM] Deciusmus: And also gives us both a convinent way to manage "shared NPCs" (i.e. NPCs that are actually showing up in both games)
[2023-01-10 04:28 PM] rsulfuratus: you don't even need dataview blocks for this,
[2023-01-10 04:28 PM] rsulfuratus: i'd have to test with html but if you do:
    ```
    `%%`
    ![[link.to.secret.info]]
    `%%`
    ```
[2023-01-10 04:29 PM] rsulfuratus: you'll get the text of the note displayed in a comment block which will (I presume) be stripped out by the html generator
[2023-01-10 04:29 PM] Deciusmus: Right but what problem does that solve?
[2023-01-10 04:31 PM] rsulfuratus: right, I guess the benefit of the import conditional on date is that info from the past could show up as history in my taelgarverse website but not show up in your 1720 website
[2023-01-10 04:31 PM] Deciusmus: yes
[2023-01-10 04:32 PM] Deciusmus: Or let's say it made sense to have Dain Goldhammer show up in my game
[2023-01-10 04:33 PM] Deciusmus: I could remove the "part of a group that explored eudome's tower"
[2023-01-10 04:33 PM] Deciusmus: that is not very realistic at some level as why bother?
[2023-01-10 04:33 PM] Deciusmus: but it would be possible to kick that out to a chronology section that only gets imported in your version
[2023-01-10 04:37 PM] rsulfuratus: right, how much effort is it really worth to have the player-facing version of NPCs they will probably never meet be totally consistent with the current history of the world?
[2023-01-10 04:37 PM] rsulfuratus: where I was actually more interested in this is for cross-campaign NPCs between Great Library / Mawar / Dunmari Frontier. mostly Great Library vs Dunmari Frontier as there is little point in keeping Mawar stuff "secret"
[2023-01-10 04:38 PM] rsulfuratus: I was starting to dump a bunch of Great Library NPCs but it adds a lot of clutter and I wanted a way to only import "Dunmari Frontier" information
[2023-01-10 04:38 PM] Deciusmus: Ah
[2023-01-10 04:38 PM] rsulfuratus: part of the problem is that dataverse doesn't have a good way to query sections within a file
[2023-01-10 04:39 PM] Deciusmus: What I am interested in this for is because it offends my sense of completeness to have the Sembaran history just end in 1719
[2023-01-10 04:39 PM] rsulfuratus: yeah, that too
[2023-01-10 04:39 PM] Deciusmus: So for me, I'd like to have the flexibility to be able to
    (a) contribute to/make up stuff up to the 'present day' via the git repo
    (b) still exclude the stuff I make up "post my game" from the data my players see
[2023-01-10 04:40 PM] rsulfuratus: a good general script to pull information X from note Y and insert into note Z conditional on (game year, campaign, etc) would be great for many things
[2023-01-10 04:40 PM] Deciusmus: yeah
[2023-01-10 04:41 PM] rsulfuratus: so that is what I was trying to figure out, but then if that works, it appeals to me to autotemplate every NPC in a way that naturally can grow for the ~15 really important NPCs and stay simple for the ~100 background NPCs
[2023-01-10 04:42 PM] Deciusmus: do you know what the javascript for inserting a note is?
[2023-01-10 04:42 PM] rsulfuratus: I've been using  ```await dv.io.load("File") =>` "# File\nThis is an example file..."```
[2023-01-10 04:42 PM] rsulfuratus: https://blacksmithgu.github.io/obsidian-dataview/api/code-reference/
[2023-01-10 04:43 PM] rsulfuratus: returns the contents of "File" as a string
[2023-01-10 04:47 PM] rsulfuratus: so this reads the contents of Tester.text and prints it:
    ```
    let Overview = await dv.io.load("_templates/testing/Tester.text.md")
    dv.paragraph(Overview)
    ```
[2023-01-10 04:48 PM] rsulfuratus: what I haven't figured out how to do are:
    1) get a path from a dataview Link objects
    2) extract only part of a target note, e.g. just one section
[2023-01-10 04:49 PM] rsulfuratus: neither is totally critical but makes building an NPC template way easier, since you can have extraneous stuff on the NPCNAME.text page that isn't loaded into the template
[2023-01-10 05:32 PM] Deciusmus: ```for (let group of dv.pages("#sembara-person-events")) {
       if (group.eventDate >` 1719) {
            var link = group.file.link
            link.embed = true
            dv.span(link)
       }
    }
    ```
[2023-01-10 05:33 PM] Deciusmus: 
![[../_discord_assets/image-5B4A5.png]]
[2023-01-10 05:33 PM] Deciusmus: 3 files in my vault
![[../_discord_assets/image-56567.png]]
[2023-01-10 05:33 PM] Deciusmus: with frontmatter like:
    ---
    eventDate: 1700
    tags: `[sembara-person-events ]`
    ---
[2023-01-10 05:35 PM] rsulfuratus: nice. so basically you have to stick with the concept of one event = one note, but in that framework you can do a lot
[2023-01-10 05:36 PM] rsulfuratus: is there a reason you have to use tags? couldn't you just have a _events directory and scan that for file.name matches Sembara Person?
[2023-01-10 05:37 PM] rsulfuratus: I use the tag browser a fair bit so avoiding a huge amount of tag proliferation would be nice (but not critical)
[2023-01-10 05:51 PM] Deciusmus: laziness to prove the concept
[2023-01-10 05:51 PM] Deciusmus: but also, it can be sections
[2023-01-10 05:52 PM] Deciusmus: i.e. it doesn't have to be one-event = one file
[2023-01-10 05:52 PM] Deciusmus: i.e. you could have
    
    eventEndDate = 1721
[2023-01-10 05:52 PM] Deciusmus: and that could describe everything from birth ->` 1721
[2023-01-10 05:53 PM] rsulfuratus: ah right, it just needs to be one file per chunk of text you retreive
[2023-01-10 05:54 PM] Deciusmus: Right
[2023-01-10 05:58 PM] Deciusmus: even better
[2023-01-10 05:58 PM] Deciusmus: ```
    let currentFolder = "\"" + dv.current().file.folder + "\""
    for (let group of dv.pages(currentFolder).sort(f =>` f.eventEndDate)) {
       if (group.name == dv.current().name)
       if (group.eventEndDate >` 1719) {
            var link = group.file.link
            link.embed = true
            link.display = "natural"
            dv.span(link)
       }
    }
    ```
[2023-01-10 05:59 PM] Deciusmus: gets every file in the same folder as the current where the frontmatter name matches the NPC name
[2023-01-10 06:01 PM] rsulfuratus: cool
[2023-01-10 06:02 PM] Deciusmus: here's the final.. gotta go make dinner but can push if you want:
    
    ```
    let currentYear = window.FantasyCalendarAPI.getCalendars()`[0]`.current.year
    let currentFolder = "\"" + dv.current().file.folder + "\""
    for (let group of dv.pages(currentFolder).sort(f =>` f.eventEndDate)) {
       if (group.name == dv.current().name && group.type == "NPC_Event")  {  
          if (group.eventEndDate `<= currentYear) {
             var link = group.file.link
            link.embed = true
            link.display = "natural"
            dv.span(link)
          }
       }
    }
    ```
[2023-01-10 06:03 PM] Deciusmus: requires frontmatter of:
    
    eventEndDate: `<year>`
    name: matching person
    type: NPC_Event
[2023-01-10 06:03 PM] rsulfuratus: that's great
[2023-01-10 06:03 PM] Deciusmus: it looks a bit weird without custom CSS to tweak the rendering of the embed block
[2023-01-10 06:03 PM] rsulfuratus: feel free to push but I am not using it yet, focusing on just the templater frontmatter and getting NPC info into obsidian
[2023-01-10 06:04 PM] Deciusmus: i'm using this
Attachment (embed-fixes.css):
```css
.internal-embed[alt="natural"] .file-embed-title,
.internal-embed[alt="natural"] .markdown-embed-title {
display: none;
}
.internal-embed[alt="natural"]>.markdown-embed {
padding: inherit;
border: 0;
}
.markdown-reading-view .markdown-preview-view:not(.is-readable-line-width)>.markdown-preview-sizer {
margin: inherit;
}
```
[2023-01-10 06:04 PM] rsulfuratus: you should be able to get the path from a dv link and then use dv.io.load to get the text, and use dv.paragraph to format how you like
[2023-01-10 06:05 PM] rsulfuratus: although presumably the same obs.html plugin that renders dataviewjs for html export can use the custom css as well
[2023-01-10 06:06 PM] Deciusmus: The problem with dv.io.load is that it has the yaml frontmatter
[2023-01-10 06:07 PM] rsulfuratus: ah right
[2023-01-10 06:07 PM] rsulfuratus: right that is why I was trying to get text of just a section
[2023-01-10 06:07 PM] rsulfuratus: but your way looks like it will work
[2023-01-10 06:12 PM] rsulfuratus: I am trying to get all my NPC notes into Obsidian and want to remove the NPC/unsorted tag from everyone I've looked at. for your sembara NPCs I am using NPC/DuFr/unaware, and also NPC/`<campaignTag>`/unsorted, do you care what campaign tag we use for the Cleenseau campaign?
[2023-01-10 06:13 PM] Deciusmus: I was using Cleenseau but if you want something shorter anything is fine
[2023-01-10 06:15 PM] rsulfuratus: okay, I'll probably use Clee which is pretty obvious and easy to type
[2023-01-10 07:15 PM] rsulfuratus: using this for the Charmhearts page, since they probably pass through Cleenseau frequently
[2023-01-10 07:15 PM] rsulfuratus: pretty nice
[2023-01-10 07:16 PM] rsulfuratus: where do you put the .css file?
[2023-01-10 07:17 PM] Deciusmus: 
![[../_discord_assets/image-CBF8F.png]]
[2023-01-10 07:17 PM] Deciusmus: in settings
[2023-01-10 07:19 PM] Deciusmus: I have this in my Ausson's Crossing document:
    
    The Halfling Caravan
    A caravan of halflings from Chardon, bound for Embry in Sembara has been staying here for the last few days. Mostly keeping to themselves, the caravan has four wagons, a dozen horses, and the following halflings:
    
    Bree Charmheart (she/her), the trademaster and spokesperson
    Cora Charmheart (she/her), an elderly woman, often seen in the Inn common room
    Anders Charmheart (he/him), the quartermaster and cook
    
    There are a dozen other halflings including several children, who have mostly kept to the wagons. They are carrying clockwork, stained glass, fireworks, intricate toys, and fine cloth from Chardon, and have some elaborate systems in the wagons to protect the goods in transit.
[2023-01-10 07:19 PM] Deciusmus: Haven't gotten to adding that to obisidian yet since that game is over
[2023-01-10 07:54 PM] rsulfuratus: when is this?
[2023-01-10 07:54 PM] rsulfuratus: I don't remember when your Ausson's Crossing game was set
[2023-01-10 08:07 PM] Deciusmus: Originally 1650s but I've moved it to 1688
[2023-01-10 08:07 PM] Deciusmus: There are actually a couple of crossovers my players want to do with aged versions of their characters from that game

