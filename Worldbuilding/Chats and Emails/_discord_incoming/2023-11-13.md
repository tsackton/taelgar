# Discord DM ‚Äì 2023-11-13

[2023-11-13 04:55 PM] rsulfuratus: messing around a bit with metadata ideas some more. pushed a few updates to metadata spec mostly with some thoughts, on the clean_metadata branch
[2023-11-13 04:55 PM] rsulfuratus: mostly, feels like people is pretty clear, but other types are not
[2023-11-13 04:56 PM] rsulfuratus: not sure the repo is the best place to think through ideas though
[2023-11-13 04:58 PM] rsulfuratus: in particular, we have a lot of different types of notes in gazetteer, including specific buildings, settlements, geographic features, culture/politics, civilizations/kingdoms (which overlap but don't totally encompass culture), big regions, etc
[2023-11-13 05:24 PM] Deciusmus: I was also messing around a bit.
    
    This:
    
    ```dataviewjs
    const { metadataUtils } = customJS
    
    await dv.view("_scripts/view/get_PersonTable", {     
        header: `["Location", "Name", "Born"]`,
        map: p =>` `[p.currentLocation, p.name, p.life.startDate?.display ?? "unknown" ]`,
        where: p =>` metadataUtils.inLocation("Dunmar", p.file.frontmatter)
    } )
    ```
    
    Generates this:
![[../_discord_assets/image-D6BA1.png]]
[2023-11-13 05:25 PM] Deciusmus: For everyone with 
    (a) proper whereabouts data
    (b) where they are currently in Dunmar
[2023-11-13 05:26 PM] Deciusmus: did you push to the clean_metadata branch?
[2023-11-13 05:44 PM] Deciusmus: Here is the current location of everyone who is from the feywild
![[../_discord_assets/image-4324B.png]]
[2023-11-13 05:44 PM] rsulfuratus: yes pushed to clean_metadata
[2023-11-13 05:48 PM] rsulfuratus: did you push that script? i don't see it on either branch
[2023-11-13 05:49 PM] Deciusmus: no, haven't pushed
[2023-11-13 05:52 PM] Deciusmus: there is a moderately serious memory leak of some kind
[2023-11-13 05:52 PM] rsulfuratus: paste it into chatgpt and ask it to find the memory leak
[2023-11-13 05:55 PM] Deciusmus: branch  js_refactor
[2023-11-13 05:56 PM] Deciusmus: I added a few main things:
    
    1. On timeline generation, if the frontmatter has a timelineDescriptor it inserts it as *(timelineDescripter)* in the event text
[2023-11-13 05:56 PM] Deciusmus: 2. The events table generation now works with/requires new metadata
[2023-11-13 05:56 PM] Deciusmus: 3. The aforementioned get_PersonTable
[2023-11-13 07:01 PM] Deciusmus: We should probably just pick a language and call python from JavaScript or vice versa (https://blog.logrocket.com/exploring-jspybridge-library-python-javascript/#importing-javascript-file-python-different-directory)
[2023-11-13 07:02 PM] rsulfuratus: for calculating location, is this supposed to report Tollen as current location?
    
    ```
    whereabouts:
    - type: home
      start: ''
      end: ''
      location: At Sea, Western Gulf
    - type: home
      start: 1722
      end: ''
      location: Tollen, Western Green Sea
    ```
[2023-11-13 07:02 PM] rsulfuratus: currently does not, at least not based on your location script
[2023-11-13 07:02 PM] Deciusmus: As long as the date is after 1722
[2023-11-13 07:02 PM] Deciusmus: There are some bugs
[2023-11-13 07:03 PM] Deciusmus: Also I‚Äôm not sure if end:‚Äô‚Äô is handling perfectly everywhere as opposed to end : undefined
[2023-11-13 07:05 PM] rsulfuratus: i think my python code is less buggy than your java code, at least for the whereabouts info box calculation
[2023-11-13 07:05 PM] rsulfuratus: üòõ
[2023-11-13 07:05 PM] rsulfuratus: that page displays properly if I convert it
[2023-11-13 07:07 PM] rsulfuratus: however based on that link it looks like it might be easier to use javascript functions in python than vice versa
[2023-11-13 07:07 PM] Deciusmus: Which thing is not displaying correctly? I was rewriting stuff to handle the ‚ÄúinLocation‚Äù code better
[2023-11-13 07:08 PM] rsulfuratus: 
![[../_discord_assets/image-DAE29.png]]
[2023-11-13 07:08 PM] rsulfuratus: whereabouts:
    - type: home
      start: 
      end: 
      location: Sembara, Western Green Sea
    - type: home
      start: 1722
      end: 
      location: Tollen, Western Green Sea
[2023-11-13 07:09 PM] rsulfuratus: should show:
    Originally from: Sembara, Western Green Sea
    Based in: Tollen, Western Green Sea
[2023-11-13 07:09 PM] Deciusmus: Yeah. I think there is a stable-sort bug I didn‚Äôt fix
[2023-11-13 07:09 PM] Deciusmus: What if you remove the start date
[2023-11-13 07:10 PM] rsulfuratus: yeah, that works
[2023-11-13 07:10 PM] rsulfuratus: it also works if you have an end in the first home
[2023-11-13 07:11 PM] Deciusmus: That is, JavaScript is basically the worst language in the world and array.sort() isn‚Äôt stable. So I fixed the logic in one case but not all of them
[2023-11-13 07:11 PM] Deciusmus: ‚ÄúStable‚Äù means it keeps the input order for the same keys
[2023-11-13 07:13 PM] Deciusmus: Anyway..
[2023-11-13 07:13 PM] Deciusmus: AFK for a bit
[2023-11-13 07:32 PM] rsulfuratus: so, looking at https://github.com/extremeheat/JSPyBridge some more...
[2023-11-13 07:33 PM] rsulfuratus: i think there is a core of something that could work there
[2023-11-13 07:34 PM] rsulfuratus: the problem is that the javascript code relies a lot on the obsidian api and the dataviewjs api, and i'm not sure if it is possible to import those into python
[2023-11-13 07:35 PM] rsulfuratus: on the other hand, the basic set of metadata utils might be easier to code and maintain in python. python at least seems like a much simpler language to handle e.g. dates and some of the sorting stuff
[2023-11-13 07:37 PM] rsulfuratus: however, that particular package relies on node.js so i have no idea if that is even functional in obsidian
[2023-11-13 07:52 PM] rsulfuratus: theoretically I think the idea would be to have a core set of metadata processing functions written in python, e.g.:
    pass metadata, get current whereabouts
    pass metadata, get origin whereabouts
    pass metadata, get age
[2023-11-13 07:52 PM] rsulfuratus: then, separately code functions in python or javascript to use that information
[2023-11-13 07:53 PM] rsulfuratus: things that are basic reformatting are easy to code in either and there is probably no reason to try to synchronize
[2023-11-13 07:54 PM] rsulfuratus: to export things that require parsing the vault would either require a way to call the obsidian and dataviewjs apis from python, or an alternate approach to get the same kind of information
[2023-11-13 07:54 PM] Deciusmus: Dataview provides a lot of stuff; going to be hard to do via python
[2023-11-13 07:55 PM] rsulfuratus: yes. anything that only requires the information about the current page metadata is straightforward to replicate in python given a core set of functions that return information from metadata
[2023-11-13 07:56 PM] rsulfuratus: anything that requires querying the vault as a database is quite tricky and probably requires finding someone else who has done the coding
[2023-11-13 08:02 PM] Deciusmus: The main problem with Python is that everything has to be wrapped in JS
[2023-11-13 08:03 PM] Deciusmus: It's fine to have like a core Python "get whereabouts state" or "get page existence state" that returns back and object, but to do all the various dynamic bits needs JS functoins
[2023-11-13 08:05 PM] Deciusmus: So I could see, for example, an architecture working where you have a core python lib that returns, for a given page, some set of data like the current/last known/home/origin whereabouts, the regnalData, and the page Existence data
    
    And then the JS functions for Dataview could wrap those
[2023-11-13 08:06 PM] Deciusmus: i.e. 
    
    ```
        inLocation(targetLocation, metadata, targetDate) {
      
            if (!targetDate) targetDate = this.get_pageEventsDate(metadata)
            let current = this.get_currentWhereabouts(metadata, targetDate);
            if (current == undefined || current.location == undefined || current.location == "Unknown") {      
                return false;
            }
    
            let found = this.locationSearch(current.location, targetLocation)
            return found;
        }
    ```
    
    could be somethng like
    
    ```
    inLocation(targetLocation, metadata, targetDate) {
        let whereabouts = pyLib.getWhereaboutsForPage(metadata, targetDate)
         let current = whereabouts.current
    ....
    ```
[2023-11-13 08:07 PM] rsulfuratus: right, that is what I was imaging
[2023-11-13 08:07 PM] rsulfuratus: python just handles metadata in, object out
[2023-11-13 08:08 PM] rsulfuratus: that simplifies debugging and maintanence for basic info boxes
[2023-11-13 08:09 PM] rsulfuratus: it doesn't help with the more fundamental issue about web export. to me, a lot of this metadata stuff feels extremely useful for session prep, information cleanup, and other tracking stuff. but it feels quite challenging to figure out how to incorporate into the webpage
[2023-11-13 08:09 PM] Deciusmus: I wasn't really worrying about that
[2023-11-13 08:09 PM] Deciusmus: I like seeing it for session prep and fun
[2023-11-13 08:09 PM] Deciusmus: and info cleanup
[2023-11-13 08:10 PM] Deciusmus: The only architecture that is likely to work for export is something that captures the rendered data in obsidian
[2023-11-13 08:10 PM] Deciusmus: reimplementing dataview isn't realistic I don't think
[2023-11-13 08:10 PM] rsulfuratus: this is part way there, actually: https://github.com/mfarragher/obsidiantools
[2023-11-13 08:11 PM] Deciusmus: But I bet that is focused on the simple dataview stuff, not dataview JS
[2023-11-13 08:12 PM] rsulfuratus: it looks like it is pretty easy to, for example, get all the notes with the event-source tag, and a DR tag between 1600 and 1700
[2023-11-13 08:12 PM] rsulfuratus: so that is a decent bit of the way there
[2023-11-13 08:12 PM] rsulfuratus: it doesn't implement the task/list tags
[2023-11-13 08:12 PM] rsulfuratus: as far as I can see
[2023-11-13 08:13 PM] Deciusmus: right, but that isn't that close to what dataviewJs lets you do
[2023-11-13 08:13 PM] rsulfuratus: yeah
[2023-11-13 08:13 PM] Deciusmus: my get_EventsTable is doing a **lot** more than that
[2023-11-13 08:19 PM] rsulfuratus: obviously. i think at the moment i'm more interested in getting the basic metadata functions really solid and making sure the python export can handle info boxes smoothly, as well as figuring out the metadata structure for more complex things like places, than solving the web export issue for dataviewjs, which I think is your feeling too
[2023-11-13 08:20 PM] Deciusmus: yeah
[2023-11-13 08:20 PM] Deciusmus: Although I'm also interested in learning a bit of javascript and having the tools to rapidly prototype various types of dynamic exploration of the data
[2023-11-13 08:26 PM] rsulfuratus: it wouldn't take that much fiddling to clean up metadataUtils.py to make it something that could theoretically be imported into Javascript
[2023-11-13 08:28 PM] Deciusmus: I think it would need to be a little differently structured
[2023-11-13 08:28 PM] Deciusmus: but.. it would be doable
[2023-11-13 08:28 PM] Deciusmus: maybe I should learn python instead of Javascript
[2023-11-13 08:29 PM] rsulfuratus: well someone needs to know javascript
[2023-11-13 08:36 PM] rsulfuratus: so looking at the JSPyBridge some more, I think what you'd want is a python function returns all the computed variables on a metadata object, right? 
    
    e.g., in python, you have:
    ```python
    def get_computed_metadata(metadata):
        # code goes here
        return computed_dict
    ```
    
    then, in Javascript:
    ```javascript
    import { python } from 'pythonia'
    const computeMetadata = await python('./metadataUtils.py')
    computed_metadata = await {computeMetadata.get_computed_metadata(metadata)
    ```
[2023-11-13 08:37 PM] Deciusmus: well, maybe
[2023-11-13 08:37 PM] Deciusmus: probably; you'd just want it relatively well structured
[2023-11-13 08:37 PM] Deciusmus: there are also some grey areas .. is the "current" location computed or not
[2023-11-13 08:38 PM] rsulfuratus: i would consider that computed
[2023-11-13 08:39 PM] Deciusmus: I mean, the ideal would be to compute a bunch of stuff...
    
    * Current whereabout
    * Last known whereabout
    * Home whereabout
    * Origin whereabout
    * Start / End date
    * Age
    * Is Alive
    * Is Existing
    * etc
[2023-11-13 08:40 PM] Deciusmus: I don't think your current code actually computes those all correctly though
[2023-11-13 08:40 PM] rsulfuratus: yes
[2023-11-13 08:40 PM] rsulfuratus: i haven't yet found a page that my current code doesn't correctly compute, but i haven't checked everything
[2023-11-13 08:40 PM] rsulfuratus: there could be edge cases
[2023-11-13 08:40 PM] Deciusmus: Well, I mean, I think it is correct to the spec
[2023-11-13 08:40 PM] Deciusmus: But its the wrong
[2023-11-13 08:40 PM] Deciusmus: wrong model
[2023-11-13 08:41 PM] Deciusmus: "current" should be undefined for dead people, for example
[2023-11-13 08:41 PM] Deciusmus: "last known" should potentially be home, if that is the last known place
[2023-11-13 08:41 PM] Deciusmus: a few other similar things
[2023-11-13 08:42 PM] rsulfuratus: i do check when people died, and correctly report nothing for current location
[2023-11-13 08:42 PM] rsulfuratus: i was not positive what to do with last known
[2023-11-13 08:42 PM] rsulfuratus: i played around with setting last known to location when died, but that is not technically last known if it was an away location
[2023-11-13 08:42 PM] Deciusmus: Right I don't mean your dview is wrong, I mean the metadataUtil doen't have the right level of data
[2023-11-13 08:42 PM] Deciusmus: right spec, whatever
[2023-11-13 08:48 PM] rsulfuratus: my parse metadata code does a little too much for one function. i am pretty sure the exact, home, origin, and last locations are correct, but it is probably better to allow a different function to decide what to output when instead of trying to overload that on the same function
[2023-11-13 08:49 PM] rsulfuratus: it relies on setting output to false instead of updating location in some cases, which isn't as correct as you'd want for something you can pass back and forth
[2023-11-13 09:00 PM] Deciusmus: It does assume the whereabouts are sorted by date
[2023-11-13 09:00 PM] Deciusmus: Which is probably reasonable
[2023-11-13 09:01 PM] Deciusmus: at least if I am reading the python correctly it does üôÇ
[2023-11-13 09:01 PM] Deciusmus: who knows?
[2023-11-13 09:02 PM] rsulfuratus: it only assumes this for home without dates
[2023-11-13 09:02 PM] rsulfuratus: or at least it should only assume for homes without dates
[2023-11-13 09:05 PM] rsulfuratus: anyway the exact details don't matter, it is relatively feasible to update this code to return whatever is useful for the javascript if you want to try to use it in javascript, or alternatively to have a wrapper function to generate a formatted dict however the javascript code wants it
[2023-11-13 09:09 PM] rsulfuratus: I'm actually more interested in figuring out location metadata than fiddling with code sychronization
[2023-11-13 09:20 PM] Deciusmus: Yeah
[2023-11-13 09:21 PM] Deciusmus: That‚Äôs reasonable
[2023-11-13 09:21 PM] rsulfuratus: although i am adding a bit of documentation and cleanup to my code right now
[2023-11-13 09:21 PM] rsulfuratus: will push in a bi
[2023-11-13 09:21 PM] rsulfuratus: `*`bit
[2023-11-13 09:22 PM] rsulfuratus: did you look at my location musings in the metadata spec?
[2023-11-13 09:22 PM] Deciusmus: As far as metadata, for places in general I‚Äôm not sure the point in distinguishing much
[2023-11-13 09:23 PM] rsulfuratus: right maybe you just need one place type with a bunch of optional fields
[2023-11-13 09:23 PM] Deciusmus: Why not just have ‚ÄúpartOf‚Äù and ‚Äúlocation‚Äù ? Otherwise the created / destroyed  is optional
[2023-11-13 09:23 PM] Deciusmus: Im a little skeptical of population
[2023-11-13 09:24 PM] Deciusmus: But maybe worth having to help with a standardized header block. But I‚Äôm actually not sure there is much benefit to a standard header
[2023-11-13 09:25 PM] rsulfuratus: one thing that I want to do is move all the pronounciation stuff to metadata, so I can easily make a dataview query for how to pronounce everything - it's a big pain having to click over to each note
[2023-11-13 09:26 PM] Deciusmus: Yes
[2023-11-13 09:26 PM] Deciusmus: Agree with that
[2023-11-13 09:26 PM] rsulfuratus: but I also want it in the header of the note, so in that case having a standardized header, even if it is just:
    ```
    # Name
    *(pronounciation)*
    ```
[2023-11-13 09:26 PM] rsulfuratus: might be worthwhile
[2023-11-13 09:28 PM] rsulfuratus: you also might want to generate a standard "x of y"
[2023-11-13 09:28 PM] Deciusmus: I also want to have standard headers for my session notes although I don‚Äôt know if you want to bother
[2023-11-13 09:29 PM] rsulfuratus: e.g., 
    ```
    # Gold Street
    a ward of [[Tollen]]
    ```
[2023-11-13 09:29 PM] Deciusmus: Yeah
[2023-11-13 09:29 PM] Deciusmus: Although isn‚Äôt that easy enough to type?
[2023-11-13 09:29 PM] rsulfuratus: if it is just one layer, sure
[2023-11-13 09:30 PM] rsulfuratus: if you are doing: [[Tollen]], [[Tollen partOf]]
[2023-11-13 09:30 PM] rsulfuratus: then you want a template I think
[2023-11-13 09:30 PM] Deciusmus: But do you really want:
    # The Crossroads Inn
    an inn in [[Cleenseau]], [[Averil]], [[Sembara]]
[2023-11-13 09:30 PM] Deciusmus: Maybe you do?
[2023-11-13 09:31 PM] rsulfuratus: I'd probably only go two levels up
[2023-11-13 09:31 PM] rsulfuratus: maybe three levels
[2023-11-13 09:31 PM] rsulfuratus: three levels might be overkill for display
[2023-11-13 09:32 PM] Deciusmus: I guess you could have:
    
    - partOf
    - placeType
    - population
[2023-11-13 09:32 PM] Deciusmus: - name
[2023-11-13 09:33 PM] rsulfuratus: right, I was going to say I would like placeType for sure. my DM notes for the Tollen sessions were a lot of copying and pasting of things and embedding notes, it would be a lot faster if I could just do a dataview query for wards of Tollen
[2023-11-13 09:33 PM] Deciusmus: And then generate
    
    # `<Name>`
    (Pronunciation)
    A `<placeType>` in `<partOf>`
    (Population) / getPageDatedValue
[2023-11-13 09:34 PM] rsulfuratus: I'd do:
[2023-11-13 09:34 PM] rsulfuratus: A `<placeType>` in `<partOf>`, `<partOfParent>`
[2023-11-13 09:35 PM] Deciusmus: Right I meant ‚ÄúpartOf‚Äù to be 2 levels up
[2023-11-13 09:35 PM] rsulfuratus: the other question is whether we want to have tags for specific levels of organization. e.g., I saw you using cultureDescriptor to tag the page a specific ancestry links to
[2023-11-13 09:36 PM] Deciusmus: I actually don‚Äôt like that. I‚Äôd rather have something in metadata.json I think that defines page names for species and cultures
[2023-11-13 09:38 PM] Deciusmus: I like keeping the frontmatter simpler
[2023-11-13 09:43 PM] Deciusmus: So I‚Äôd say the header should be:
    
    As is for people / rulers
    As above for locations (anything with type - Location)
    Items tbd
    Anything else will be just
    # name 
    (Pronounciation)
[2023-11-13 09:53 PM] rsulfuratus: okay. I might then run my metadata cleanup one more time and do the following:
    - convert the startStatus, endStatus stuff into a displayDefaults dict with sensible defaults per type
    - output a very short list of required metadata (that is output even if blank): tags, displayDefaults, born/species/ancestry/gender for People; reignEnd/reignStart/died for rulers; placeType, partOf for locations
[2023-11-13 09:53 PM] Deciusmus: Just don‚Äôt make reignEnd default to anything
[2023-11-13 09:53 PM] rsulfuratus: and type of course
[2023-11-13 09:54 PM] Deciusmus: I mess around with death dates it is a pain to have to change reignEnd
[2023-11-13 09:54 PM] rsulfuratus: valid types will be: 
    - Ruler
    - NPC
[2023-11-13 09:54 PM] Deciusmus: It should be optional / not output
[2023-11-13 09:55 PM] rsulfuratus: so just born/species/ancestry/gender for all people, nothing extra for rulers?
[2023-11-13 09:55 PM] Deciusmus: ReignStart for rulers
[2023-11-13 09:55 PM] Deciusmus: On the display status stuff, I think it‚Äôs fine but I‚Äôd drop the pre-exist error
[2023-11-13 09:57 PM] rsulfuratus: valid types would be:
    
    People:
    - Ruler
    - NPC
    - PC
    
    Organization
    Location
    Item
    SessionNote
    
    Events:
    - Event
    - Holiday (maybe)
    - Timeline (maybe)
[2023-11-13 09:57 PM] rsulfuratus: might not even need Events as a type...
[2023-11-13 09:57 PM] Deciusmus: I would not bother with a type for event vs holiday vs timeline
[2023-11-13 09:58 PM] rsulfuratus: is there even any reason to have an Event type at all?
[2023-11-13 09:58 PM] Deciusmus: No, I don‚Äôt think so
[2023-11-13 09:58 PM] Deciusmus: The only reason I can see to have type is to customized the generated header
[2023-11-13 09:59 PM] Deciusmus: For selecting it is better to have tags. 
    
    It could be sensible to have some default tags:
    - person
    - place 
    - event
[2023-11-13 09:59 PM] Deciusmus: - timeline
    - sessionNote
    - item
[2023-11-13 10:00 PM] rsulfuratus: tag organiation is a whole separate issue
[2023-11-13 10:00 PM] Deciusmus: We could even just get rid of type and do tags.contains(person)
[2023-11-13 10:00 PM] Deciusmus: But maybe not something to consider right now
[2023-11-13 10:01 PM] Deciusmus: Btw I was messing around with the idea of changing lastSeenByParty to something like:
    partyKnowledge and allowing prefixes without dates
[2023-11-13 10:01 PM] rsulfuratus: the only problem with tags is it gets a bit much to overload so much information onto them. for example it might be more useful to have a "campaign status" instead of using tags
[2023-11-13 10:02 PM] rsulfuratus: I see you suggested the same thing
[2023-11-13 10:02 PM] Deciusmus: Then I could do dataview queries that would do something like:
    All people who DuFr is aware of
[2023-11-13 10:02 PM] Deciusmus: I‚Äôd rather use tags for selection
[2023-11-13 10:02 PM] Deciusmus: Not organization
[2023-11-13 10:03 PM] Deciusmus: Ie passing ‚Äú#person‚Äù as a filter to data view
[2023-11-13 10:03 PM] rsulfuratus: right
[2023-11-13 10:03 PM] rsulfuratus: maybe a campaign info metadata field would be better
[2023-11-13 10:04 PM] rsulfuratus: e.g. I like to keep track of the importance of NPCs because it is a useful filter for what to work on
[2023-11-13 10:04 PM] rsulfuratus: but you could have campaignInfo ->` dufr ->` "major" or something
[2023-11-13 10:04 PM] Deciusmus: That could make sense as a tag, actually
[2023-11-13 10:04 PM] rsulfuratus: right, I guess it doesn't need to be campaign specific
[2023-11-13 10:04 PM] Deciusmus: You want to use tags for things you want ad-hoc queries on
[2023-11-13 10:05 PM] rsulfuratus: I do have maybe two NPCs who are major in one campaign and background or minor in another...
[2023-11-13 10:05 PM] rsulfuratus: but generally that distinction doesn't really matter
[2023-11-13 10:05 PM] rsulfuratus: how does dataview handle hierarchical tags?
[2023-11-13 10:06 PM] rsulfuratus: i don't like all the clutter on the tag browser from having a million disorganized tags
[2023-11-13 10:06 PM] Deciusmus: i.e.
    
    If you want to rapidly throw together a page of NPCs who are important to DuFr who live in Dunmar, because we are heading back there and you want to make sure up to date, doing something like
    
    get_PersonTable("#DuFr/major and #person", f =>` metautils.inLocation(f, "Dunmar")
    
    seems useful
[2023-11-13 10:07 PM] Deciusmus: Honestly, if I was redoing everything, I would actually propose getting rid of type entirely and just use tags.
    
    I'd start with the "main" tags:
    * person
    * PC
    * ruler
    * item
    * place
    * event
    * timeline
    * sessionNote
[2023-11-13 10:08 PM] Deciusmus: then I'd have the idea of campaign importance tags (which could apply to anything):
    * prefix/major
    * prefix/background
    * prefix/minor
[2023-11-13 10:09 PM] rsulfuratus: so it would be trivial to add all these tags to metadata
[2023-11-13 10:10 PM] rsulfuratus: I guess I was wondering about e.g., if you have `#place`, can you add `#place/settlement` and have `#place` get both `#place` and `#place/settlement`, while `#place/settlement` gets only `#place/settlement`
[2023-11-13 10:10 PM] Deciusmus: I don't know
[2023-11-13 10:10 PM] Deciusmus: but how often do you care?
[2023-11-13 10:11 PM] Deciusmus: I'd rather have a PC have 
    tags: `[ person, PC ]`
    
    then
    
    tags: `[person/PC ]`
[2023-11-13 10:11 PM] Deciusmus: and hope that #person matches both
[2023-11-13 10:12 PM] rsulfuratus: sure, that is a fairly simple case
[2023-11-13 10:12 PM] Deciusmus: although I just tested, it does work
[2023-11-13 10:12 PM] Deciusmus: so nesting is certainly feasible
[2023-11-13 10:12 PM] rsulfuratus: I am more thinking for campaign stuff
[2023-11-13 10:13 PM] rsulfuratus: and for negative queries, e.g. if I want all the stuff that does not have a status tag
[2023-11-13 10:13 PM] Deciusmus: I think I would say that:
    
    (campaignPrefix/*) 
    
    is undefined
[2023-11-13 10:13 PM] Deciusmus: I might not want to do the same things as well
[2023-11-13 10:13 PM] Deciusmus: as you
[2023-11-13 10:15 PM] rsulfuratus: I'm not sure I quite get your point. hierachies under the campaginPrefix would be exclusively for dataview queries and such, you wouldn't use them for frontmatter or headers
[2023-11-13 10:15 PM] Deciusmus: The real question is:
    
    * person, person/PC, person/ruler OR person, PC, ruler
    * place, place/settlement, place/country, place/river OR place, river, settlement, country
    
    etc
[2023-11-13 10:15 PM] Deciusmus: What I mean is your metadata cleanup shouldn't assume anything about campaign tags
[2023-11-13 10:15 PM] rsulfuratus: ah, yes, okay, that makes sense
[2023-11-13 10:16 PM] Deciusmus: And for example, a newly created NPC shouldn't have
    
    tags: `[NPC/DuFr/unsorted, NPC/Clee/unsorted, NPC/GL/unsorted]`
    
    or whatever
[2023-11-13 10:16 PM] Deciusmus: "unsorted" for DuFr would just be "!#DuFr"
[2023-11-13 10:17 PM] rsulfuratus: yes exactly
[2023-11-13 10:17 PM] Deciusmus: if you then wanted ot add a `[DuFr/unaware]` to my NPCs that is fine
[2023-11-13 10:17 PM] Deciusmus: But separately, I was proposing a proper, not-tag-based, mechanism to track campaign info
[2023-11-13 10:20 PM] rsulfuratus: so, I do sometimes use the tab browser, and it is pretty annoying if it gets extremely cluttered. so for that reason I'd probably lean towards nested tags
[2023-11-13 10:20 PM] rsulfuratus: on the other hand, they are more annoying to type if they get more than 2 deep
[2023-11-13 10:21 PM] rsulfuratus: so I think a good mechanism would not necessarily be super-strict
[2023-11-13 10:21 PM] Deciusmus: So replace
    
    lastSeenByParty 
    
    with
    
    campaignInfo:
    - { campaign: (a prefix), date: (a date, optional), type: (a string, optional) }
    
    This would do 2 things:
    
    1. The "last seen by party" template header output would continue to be generated
    2. I'd add some mechanism so that you could do something like:
    
    util.campaignStatus("prefix", "type")
    util.isKnownToCampaign("prefix")
    
    This would make it easy to generate place or NPC tables that contain only those places, NPCs, etc that a party knows about
[2023-11-13 10:22 PM] rsulfuratus: that would be great
[2023-11-13 10:23 PM] Deciusmus: so for example if you had:
    
    - { campaign: DuFr,  date: 1748-01-01, type: met }
    - { campaign: DuFr,  date: 1748-05-01, type: scryed }
    
    It would generate:
    
    * Last met by party (on 1748-01-01): (location)
    * Last scryed by party (on 1748-05-01): (location)
    
    Obviously rare to bother with that level of detail, but it could build up esp in my game where it is not that hard to add that stuff over time
[2023-11-13 10:24 PM] Deciusmus: Then, additionally, if "isKnownToCampaign" returns true if there is any matching entry either with no date or with a date in the past
[2023-11-13 10:24 PM] Deciusmus: and CampaignStatus returns true if a matching type is no date or in past
[2023-11-13 10:24 PM] rsulfuratus: so one thing I am eventually going to write is some code to grab the last time an NPC was mentioned in session notes and backfill all the campaignInfo
[2023-11-13 10:25 PM] Deciusmus: so the 95% case could just be:
    
    campaignInfo: `[ { campaign: DuFr} ]`
    
    that means that DuFr knows about this NPC or place, no one else does
[2023-11-13 10:25 PM] Deciusmus: the 4% case could be:
    
    campaignInfo: `[ { campaign: DuFr, date: somedate } ]`
    
    and then the 1% case could be the actually complicated where you have different dates for met vs scryed vs contacted or whatever
[2023-11-13 10:26 PM] rsulfuratus: that is pretty nice.
[2023-11-13 10:30 PM] rsulfuratus: so to update:
    1. delete endStatus, startPrefix, endPrefix, etc and create displayDefaults instead
    2. delete lastSeenByParty and create campaignInfo instead
    3. delete type and instead add relevant tag (person, place, thing, etc, with for now person/pc and person/ruler)
    4. delete blank metadata except for a small handful of key things: tags, name, born/species/ancestry/gender for people, player for PC, reignStart for rulers, partOf, placeType for locations
[2023-11-13 10:30 PM] Deciusmus: yes
[2023-11-13 10:31 PM] rsulfuratus: what about dates?
[2023-11-13 10:31 PM] rsulfuratus: obviously DR stays; as does DR-end
[2023-11-13 10:31 PM] rsulfuratus: fc-date and fc-end as well
[2023-11-13 10:31 PM] rsulfuratus: realWorldDate
[2023-11-13 10:32 PM] Deciusmus: fc-date and fc-end for reoccurring events
    realWorldDate for sessionNotes
    DR and DR_end for events or session notes (use DR_end not DR-end) as _ is eeasier to manage in JS
[2023-11-13 10:32 PM] Deciusmus: DR_end
[2023-11-13 10:32 PM] Deciusmus: not DR-end
[2023-11-13 10:33 PM] rsulfuratus: oh, also, I am planning on always outputting ka for elves along with born
[2023-11-13 10:34 PM] rsulfuratus: all your parentLocation I'll turn to partOf?
[2023-11-13 10:34 PM] rsulfuratus: or keep parentLocation
[2023-11-13 10:34 PM] Deciusmus: yes
[2023-11-13 10:34 PM] Deciusmus: turn to partOf
[2023-11-13 10:34 PM] Deciusmus: I haven't fixed the JS but that is easy
[2023-11-13 10:36 PM] rsulfuratus: anything else I will pass on untouched if it is not empty, delete if it is empty, and then any additional little cleanup can be done directly with the Properties View in Obisidian
[2023-11-13 10:36 PM] rsulfuratus: that is I think easier than trying to program all the little edge cases
[2023-11-13 10:39 PM] rsulfuratus: oh also I'm going to assume that anything in gazetteer is a place, even though that is not quite strictly true, and add place tags to everything as well as empty partOf: to help make that fast to fill in
[2023-11-13 10:40 PM] rsulfuratus: and I'm going convert `[ stub ]` in tags to `[ status/stub ]` if that doesn't bother you
[2023-11-13 10:43 PM] rsulfuratus: at the moment, I'm not going to clean up tags any more than inserting person, place, thing, person/ruler, person/pc
[2023-11-13 10:45 PM] rsulfuratus: there is a tag wrangler plugin (https://github.com/pjeby/tag-wrangler) so I think probably most tag cleanup is easier done in obsidian itself

