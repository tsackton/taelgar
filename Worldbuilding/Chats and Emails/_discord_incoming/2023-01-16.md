# Discord DM – 2023-01-16

[2023-01-16 12:32 PM] Deciusmus: I may do another round of messing around on the plane home… either getting whereabouts to work or places… any preference or thoughts?
[2023-01-16 12:35 PM] rsulfuratus: whereabouts would be way more useful for running games
[2023-01-16 12:35 PM] rsulfuratus: places might need a bit of thought about what a header looks like
[2023-01-16 12:36 PM] Deciusmus: My basic thought on whereabouts would be to:
    - have the header show the current whereabouts via a dataview query
[2023-01-16 12:36 PM] Deciusmus: - support last known whereabouts if the party last seen date is set
[2023-01-16 12:37 PM] rsulfuratus: Yeah that would be ideal
[2023-01-16 12:37 PM] Deciusmus: - bonus points would be some way for you to have secret whereabouts
[2023-01-16 12:37 PM] rsulfuratus: That would just be a GitHub filter
[2023-01-16 12:37 PM] Deciusmus: But can you add a filter in the yaml?
[2023-01-16 12:38 PM] Deciusmus: I guess you could have an npc that entirely strips
[2023-01-16 12:38 PM] Deciusmus: Right we talked about a secret:1 element in the yaml
[2023-01-16 12:39 PM] rsulfuratus: don't even need that, obsidian understands yaml comments, so you'd just have ## secret at the end of a whereabouts line that needs to be filtered
[2023-01-16 12:40 PM] rsulfuratus: although would need to confirm that the tp code passes along comments unmodified
[2023-01-16 12:41 PM] rsulfuratus: otherwise could just have secret: 1 in the yaml
[2023-01-16 12:42 PM] rsulfuratus: but if you get whereabouts working I can test whether comments get messed up and if so figure out another option
[2023-01-16 12:43 PM] rsulfuratus: this works though:
[2023-01-16 12:43 PM] rsulfuratus: 
![[../_discord_assets/image-3EA4C.png]]
###secret[1] year`
[2023-01-16 12:43 PM] rsulfuratus: works fine for the dv.view code
[2023-01-16 12:46 PM] rsulfuratus: and running the process note template code with yaml comments correctly updates the missing frontmatter fields without changing the comments
[2023-01-16 12:49 PM] rsulfuratus: if you are bored on the plane, I potentially need up to 36 names of Drankorian emperors for tonight...
[2023-01-16 01:15 PM] Deciusmus: Do you have any kind of framework already for some Drankorian emperors?
[2023-01-16 01:16 PM] rsulfuratus: generally names are either Greek or Elvish, depending on whether they are of Peronar (half-elven) or Hkaran (human) ancestry
[2023-01-16 01:17 PM] rsulfuratus: I've got three around Caulaus' era (Helea, Vestian, Euros)
[2023-01-16 01:17 PM] rsulfuratus: and the first 10 or so done
[2023-01-16 01:18 PM] rsulfuratus: there is a long golden age of peace and prosperity from ~628 - 965 or so, basically ending with Helea's reign and the events Caulaus sort of remembers, that has 13 total emperors ending with Helea
[2023-01-16 01:52 PM] Deciusmus: Edrae (peronar; the child emperor, magically cursed to never age, reigned for years as a child)
[2023-01-16 01:53 PM] Deciusmus: Pelois and Cekious, twins
[2023-01-16 01:54 PM] Deciusmus: Eiphis the Blind
[2023-01-16 01:55 PM] Deciusmus: Letusos the Quiet
[2023-01-16 01:55 PM] Deciusmus: Alador the Elf Friend
[2023-01-16 01:57 PM] Deciusmus: Imrodel and her daughter Tariele
[2023-01-16 01:57 PM] Deciusmus: Oros known as the cruel
[2023-01-16 02:00 PM] Deciusmus: Desopho (he), the famed swordsman
[2023-01-16 03:35 PM] rsulfuratus: I'm keeping the latter history of the Drankorian empire secret for now, but for Sembaran history, here is the relevant section of the era of northward expansion
[2023-01-16 03:36 PM] rsulfuratus: | Emperor                    | period         | species/ancestry | notes                                                                                                       | rule start | rule end | rule length | Dwarven |
    | -------------------------- | -------------- | ---------------- | ----------------------------------------------------------------------------------------------------------- | ---------- | -------- | ----------- | ------- |
    | Anates (m)                 | Sembaran wars  | Hkar             | First human emperor; began conquest of Sembaran region                                                      | 331        | 366      | 35          | 4464    |
    | Goristo (m)                | Sembaran wars  | Hkar             | Renowned general and mage                                                                                   | 366        | 433      | 67          | 4499    |
    | Liasa (f)                  | Sembaran wars  | Hkar             | Died under suspicious circumstances                                                                         | 433        | 439      | 6           | 4566    |
    | Estragon (m)               | Sembaran wars  | Peronar          | Victor of contested succession                                                                              | 439        | 451      | 12          | 4572    |
    |
[2023-01-16 03:37 PM] rsulfuratus: oops thought markdown would work
[2023-01-16 03:37 PM] rsulfuratus: should be able to copy to obsidian to get a nice table
[2023-01-16 03:37 PM] rsulfuratus: oh also: 
    | Kylanthe (f)               | First Peace    | Hkar             | Negotiated final settlement of Sembaran wars                                                                | 451        | 499      | 48          | 4584    |
[2023-01-16 03:42 PM] Deciusmus: Mostly got whereabouts working
[2023-01-16 03:42 PM] Deciusmus: Need to implement the current party stuff.
[2023-01-16 03:42 PM] Deciusmus: One annoying thing is that it potentially needs a full date, so the export version of it will need a full date
[2023-01-16 03:44 PM] Deciusmus: Also not sure how it should interact with home region. Currently if whereabouts isn’t set, it populates the initial whereabouts using the home region and born year to set a whereabouts equal to the born year for the home region
[2023-01-16 03:44 PM] rsulfuratus: right
[2023-01-16 03:45 PM] rsulfuratus: that should be fine for most purposes
[2023-01-16 03:45 PM] rsulfuratus: there are people who came from elsewhere but probably should manually edit whereabouts for those people if needed
[2023-01-16 03:45 PM] Deciusmus: Right
[2023-01-16 03:48 PM] Deciusmus: But is it worth having both a “home/based in” and a “current location”?
[2023-01-16 03:48 PM] Deciusmus: For most it’s likely to be the same
[2023-01-16 03:49 PM] rsulfuratus: right, maybe with whereabouts implemented then home/homregion is redundant
[2023-01-16 03:49 PM] Deciusmus: I could delete home region and home when I add whereabouts
[2023-01-16 03:49 PM] rsulfuratus: the original idea was that most NPCs are pinned to a particular location, so home / homeRegion was that location
[2023-01-16 03:50 PM] rsulfuratus: origin / originLocation was used to keep track of npcs from elsewhere (e.g., to get a list of Chardonians in Darba or something)
[2023-01-16 03:50 PM] rsulfuratus: location / locationRegion for NPCs that moved around
[2023-01-16 03:50 PM] rsulfuratus: but whereabouts kind of includes all of those cases
[2023-01-16 03:52 PM] rsulfuratus: the only annoying thing is having to specify a date when someone moved from where they were born to where they live now, which I might not want to have to make up for anyone not from their hometown
[2023-01-16 03:54 PM] rsulfuratus: or rather there is no problem with adding an arbitrary born + 10 years for home / homeRegion, but I want a way to distinguish between "this is an actual date that has been introduced in the world and changing it would retcon something" from "this is an arbitrary date that is needed to allow origin and home to be different"
[2023-01-16 03:56 PM] Deciusmus: I think one day is the right amount of time
[2023-01-16 03:56 PM] Deciusmus: That’s obviously fake
[2023-01-16 03:56 PM] rsulfuratus: yeah that is good. I think particularly for shared NPCs, the implication is that if they moved 1 day after they were born then we should feel free to shift the date
[2023-01-16 03:57 PM] Deciusmus: Yeah
[2023-01-16 03:57 PM] Deciusmus: So then I would generate between 0 and 3 lines
[2023-01-16 03:57 PM] Deciusmus: If no whereabouts, 0
[2023-01-16 03:57 PM] Deciusmus: If a single entry, a single line for that entry
[2023-01-16 03:58 PM] Deciusmus: Hrm
[2023-01-16 03:58 PM] Deciusmus: Let me think…
[2023-01-16 03:58 PM] rsulfuratus: are you thinking for the header? or for converting the current origin/home/location to whereabouts?
[2023-01-16 03:59 PM] Deciusmus: It’s hard to tell the difference between “origin” and “home” vs “home” and “some recent location”
[2023-01-16 03:59 PM] Deciusmus: The header
[2023-01-16 03:59 PM] Deciusmus: To convert id set origin as birth year 01-01, and home as birth year 01-02
[2023-01-16 04:00 PM] rsulfuratus: for the header, I'd do the following:
    
    1) get origin location as a string
    2) get current location as a string
    
    If origin location equals current location, print current location. If origin location doesn't equal current location, print Originally from and Currently at
[2023-01-16 04:01 PM] rsulfuratus: origin location is always location at birth, so that is easy
[2023-01-16 04:02 PM] rsulfuratus: it does mean that the header for someone who is based in a place that is not their origin, and is also currently not at the place they are based in, wouldn't indicate where they are based / usually found
[2023-01-16 04:02 PM] rsulfuratus: it also means that you can't specify location unless you specify birth year, which might be a bit annoying for like generic innkeepers or something where you care about location more than age
[2023-01-16 04:03 PM] rsulfuratus: it might be worth keeping the current home/origin metadata, and just reporting the location as we do know for anyone where whereabouts are empty, to be honest
[2023-01-16 04:04 PM] Deciusmus: I could set 01-01-0001 as the date for unknown people
[2023-01-16 04:04 PM] Deciusmus: And “fix it” if you set born
[2023-01-16 04:04 PM] rsulfuratus: oh that would be nice
[2023-01-16 04:05 PM] rsulfuratus: lets use YYYY-MM-DD though instead of DD-MM-YYYY
[2023-01-16 04:05 PM] Deciusmus: It’s easy to make “originally from” and “currently at” work, I just don’t know if we need a 3rd line
[2023-01-16 04:06 PM] Deciusmus: Sorry yes it actually has to be yyyy-mm-dd for yaml to parse it I think
[2023-01-16 04:06 PM] Deciusmus: One option would be to introduce an optional “basedIn”
[2023-01-16 04:07 PM] rsulfuratus: yeah I don't think a third line is necessary honestly. I can only think of like two or three NPCs where it might be relevant (home != origin and they move around a lot and I care about their location)
[2023-01-16 04:07 PM] rsulfuratus: right optional basedIn would be good
[2023-01-16 04:07 PM] Deciusmus: Right so how about this:
    - convert home/origin as discussed
[2023-01-16 04:07 PM] Deciusmus: - generate 2 header lines if different
[2023-01-16 04:08 PM] Deciusmus: - if there is a optional basedIn and the current location is not equal to based in show a 3rd line (usually in xxx)
[2023-01-16 04:09 PM] Deciusmus: Most npcs have one entry. A fee have a bunch of entries but no basedIn. One or two have 3 lines.
[2023-01-16 04:09 PM] rsulfuratus: yeah that works
[2023-01-16 04:33 PM] rsulfuratus: Delwath reskin -  might take a minute for the DDB database to update
[2023-01-16 04:33 PM] rsulfuratus: https://www.dndbeyond.com/characters/28011726
[2023-01-16 04:35 PM] rsulfuratus: here is summon insect spell to replace summon shadowbeast: https://www.dndbeyond.com/spells/1786492-summon-insect
[2023-01-16 04:36 PM] rsulfuratus: here is class text, based on  email from the summer: https://www.dndbeyond.com/subclasses/855521-yezali
[2023-01-16 04:37 PM] rsulfuratus: at some point I will merge all the blessings into the shield so you don't have 7 items but might not get to it before session tonight
[2023-01-16 04:49 PM] Deciusmus: I pushed  a change to support title: btw
[2023-01-16 04:50 PM] Deciusmus: title: will be used as part of the H1 for an NPC or ruler
[2023-01-16 05:45 PM] Deciusmus: dv.view I'm really struggling with though, it always seems to return "-"
[2023-01-16 07:59 PM] Deciusmus: it turns out it doesn't like async functions
[2023-01-16 08:00 PM] rsulfuratus: ah hmm that must be why my treasure function doesn't work either
[2023-01-16 08:00 PM] Deciusmus: i'm going to have to have a slightly more complex dataview for the whereabouts I think
[2023-01-16 08:01 PM] rsulfuratus: that's fine, as long as it can be regexed out of the text for the python script
[2023-01-16 08:02 PM] rsulfuratus: in other news I don't think dndbeyond likes changing class features for a class you have
[2023-01-16 08:06 PM] Deciusmus: you have to change a level I think
[2023-01-16 08:06 PM] Deciusmus: I was playing with this for one of my pcs
[2023-01-16 08:07 PM] rsulfuratus: a perfect that fixed it
[2023-01-16 08:07 PM] Deciusmus: So, just to recap, what do we want the whereabouts box to say?
[2023-01-16 08:08 PM] Deciusmus: I have current location & last seen by party working
[2023-01-16 08:08 PM] rsulfuratus: Originally from: XX
    Currently (date): XX
[2023-01-16 08:08 PM] Deciusmus: (currently it requires the date entries to be sorted)
[2023-01-16 08:08 PM] rsulfuratus: with optionally Based in: XX if based in is set and different from Currently in:
[2023-01-16 08:08 PM] Deciusmus: so originally from should show as long as it is different from currently?
[2023-01-16 08:09 PM] rsulfuratus: yeah I think so
[2023-01-16 08:09 PM] Deciusmus: so say:
    
    d1: Nardith
    d2: Tokra
    d3: Somewhere in Dunmar
    
    would show:
    
    originally from Nardith
    currently somwhere in Dunmar
[2023-01-16 08:09 PM] Deciusmus: and:
[2023-01-16 08:09 PM] Deciusmus: d1: Tokra
    d2: somewhere in Myreni Gap
    
    would show
    
    Originally from Tokra
    Currently somewhere in the Myreni Gap
[2023-01-16 08:10 PM] rsulfuratus: yes
[2023-01-16 08:10 PM] rsulfuratus: but
    d1: Chardon
    
    would just show
    Currently in Chardon
[2023-01-16 08:10 PM] rsulfuratus: as would:
[2023-01-16 08:11 PM] rsulfuratus: d1: Chardon
    d2: Voltara
    d3: Chardon
[2023-01-16 08:11 PM] rsulfuratus: basically get most recent location and original location; if different show "Originally from: and Currently in:" separately
[2023-01-16 08:11 PM] rsulfuratus: if same show just "Currently in: "
[2023-01-16 08:12 PM] rsulfuratus: if BasedIn is set and different from Currently, add "Based in: "
[2023-01-16 08:12 PM] rsulfuratus: I guess you could also have it say "Based in: " if originally == currently
[2023-01-16 08:12 PM] rsulfuratus: so first check if there is more than one location to show; if yes, show origin + current + (optionally) based
[2023-01-16 08:13 PM] rsulfuratus: if no, just show the one location, and report it as "Based in: "
[2023-01-16 08:13 PM] Deciusmus: btw I was thinking rather than having a "based in" I could have a flag excursion or something on the whereabouts line
[2023-01-16 08:14 PM] Deciusmus: ie.
    
    - {date: xxx, place: xxx, region: xxx, excursion: true }
[2023-01-16 08:14 PM] Deciusmus: would indicate that this whereabout shouldn't be used for the "home region" calculation
[2023-01-16 08:14 PM] Deciusmus: I think that's easier for dataview
[2023-01-16 08:14 PM] Deciusmus: for example
[2023-01-16 08:14 PM] rsulfuratus: yeah that makes sense
[2023-01-16 08:16 PM] rsulfuratus: so then you report origin (first location), home (last non-excursion location), and current (last location)
[2023-01-16 08:16 PM] rsulfuratus: where either origin or current are only displayed if they are not equal to home
[2023-01-16 08:20 PM] Deciusmus: right
[2023-01-16 08:21 PM] Deciusmus: plus last seen by party
[2023-01-16 08:22 PM] rsulfuratus: I think that would just be current if last seen by party exists, right? more recent locations would be encoded in the whereabouts and accessible to queries, but shouldn't be exposed in the header
[2023-01-16 08:22 PM] Deciusmus: if different
[2023-01-16 08:22 PM] Deciusmus: I wasn't sure
[2023-01-16 08:22 PM] Deciusmus: do you want to see in your notes the current location?
[2023-01-16 08:23 PM] Deciusmus: vs the last seen by party?
[2023-01-16 08:23 PM] Deciusmus: the python export can do it differently
[2023-01-16 08:23 PM] rsulfuratus: hmm yeah that's true, that's a good point
[2023-01-16 08:23 PM] rsulfuratus: the python would just report last seen, the obsidian dataview should report both

