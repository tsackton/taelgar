# Discord DM â€“ 2023-11-27

[2023-11-27 09:16 AM] rsulfuratus: mostly working today but currently moving on to try to understand location manager. one question: should we treat commas as legacy/backwards compatibility, or should we make it possible for something like "wandering, north of Tokra" to work equivalently to "wandering north of Tokra"? e.g., if I understand code correctly, LocationManager.isInLocation with a targetLocation of Dunmar will return false for first one (with comma), true for second (w/o comma).
    
    my inclination is either:
    (a) leave things as they are, and treat commas as special, often with unexpected behavior - just don't use them unless you want to turn off location chain building for some reason
    (b) ignore commas entirely, just check if string matches something, if not look for first capital. this will mean that "Karawa, Eastern Dunmar" will be considered a data entry error and (should) turn into "Karawa, Eastern Dunmar, Eastern Dunmar, Dunmar"
    
    I would mildly prefer (b) for simplicity, since you can always turn off location chaining with format: F anyway, but I'm not sure it really matters that much
    
    I haven't written the find capital letter function in Python yet, but planning on designing it as a function that takes a string and returns the position of the first capital letter. then I'd have the note lookup function take a string and checks, in order: 1) if the string exists as a file; 2) if the string exists as an alias; 3) if the string starting from the index of the first capital exists as a file; 4) if the string starting from the first capital exists as an alias. 
    
    In python the linking stuff doesn't matter, there is no reason to ever link a file that doesn't exist for the website, so that part is a lot simpler and we never use the link always type.
[2023-11-27 09:35 AM] Deciusmus: I would be happy to ignore commas
[2023-11-27 09:35 AM] Deciusmus: Makes the code simpler
[2023-11-27 09:36 AM] Deciusmus: But there are a lot of whereabouts today still with old-style data, ie
    
    Kawara, Eastern Dunmar
    Rather than just Karawa
[2023-11-27 09:38 AM] Deciusmus: Iâ€™m pretty sure my capital letter code ignores the first capital letter (to avoid infinite loops) so Kawara, Dunmar would be treated the same as wandering in Dunmar
[2023-11-27 09:38 AM] Deciusmus: ie only Dunmar would be linked
[2023-11-27 09:38 AM] Deciusmus: And inLocation only believes the person is in Dunmar, not Karawa
[2023-11-27 09:39 AM] rsulfuratus: right
[2023-11-27 09:39 AM] Deciusmus: It might be better to in general ignore â€œold stuffâ€ and just fix the data though
[2023-11-27 09:40 AM] rsulfuratus: there are 102 people with commas in location, would take 20 minutes to fix, i'd ignore
[2023-11-27 09:40 AM] rsulfuratus: table whereabouts.location as Loc from "People" where contains(whereabouts.location, ",")
[2023-11-27 09:40 AM] rsulfuratus: i am in general in favor of ignoring backwards compatibilty if it requires more than few lines of code to maintain
[2023-11-27 09:46 AM] Deciusmus: do you want to merge your code_cleanup branch, btw?
[2023-11-27 09:46 AM] rsulfuratus: i can. i am slowly working through all the code to make sure i understand it and simplify if possible, since i am finding it very hard to maintain the python code without actually understanding what the java functions do
[2023-11-27 09:47 AM] Deciusmus: I can also just commit changes there
[2023-11-27 09:47 AM] Deciusmus: if that is easier
[2023-11-27 09:47 AM] rsulfuratus: we should really make the _scripts directory its own repo and make it a submodule of taelgar
[2023-11-27 09:48 AM] Deciusmus: I have 13 minutes until my next meeting and I was going to
    (a) fix the bug where Origin: unknown sometimes doesn't show
    (b) introduce slices, i.e. 2-6 meaning parts 2-6 of the depth tree
[2023-11-27 09:48 AM] rsulfuratus: great
[2023-11-27 09:48 AM] rsulfuratus: i guess commit to code_cleanup for now
[2023-11-27 09:48 AM] rsulfuratus: i'm looking at location manager for next 13 minutes then also have a meeting
[2023-11-27 09:49 AM] Deciusmus: did you implement the "unknown" strings for whereabouts
[2023-11-27 09:50 AM] Deciusmus: I don't see it in the code
[2023-11-27 09:50 AM] rsulfuratus: it is in metadata.json
[2023-11-27 09:50 AM] rsulfuratus: and get_whereabouts
[2023-11-27 09:50 AM] Deciusmus: ah, I see
[2023-11-27 09:50 AM] Deciusmus: there just isn't one for current
[2023-11-27 09:50 AM] Deciusmus: I didn't scroll up enough
[2023-11-27 09:51 AM] rsulfuratus: right, i didn't think you needed a different string for current unknown
[2023-11-27 09:51 AM] rsulfuratus: but could add it, not difficult
[2023-11-27 09:51 AM] Deciusmus: i agree
[2023-11-27 09:51 AM] Deciusmus: just didn't look carefully enough
[2023-11-27 11:04 AM] rsulfuratus: thinking about name processing, i wonder if it is worth having a "standardized name" object, like we have standardized whereabout and standardized date. that could simplify a lot of stuff
[2023-11-27 11:07 AM] rsulfuratus: a standardized name would take any string, and return an object with:
    - bare text: input string
    - file: the file associated with the string, if any
    - prefix: the text before the file
    - suffix: the text after the file (for now always "")
    - alias: the link text, if different from file
    - frontmatter: the file metadata
    - article: the article
    - displayName: the computed descriptive name, e.g. "title name" for people, etc
[2023-11-27 11:07 AM] rsulfuratus: possibly other things as well would be useful
[2023-11-27 11:09 AM] rsulfuratus: that could simplify a ton of stuff, we stick all the normalization code into a normalizeName function
[2023-11-27 11:09 AM] rsulfuratus: and then any kind of lookup can always rely on normalizedName.file as either a) pointing to a real file or b) being null if there is no file
[2023-11-27 11:20 AM] rsulfuratus: that would simplify anything like isInLocation, and would make it a lot easier to tweak name processing if we want to in the future (e.g. to allow "sailing between Western Gulf ports" to auto-link to Western Gulf)
[2023-11-27 11:20 AM] rsulfuratus: or to change how auto-linking works, e.g. only allow dangling links to proper names
[2023-11-27 12:12 PM] Deciusmus: yeah
[2023-11-27 12:12 PM] Deciusmus: it definitely makes sense
[2023-11-27 12:29 PM] rsulfuratus: i have half an hour before my next meeting I might make a preliminary attempt at this
[2023-11-27 12:41 PM] Deciusmus: I'm going to push a location manager cleanup
[2023-11-27 12:42 PM] Deciusmus: (1) supports formats like 2-4r meaning, start at the 2nd location, go until the 4th, exclude regions
    (2) removes special casing of commas. Comma strings are treating like regular strings, so Place Name, RegionName is treated like RegionName for matching purposes
[2023-11-27 12:42 PM] rsulfuratus: great
[2023-11-27 12:46 PM] Deciusmus: In strings like "trapped in Stormcaller Tower", the filter doesn't apply to the "trapped in" part
[2023-11-27 12:46 PM] Deciusmus: i.e. that will always appear
[2023-11-27 12:47 PM] Deciusmus: so if you have "trapped in Stormcaller Tower", format: "2-4" you will get
    
    trapped in Eastern Dunmar, Dunmar, the Central Lowlands Region
[2023-11-27 12:47 PM] Deciusmus: I think that is correct
[2023-11-27 12:47 PM] Deciusmus: But if it isn't, it is too much of  pain to fix in the next few minutes, so we should just log a bug
[2023-11-27 12:48 PM] rsulfuratus: i think it is correct, but this is what the normalized name would handle anyway, so if we want to change that behavior it should be wrapped into the normalized name handling
[2023-11-27 12:48 PM] Deciusmus: yeah, true
[2023-11-27 12:49 PM] Deciusmus: the other slight oddity is I'm making no attempt to handle blanks
[2023-11-27 12:49 PM] Deciusmus: i.e. if you set a format like "Rr" (to exclude regions and also make only regions" you are going to end up with
    
    Based in:
[2023-11-27 12:49 PM] Deciusmus: i.e. a blank
[2023-11-27 12:49 PM] Deciusmus: it doesn't somehow determine thats an "unknown location"
[2023-11-27 12:49 PM] Deciusmus: which, also,  I think is correct
[2023-11-27 12:50 PM] rsulfuratus: yes, that is not an unknown location, it is a undisplayed location
[2023-11-27 12:51 PM] Deciusmus: it would be pretty easy to have it display something like
    
    (location hidden) or (location filtered out)
[2023-11-27 12:51 PM] Deciusmus: I'm not sure the benefit other than to help understand the filter is busted
[2023-11-27 12:53 PM] rsulfuratus: theoretically that would be useful for secret locations for website export
[2023-11-27 12:53 PM] Deciusmus: but we don't support an alternative format for export only, so it doesn't really help much
[2023-11-27 12:53 PM] rsulfuratus: right
[2023-11-27 12:54 PM] Deciusmus: I mean, architecturally, it would be pretty trivial to allow for exportDisplaySettings in the yaml
[2023-11-27 12:54 PM] rsulfuratus: you could change it right before you export and then change it back if you really cared
[2023-11-27 12:54 PM] rsulfuratus: exportDisplaySettings would also be easy
[2023-11-27 12:54 PM] Deciusmus: It wouldn't quite work though
[2023-11-27 12:55 PM] rsulfuratus: you'd need an export format for whereabouts lines
[2023-11-27 12:55 PM] Deciusmus: The only realistic use case is for a campaign I am not in, because otherwise you can't really push the secrets to git anyway
[2023-11-27 12:55 PM] rsulfuratus: for secrets, yes
[2023-11-27 12:56 PM] rsulfuratus: until I figure out a way to add secret filtering to yaml without breaking stuff
[2023-11-27 12:56 PM] Deciusmus: And realistically, I'd be inclined to do something like:
    
    exportDisplaySettings: { whereaboutsCurrent: "Unknown" }
    
    rather than trying to control it at the specific whereabout line. Although I guess having a exportFormat for whereabouts would be easier
[2023-11-27 12:57 PM] rsulfuratus: i think the real use case is if you like having long location chains in obsidian but prefer short ones in the website, or vice versa
[2023-11-27 12:57 PM] rsulfuratus: but it is a pretty low priority feature IMO
[2023-11-27 12:57 PM] Deciusmus: I can actually see the benefit of the export feature for secrets management
[2023-11-27 12:58 PM] rsulfuratus: yeah it would also be useful for secrets management for your campaign
[2023-11-27 12:58 PM] Deciusmus: i.e. when my game gets to the point where the players are trying to figure out where someone is, and I want to be tracking their location via whereabouts (for note-takening convinence), I could just tag a whereabout line as "exportFormat: rR" so that it filters to nothing
[2023-11-27 12:58 PM] Deciusmus: and would display as (location filtered) or something
[2023-11-27 12:59 PM] Deciusmus: it would actually be fairly trivial, your python code would just have to do the equivalent of:
    
    whereaboutsFormat = w.exportFormat ?? w.format
[2023-11-27 12:59 PM] Deciusmus: and that's it
[2023-11-27 01:00 PM] rsulfuratus: i haven't written any string formatting in python and don't plan to until i have time to understand the string formatter class, but yes it will be very easy to implement at the whereabouts level for secret whereabouts
[2023-11-27 01:00 PM] rsulfuratus: and actually should be fairly trivial at the displayDefaults level as well
[2023-11-27 01:02 PM] Deciusmus: yeah, a wee bit harder if you want to merge
[2023-11-27 01:02 PM] Deciusmus: but not really
[2023-11-27 01:03 PM] rsulfuratus: merging dicts in python is pretty easy via the magic of list comprehesion, I think easier than merging javascript objects
[2023-11-27 01:06 PM] Deciusmus: One last bit before I go back to work:
    
    dealing with "Taelgar".
    
    Currently
    (a) it doesn't auto-link
    (b) it is special cased to always return "" when being handled in a location chain
    
    (b) is to prevent
![[../_discord_assets/image-3F741.png]]
[2023-11-27 01:07 PM] rsulfuratus: right, (b) makes sense, but it creates a minorly annoying bug that the string: "floating across Taelgar" becomes "floating across"
[2023-11-27 01:07 PM] rsulfuratus: low priority to fix and might be better handled by a normalized name
[2023-11-27 01:13 PM] Deciusmus: it was something the comma was handling
[2023-11-27 01:13 PM] Deciusmus: i.e. on the Hralgar page, "drifting on the storm, Taelgar" worked because we didn't check anything with commas
[2023-11-27 01:13 PM] Deciusmus: having removed the comma code, it is now "drifting on the storm"
[2023-11-27 01:13 PM] Deciusmus: one simple fix is to include taelgar only if the current depth is 1 or 2
[2023-11-27 01:14 PM] Deciusmus: and also if regions are included
[2023-11-27 01:15 PM] Deciusmus: that actually works pretty nicely
[2023-11-27 01:24 PM] Deciusmus: 
![[../_discord_assets/image-BA4C0.png]]
[2023-11-27 01:24 PM] Deciusmus: 
![[../_discord_assets/image-BF558.png]]
[2023-11-27 01:24 PM] Deciusmus: 
![[../_discord_assets/image-5BEA2.png]]
[2023-11-27 01:25 PM] Deciusmus: 
![[../_discord_assets/image-8ADC2.png]]
[2023-11-27 01:25 PM] Deciusmus: I think it feels about right. You can always set format:1 on the dunmar layer if you don't want it to show taelgar
[2023-11-27 01:26 PM] Deciusmus: 
![[../_discord_assets/image-C7929.png]]
[2023-11-27 01:26 PM] Deciusmus: (Taelgar is link-map'd to Gazeetteer root page)
[2023-11-27 03:08 PM] rsulfuratus: merging pr. will start a new branch for normalized name refactor to avoid messing things up while in flight
[2023-11-27 03:13 PM] rsulfuratus: so occurs to me looking at your commits that a nice side benefit is places can change home now, so e.g. Drankor can report as part of the Drankorian Empire prior to 1059 and something else after
[2023-11-27 03:14 PM] Deciusmus: that is true
[2023-11-27 03:14 PM] rsulfuratus: i think it is probably better not to enforce a strict system on this and see how we feel like using it
[2023-11-27 03:14 PM] Deciusmus: I think there is still a topic to sort out around how the difference between a place and a polity
[2023-11-27 03:15 PM] Deciusmus: but I wanted to just let that develop
[2023-11-27 03:15 PM] rsulfuratus: yeah, i mean conceptually home vs away could map to "physical location" vs "political location"
[2023-11-27 03:15 PM] Deciusmus: or, alternatively, partOf could map to political location
[2023-11-27 03:15 PM] Deciusmus: or affiliations
[2023-11-27 03:15 PM] Deciusmus: but I'm not sure what is correct
[2023-11-27 03:17 PM] rsulfuratus: yeah, me neither. also a bit tricky for location chains - if there is a physical and political location which do you follow?
[2023-11-27 03:21 PM] Deciusmus: I dunno.. if you were looking at a page on a village in Western Cymea what do you want to see?
[2023-11-27 03:21 PM] Deciusmus: or a page on Insingue in 1502
[2023-11-27 03:22 PM] Deciusmus: or even, say Drankor
[2023-11-27 03:22 PM] Deciusmus: in 1748, the page on Drankor should say what?
[2023-11-27 03:22 PM] rsulfuratus: I think generally i'd prefer to see political affialiations
[2023-11-27 03:22 PM] rsulfuratus: e.g. in 1748 Drankor should be Drankor, Desolation of Cha'mutte
[2023-11-27 03:22 PM] rsulfuratus: or something like
[2023-11-27 03:23 PM] Deciusmus: right, that is just a dated "home" for Drankor though
[2023-11-27 03:23 PM] rsulfuratus: but of course a place like Drankor is not part of any larger physical region
[2023-11-27 03:23 PM] Deciusmus: which works nicely for places that logically "moved"
[2023-11-27 03:24 PM] rsulfuratus: there are very few places actually that are contained both within a meaningful political designation and a meaningful physical designation
[2023-11-27 03:24 PM] rsulfuratus: just because we usually haven't bothered naming geographic regions independently of politics
[2023-11-27 03:25 PM] rsulfuratus: or we've left them pretty ambiguous, like Cymea
[2023-11-27 03:25 PM] rsulfuratus: so it might not matter
[2023-11-27 03:25 PM] Deciusmus: a great way to deal with places like Drankor would be origin + home with dated whereabouts actually
    
    a ruin in the Desoluation of Cha'mutte
    was part of the Drankorian Empire
[2023-11-27 03:25 PM] Deciusmus: Well, the same is true on earth. The french Alps is in France, not some other region name
[2023-11-27 03:26 PM] rsulfuratus: i think it is mostly relevant for ruins actually and origin + home is a nice option there
[2023-11-27 03:26 PM] rsulfuratus: e.g. I might want Stormcaller Tower to display as "a tower in Central Dunmar"; "originally built as part of Alcarinque" or something like that
[2023-11-27 03:27 PM] Deciusmus: right
[2023-11-27 03:27 PM] Deciusmus: it actually works very well for ruins
[2023-11-27 03:27 PM] rsulfuratus: or the dwarven outpost, "A ruined trading post in the Sentinel Range. Built (date if known) as part of Ardith"
[2023-11-27 03:27 PM] Deciusmus: the murkier area is conquests and colonies
[2023-11-27 03:28 PM] Deciusmus: Because I think that is the only place where the distinction actually matters
[2023-11-27 03:28 PM] Deciusmus: i.e. the difference between "Sembara" (the country) and "Sembara" (the place) is not worth making. Same for Dunmar
[2023-11-27 03:29 PM] rsulfuratus: that is where you need ruledBy:
    "A city in Western Cymean, Cymean Peninsula"
    "Ruled by Tollen"
[2023-11-27 03:29 PM] rsulfuratus: probably best as an affiliation type
[2023-11-27 03:29 PM] Deciusmus: but if war breaks out between Chardon and Dunmar and Songara is conqueored by Chardon, you'd really like to be able to reflect that somehow
[2023-11-27 03:29 PM] Deciusmus: as distinct from its physical location in western Dunmar
[2023-11-27 03:30 PM] rsulfuratus: i think probably the best model is a ruledBy/partOf affiliation. the display is similar to leader of
[2023-11-27 03:30 PM] rsulfuratus: and affiliations are also naturally dated
[2023-11-27 03:30 PM] rsulfuratus: so if Songara is conquered by Chardon, it can have a dated affiliation with a ruledBy type, so the line just doesn't show prior to that date
[2023-11-27 03:31 PM] Deciusmus: yeah
[2023-11-27 03:31 PM] rsulfuratus: you might not even really need a special affiliation type since affiliations are grouped by title and if you set the title to Ruled by it should work with just default member
[2023-11-27 03:31 PM] Deciusmus: It might be simpler to code/think about as a type: leader on Chardon though
[2023-11-27 03:32 PM] rsulfuratus: but that gets back to the problem of having to edit a different page to change information about songara, which is very messy
[2023-11-27 03:32 PM] rsulfuratus: and also you don't want the information displaying on the Chardonian Empire page
[2023-11-27 03:33 PM] Deciusmus: The challenge is, I think, that I want to add a 
    
    get_RuledBy()
    
    to the header, so I can have a nice little block in the front of Sembara that tells you who the current ruler is
[2023-11-27 03:33 PM] Deciusmus: it seems quite useful, and lets you do cool things like have the page for The Crossroads Inn just show the current proprietor
[2023-11-27 03:34 PM] Deciusmus: The problem is if you can define it both ways, who wins?
[2023-11-27 03:34 PM] Deciusmus: Do you just merge? What if the inn page says "ruledBy: X" and the page for Y says "leaderOf: inn"
[2023-11-27 03:34 PM] Deciusmus: having two places to define the same thing gets messy really fast
[2023-11-27 03:35 PM] Deciusmus: I'm also not convinced that the page you are on is so fixed as that
[2023-11-27 03:36 PM] rsulfuratus: i would just merge and display both if they are different. if that is wrong, you'll see and can fix it
[2023-11-27 03:36 PM] Deciusmus: Imagine I'm filling out the page for the Republic of Auzbez and I make up the fact that they conqueored a bunch of small independent frontier towns. I just set it on the auzbez page
[2023-11-27 03:36 PM] rsulfuratus: yeah you should be able to set it on either page
[2023-11-27 03:38 PM] Deciusmus: Fair enough. But for the moment, if I do anything, it would be to add a "get ruled by" logic to the get affiliations
[2023-11-27 03:38 PM] rsulfuratus: say chardon and dunmar go to war and over the next 3 months chardon slowly conquers places. i don't want the chardonian empire frontmatter to be 20 lines long
[2023-11-27 03:38 PM] Deciusmus: so that Sembara page shows the current ruler
[2023-11-27 03:38 PM] rsulfuratus: that's fine
[2023-11-27 03:38 PM] Deciusmus: that doesn't prevent us adding the back-linking, but it means someone needs to code it
[2023-11-27 03:38 PM] Deciusmus: and the leader ->` place will work
[2023-11-27 03:40 PM] rsulfuratus: i am not likely to think much about new features for a while, my current goal is to just get through the existing code and then support string formatting properly in export, with the option of export-specific formats
[2023-11-27 03:41 PM] rsulfuratus: not likely to touch affiliation code until i'm happy with the string formatting on export, at least
[2023-11-27 03:48 PM] Deciusmus: For affiliations I am trying to add a format override but to keep it simple... do you think it is reasonable to say:
    
    format ->` if specified use else if
    
    formatPast & formatCurrent are specified, use the past for past and the current for current?
[2023-11-27 03:48 PM] Deciusmus: You will know whether you have dates or not
[2023-11-27 03:49 PM] Deciusmus: but you don't know if you are past or current
[2023-11-27 03:52 PM] Deciusmus: 
![[../_discord_assets/image-1F20D.png]]
[2023-11-27 03:53 PM] rsulfuratus: but doesn't that imply that Dunmar is leader of Cleenseau despite text saying Cleenseau conqurerored Dunmar?
[2023-11-27 03:54 PM] Deciusmus: yeah by text was backwards
[2023-11-27 03:54 PM] Deciusmus: it should say Conqueored
[2023-11-27 03:54 PM] Deciusmus: not conqueored by
[2023-11-27 03:56 PM] rsulfuratus: re: format, I would like to generalize basically everything that has more than one line to be able to set the display string for just that entry. so for example if you set "whereaboutsPastHome" on a specific whereabouts line it uses that display string if it is PastHome only. would be the same logic with affliations, e.g. set affiliationPast specifically or whatever
[2023-11-27 03:57 PM] rsulfuratus: it is not obvious to me at the moment how to make that would but I think that is the ideal option. i'd really like to be able to override whereaboutsParty for specific campaignInfo lines, for example
[2023-11-27 03:57 PM] Deciusmus: well here is the real use case of the above:
![[../_discord_assets/image-4A56B.png]]
[2023-11-27 03:58 PM] Deciusmus: but the question is really, do you want to have to type affiliationNoDate or just format
[2023-11-27 04:00 PM] rsulfuratus: right, i don't think you want to have to type affiliationNoDate if you provide a format string for an affiliation without a date, because there is only one thing it could be
[2023-11-27 04:02 PM] rsulfuratus: same for whereaboutsParty, you just want format although there you have to deconvolute whether it is a format string for `<current:>` or a whole thing
[2023-11-27 04:02 PM] Deciusmus: I think for whereabouts you need to say what it is
[2023-11-27 04:03 PM] rsulfuratus: right
[2023-11-27 04:04 PM] Deciusmus: 
![[../_discord_assets/image-FD331.png]]
[2023-11-27 04:04 PM] rsulfuratus: so that gets awkward because what if person X dies, then it stays living aboard
[2023-11-27 04:05 PM] Deciusmus: no it doesn;t
[2023-11-27 04:05 PM] Deciusmus: 
![[../_discord_assets/image-3B701.png]]
[2023-11-27 04:05 PM] rsulfuratus: ah okay, homeFormat = whereaboutsHome then, sure
[2023-11-27 04:05 PM] Deciusmus: 
![[../_discord_assets/image-B8F6A.png]]
[2023-11-27 04:05 PM] rsulfuratus: but why not just use whereaboutsHome?
[2023-11-27 04:06 PM] Deciusmus: so many letters
[2023-11-27 04:06 PM] rsulfuratus: well I think we should make the displayDefaults shorter then
[2023-11-27 04:06 PM] rsulfuratus: i'd be happy to go clean up the code to do that
[2023-11-27 04:06 PM] Deciusmus: sure, that works
[2023-11-27 04:06 PM] rsulfuratus: it will be super annoying to have to remember two different format naming schemes when there are so many
[2023-11-27 04:07 PM] Deciusmus: that is fair enough
[2023-11-27 04:08 PM] Deciusmus: "current" is awkard because it clashes with pageCurrent
[2023-11-27 04:08 PM] Deciusmus: probably actually the structure should be:
    
    displayDefaults: { whereabouts: { home:, pastHome:, etc }, ... rest of stuff }
[2023-11-27 04:09 PM] rsulfuratus: i don't like nested objects like that, i think it will be easier to remember if we just use short letter codes
[2023-11-27 04:09 PM] rsulfuratus: e.g.
    wHome
    wHomePast
    wHomeUnk
    wHomePastUnk
[2023-11-27 04:09 PM] Deciusmus: sure
[2023-11-27 04:09 PM] Deciusmus: that works as well
[2023-11-27 04:10 PM] rsulfuratus: w = whereabouts, a = affiliiations, d = page dates (or p for page)
[2023-11-27 04:10 PM] Deciusmus: but this is messy to me:
![[../_discord_assets/image-655BB.png]]
[2023-11-27 04:10 PM] Deciusmus: I like d
[2023-11-27 04:10 PM] rsulfuratus: you mean wHome instead of Home?
[2023-11-27 04:11 PM] Deciusmus: I think homeFormat is best
[2023-11-27 04:11 PM] Deciusmus: inside the whereabout, "home" is not clearly a format
[2023-11-27 04:11 PM] Deciusmus: I mean, I guess it doesn't matter a ton
[2023-11-27 04:11 PM] rsulfuratus: normalize whereabouts can fix that
[2023-11-27 04:11 PM] Deciusmus: well, yes, in the code clearly normalize can change home ->` homeFormat
[2023-11-27 04:12 PM] Deciusmus: do you want to just type { home: } and remember it means the home format
[2023-11-27 04:12 PM] rsulfuratus: I just really really don't want to have to remember different string codes. so whatever aliases work, you should be able to always pass the same string code via a whereabouts line
[2023-11-27 04:12 PM] rsulfuratus: it should be wHome, not home
[2023-11-27 04:13 PM] rsulfuratus: e.g. if displayDefaults has wHome, wHomePast, then wHome and wHomePast should work in a whereabouts line too
[2023-11-27 04:14 PM] rsulfuratus: homeFormat is confusing to me because does that mean past or current?
[2023-11-27 04:14 PM] rsulfuratus: same with plain home
[2023-11-27 04:14 PM] Deciusmus: that's what we have in display defaults right now
[2023-11-27 04:14 PM] Deciusmus: we have home and pastHome, current and past
[2023-11-27 04:15 PM] rsulfuratus: ah i see you are just stripping the w from the front
[2023-11-27 04:15 PM] rsulfuratus: i would prefer *wHome* to just *home*
[2023-11-27 04:15 PM] rsulfuratus: because it standardized format string vocab
[2023-11-27 04:15 PM] Deciusmus: welll I wrote it to work with wHome, home, and homeFormat
[2023-11-27 04:15 PM] Deciusmus: ðŸ™‚
[2023-11-27 04:16 PM] rsulfuratus: sure as I said I don't care what aliases exist as long as you can alway use whatever is in displayDefaults as well
[2023-11-27 04:20 PM] Deciusmus: So both whereabouts lines,
![[../_discord_assets/image-9543A.png]]
[2023-11-27 04:20 PM] rsulfuratus: that is awesome
[2023-11-27 04:22 PM] rsulfuratus: I'd propose:
    ```
    "startStatus" ->` 
    "endStatus" ->` 
    "whereaboutsOrigin" ->` wOrigin
    "whereaboutsOriginUnknown" ->` wOriginU
    "whereaboutsHome" ->` wHome
    "whereaboutsHomeUnknown" ->` wHomeU
    "whereaboutsPastHome": ->` wPastHome
    "whereaboutsPastHomeUnknown" ->` wPastHomeU
    "whereaboutsCurrent" ->` wCurrent
    "whereaboutsPast" ->` wPast
    "whereaboutsLastKnown" ->` wLast
    "whereaboutsLastKnownNoDate" ->` wLastU
    "whereaboutsUnknown": no longer used, I think
    "whereaboutsParty": ->` wParty
    "pageCurrent": ->` dCurrent
    "pagePastWithStart" ->` dPastStart
    "pagePast": ->` dPast
    "boxName": ->` boxName
    "partOf":  ->` partOf
    "secondaryInfo": ->` boxInfo
    "affiliationNoDate": ->` aNoDate
    "affiliationPast": ->` aPast
    "affiliationCurrent": ->` aCurrent
    "affiliationPastWithStart": ->` aPastStart
    "ddbLinkText": ->` linkText
    "definitiveArticle" ->` Article
    ```
[2023-11-27 04:22 PM] rsulfuratus: Article could just be Art or art or article
[2023-11-27 04:22 PM] rsulfuratus: not sure about startStatus and endStatus
[2023-11-27 04:22 PM] Deciusmus: I'd leave start and end status
[2023-11-27 04:22 PM] Deciusmus: they match the format strings
[2023-11-27 04:23 PM] Deciusmus: I'd make article defArt
[2023-11-27 04:23 PM] rsulfuratus: right and we also have ``<start>` and `<end>`` for dates
[2023-11-27 04:23 PM] Deciusmus: we might want to add indefArt at some point
[2023-11-27 04:23 PM] rsulfuratus: I think I'd also add indefiniteArticle (inArt) which
[2023-11-27 04:23 PM] rsulfuratus: yeah
[2023-11-27 04:24 PM] rsulfuratus: would be nice for those A university things
[2023-11-27 04:24 PM] Deciusmus: yeah
[2023-11-27 04:24 PM] Deciusmus: although only works if you add a page for "university"
[2023-11-27 04:25 PM] Deciusmus: the whereabouts unknown can be deleted
[2023-11-27 04:25 PM] Deciusmus: wLastU should be wLastNoDate
[2023-11-27 04:25 PM] Deciusmus: and I think I might makeit wLastKnown
[2023-11-27 04:26 PM] rsulfuratus: ha oops that was copilot tab completion on wLastU, kind of funny
[2023-11-27 04:26 PM] Deciusmus: slightly more to type but again, it aligns with "`<lastknown>`" in the format strings themselves
[2023-11-27 04:26 PM] rsulfuratus: still keeps everyhing 10 characters or less
[2023-11-27 04:26 PM] Deciusmus: also I would do PastWithStart not PastStart
[2023-11-27 04:27 PM] Deciusmus: PastStart is confusing, that sounds like we use it when we are past the start
[2023-11-27 04:27 PM] Deciusmus: but actually it is used for in-the-past with a start date
[2023-11-27 04:27 PM] rsulfuratus: dPastHasStart
[2023-11-27 04:27 PM] Deciusmus: yeah
[2023-11-27 04:27 PM] Deciusmus: perfect
[2023-11-27 04:28 PM] rsulfuratus: will also use: "affiliationPastWithStart": ->` aPastHasStart
[2023-11-27 04:28 PM] rsulfuratus: ```
    "startStatus" ->` startStatus
    "endStatus" ->` endStatus
    "whereaboutsOrigin" ->` wOrigin
    "whereaboutsOriginUnknown" ->` wOriginU
    "whereaboutsHome" ->` wHome
    "whereaboutsHomeUnknown" ->` wHomeU
    "whereaboutsPastHome": ->` wPastHome
    "whereaboutsPastHomeUnknown" ->` wPastHomeU
    "whereaboutsCurrent" ->` wCurrent
    "whereaboutsPast" ->` wPast
    "whereaboutsLastKnown" ->` wLastKnown
    "whereaboutsLastKnownNoDate" ->` wLastNoDate
    "whereaboutsUnknown": no longer used, I think
    "whereaboutsParty": ->` wParty
    "pageCurrent": ->` dCurrent
    "pagePastWithStart" ->` dPastHasStart
    "pagePast": ->` dPast
    "boxName": ->` boxName
    "partOf":  ->` partOf
    "secondaryInfo": ->` boxInfo
    "affiliationNoDate": ->` aNoDate
    "affiliationPast": ->` aPast
    "affiliationCurrent": ->` aCurrent
    "affiliationPastWithStart": ->` aPastHasStart
    "ddbLinkText": ->` linkText
    "definitiveArticle" ->` defArt
    "indefiniteArticle" ->`indefArt
    ```
[2023-11-27 05:05 PM] rsulfuratus: I am going to attempt to fix all the displayDefault names now. if you have any in flight changes you don't want to deal with merging push them now
[2023-11-27 05:05 PM] rsulfuratus: unless you are already doing this
[2023-11-27 05:07 PM] rsulfuratus: we have rather inconsistent naming, the results of NameManager.getDisplayData is called:
    - displayOptions
    - displayData
    - displayDefaults
    - pageDisplayData
[2023-11-27 05:31 PM] Deciusmus: I donâ€™t have anything relevant in flight. AFK for a while
[2023-11-27 07:42 PM] Deciusmus: 
![[../_discord_assets/image-C8914.png]]
[2023-11-27 07:48 PM] rsulfuratus: btw format: "F" doesn't seem to work anymore, although "F" and "f" are totally redundant now
[2023-11-27 07:49 PM] rsulfuratus: nvm i fixed it
[2023-11-27 08:04 PM] Deciusmus: I just noticed that as well
[2023-11-27 08:05 PM] Deciusmus: Im fixing all the bad dat
[2023-11-27 08:05 PM] Deciusmus: with definitiveArticle instead of defArt and such
[2023-11-27 08:05 PM] Deciusmus: I actually think it should just be art not defARt
[2023-11-27 08:05 PM] Deciusmus: if you have a page that should be "a phasing stone" just set the art to "a" instead of "the"
[2023-11-27 08:05 PM] rsulfuratus: yeah probably, since I don't think we'd use indefArt
[2023-11-27 08:05 PM] rsulfuratus: right
[2023-11-27 08:06 PM] rsulfuratus: pretty trivial to replace defArt with art with a unix one-liner if we want
[2023-11-27 08:11 PM] Deciusmus: I added a Bad Data page
[2023-11-27 08:11 PM] Deciusmus: with a collection of dataview queries for various older ways of doing things
[2023-11-27 08:22 PM] rsulfuratus: i tried to clean up the _MOC content. i moved "useful query" type pages to top-level (with the test case)
[2023-11-27 08:22 PM] rsulfuratus: also moved anything that didn't seem current to old
[2023-11-27 08:22 PM] rsulfuratus: I see you also cleaned stuff, I may have restored some files you deleted
[2023-11-27 08:22 PM] rsulfuratus: feel free to re-delete anything in old
[2023-11-27 08:24 PM] rsulfuratus: still left to write for _MOC stuff is an update on how strings are parsed into names and links but waiting on normalize name refactor for taht
[2023-11-27 08:44 PM] Deciusmus: What type of information would you like to see on a location page like this?
![[../_discord_assets/image-4BFB1.png]]
[2023-11-27 08:48 PM] Deciusmus: sorry,  members of page like that
[2023-11-27 08:49 PM] rsulfuratus: I think probably just species/pronouns/pronunciation
[2023-11-27 08:49 PM] rsulfuratus: or maybe ancestry + species
[2023-11-27 08:50 PM] Deciusmus: 
![[../_discord_assets/image-16141.png]]
[2023-11-27 08:51 PM] Deciusmus: the code is just this:
    
    ```dataviewjs
    const { util } = customJS
    dv.table(`["Person", "Info", "Current Location"]`, 
                dv.pages("#person")
                    .where(f =>` util.isAffiliated(dv.current().file.name, f.file))
                    .map(b =>` `[util.s("`<name>` (`<pronouns>` `<pronunciation>`)", b.file, dv.current().pageTargetDate), util.s("`<ancestry>` `<maintype>`", b.file, dv.current().pageTargetDate), util.s("`<lastknown:2r>` (`<lastknowndate>`)", b.file, dv.current().pageTargetDate)]`))
    ```
[2023-11-27 08:51 PM] rsulfuratus: this reveals a bit of a headache with vehicle locations - would prefer to see the last known location of the Wave Dancer in the first one, but that is a bit trickier
[2023-11-27 08:51 PM] Deciusmus: so it is really easily to change
[2023-11-27 08:52 PM] rsulfuratus: you don't get a last known for the person since current is valid
[2023-11-27 08:52 PM] rsulfuratus: but the location chain stops since the current location is unknown of the wave dancer
[2023-11-27 08:53 PM] Deciusmus: it works
![[../_discord_assets/image-9FC31.png]]
[2023-11-27 08:53 PM] Deciusmus: the issue is that the Wave Dancer has no home
[2023-11-27 08:54 PM] Deciusmus: I guess the issue is that we don't pick up the last known of the wave dancer
[2023-11-27 08:54 PM] rsulfuratus: yeah what is the code you are using to generate that?
[2023-11-27 08:55 PM] Deciusmus: util.s("`<name>` (`<pronouns>` `<pronunciation>`)")
[2023-11-27 08:55 PM] Deciusmus: is just a simplified shorthand for calling stringformatter.getFormattedString
[2023-11-27 08:55 PM] rsulfuratus: no I meant how are you getting last known of wave dancer in the table?
[2023-11-27 08:55 PM] Deciusmus: I changed the date
[2023-11-27 08:55 PM] Deciusmus: the pageTargetDate
[2023-11-27 08:55 PM] Deciusmus: so that it is the current not the last known
[2023-11-27 08:56 PM] rsulfuratus: ah okay
[2023-11-27 08:56 PM] Deciusmus: it only works if the wave dancer has a current date
[2023-11-27 08:56 PM] Deciusmus: i.e. it does follow current correctly, but it won't jump backwards to the last known
[2023-11-27 08:56 PM] rsulfuratus: right, yes, that was my point
[2023-11-27 08:57 PM] rsulfuratus: not sure there is a simple solution
[2023-11-27 08:57 PM] Deciusmus: you would have to allow the inLocation to return a date
[2023-11-27 08:58 PM] Deciusmus: I mean, technically it is quite easy to just follow the last known instead of the current
[2023-11-27 08:58 PM] Deciusmus: actually, it would be really easy
[2023-11-27 08:59 PM] rsulfuratus: following last known would be easy
[2023-11-27 08:59 PM] rsulfuratus: but managing the date would not
[2023-11-27 08:59 PM] Deciusmus: it is
[2023-11-27 08:59 PM] Deciusmus: because the date is its own thing
[2023-11-27 08:59 PM] Deciusmus: it works only for string formats
[2023-11-27 09:00 PM] Deciusmus: but `<lastknowndate>` can generate the right thing
[2023-11-27 09:00 PM] rsulfuratus: no, i mean that I think you don't want to just always follow last known
[2023-11-27 09:00 PM] Deciusmus: just need a new API on location manager to get the "oldest" date in a chain
[2023-11-27 09:01 PM] rsulfuratus: generally speaking, the correct behavior is to follow current
[2023-11-27 09:01 PM] rsulfuratus: and terminate when you hit unknown
[2023-11-27 09:02 PM] Deciusmus: realistically, you probably want a better way to have location containers
[2023-11-27 09:02 PM] rsulfuratus: I think it is only when you are generating the last known whereabout that you want to follow last known
[2023-11-27 09:02 PM] Deciusmus: yeah
[2023-11-27 09:02 PM] rsulfuratus: so it is tricky because getLocationFromPartOfs needs to know if it is generating a lastknown or something else
[2023-11-27 09:02 PM] Deciusmus: more specifically, when you are getting the location chain for the `<lastknown>` format string
[2023-11-27 09:02 PM] rsulfuratus: right
[2023-11-27 09:02 PM] Deciusmus: its just a bool input
[2023-11-27 09:02 PM] Deciusmus: allowFollowLastKnown
[2023-11-27 09:03 PM] Deciusmus: that string formatter passes when it is generating a `<lastknown>`
[2023-11-27 09:03 PM] Deciusmus: then you need a getOldestKnownDateInChain
[2023-11-27 09:03 PM] Deciusmus: which will walk the chain with the same logic
[2023-11-27 09:03 PM] Deciusmus: or something
[2023-11-27 09:04 PM] Deciusmus: don't feel like solving it tonight but it isn't that hard
[2023-11-27 09:05 PM] rsulfuratus: i think the location chains are getting a little complex here. these kinds of things that just have a ton of little bools passed through three functions are really tricky to keep in sync across python and java
[2023-11-27 09:05 PM] Deciusmus: true
[2023-11-27 09:05 PM] rsulfuratus: this is why I want a normalized name because it is much easier to check an object property than pass lots of bools
[2023-11-27 09:36 PM] rsulfuratus: here is a nice one:
![[../_discord_assets/image-B4E72.png]]
[2023-11-27 09:36 PM] rsulfuratus: set wLastKnown to "" for if last known is a party met date
[2023-11-27 09:36 PM] rsulfuratus: nicer than:
![[../_discord_assets/image-1709F.png]]
[2023-11-27 09:37 PM] rsulfuratus: but actually,  this would be a nice use of export formats
[2023-11-27 11:04 PM] Deciusmus: Yeah
[2023-11-27 11:05 PM] Deciusmus: I pushed a bunch of templates btw
[2023-11-27 11:05 PM] Deciusmus: for making nice little tables
[2023-11-27 11:06 PM] Deciusmus: They are:
    
    cities-in
    members-of-org
    members-of-org-historical (includes dead members)
    people-in-or-based-in (only living people, home or last known in the page)
    places-in 
    relationships-of (includes dead people, with an isAlive column)
[2023-11-27 11:09 PM] rsulfuratus: just saw that
[2023-11-27 11:10 PM] rsulfuratus: how do you sort these?
[2023-11-27 11:13 PM] rsulfuratus: nvm got it, just need sort before map which I didn't realize
[2023-11-27 11:38 PM] rsulfuratus: i'm just going to start keeping delwath up to date with the world by adding:
    `{campaign: DuFr, person: Delwath, date: 1748-12-27, type: scryed}` to randompeople
[2023-11-27 11:39 PM] rsulfuratus: ðŸ™‚

