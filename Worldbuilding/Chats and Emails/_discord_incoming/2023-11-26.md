# Discord DM ‚Äì 2023-11-26

[2023-11-26 09:17 AM] rsulfuratus: how do you control location partOf depth now? e.g. if you had `<loc:2>` before
[2023-11-26 09:18 AM] Deciusmus: Do you mean part of? Usually you want current
[2023-11-26 09:18 AM] Deciusmus: Which works with current:2 as before
[2023-11-26 09:18 AM] Deciusmus: Part of is now only for organizations
[2023-11-26 09:18 AM] rsulfuratus: current:2 doesn't do anything
[2023-11-26 09:19 AM] Deciusmus: Hrm it should
[2023-11-26 09:19 AM] rsulfuratus: ah nevermind
[2023-11-26 09:19 AM] rsulfuratus: typo
[2023-11-26 10:14 AM] rsulfuratus: a few comments after fiddling for a bit:
    1. it would be great to move the default required object defined on line 177 of nameManager to metadata.json. it is nice to see all the defaults in one place.
[2023-11-26 10:14 AM] rsulfuratus: 2. i might also change a few of the defaults, minimally I'd set all the locations back to 3 in most cases, and i think "halfling (he/him), of the Charmhearts" generally looks better than "a halfling, he/him of the Charmhearts" -- but this is pretty minor. i might also make some of the affiliation defaults shorter (like not put age/length when there are start/end dates). generally i'd probably default to making the header shorter and more compact, and then use overrides to make it longer when needed
[2023-11-26 10:15 AM] rsulfuratus: 3. the biggest remaining QoL improvement would be to allow format overrides per line in affiliation and campaignInfo
[2023-11-26 10:15 AM] rsulfuratus: e.g. if I have `campaign: dufr, person: Wellby, date: 1730, type: met`
[2023-11-26 10:16 AM] rsulfuratus: I want to be able to generate:
    `Met by Wellby around DR 1730 at The Singing Fox, in Fairgate Outer, the Free City of Tollen`
[2023-11-26 10:16 AM] Deciusmus: For #2 feel free to change defaults whereever you want, I'm not committed to particular defaults
[2023-11-26 10:16 AM] Deciusmus: For #1, on my list
[2023-11-26 10:17 AM] Deciusmus: But the main reason I did it the way I did is it is pain when debugging to have it in metadata.json as you have to remember to reload the metadata which I often forget to do
[2023-11-26 10:17 AM] rsulfuratus: something like:
    `format: `<type>` by `<person>` around `<start>` at `<current:F>` in `<current:f2>``
[2023-11-26 10:17 AM] Deciusmus: it would be fairly trivial to add overrides to affliation and campaign info
[2023-11-26 10:18 AM] rsulfuratus: that would also allow something like different defaults for leaders and non-leaders for affiliations
[2023-11-26 10:18 AM] rsulfuratus: e.g. place: xxx could be shorthand for org: place, type: leader, format: xxxx
[2023-11-26 10:19 AM] rsulfuratus: the tricky bit I think is getting the order of operations right
[2023-11-26 10:19 AM] rsulfuratus: e.g. if you have:
    `{type: home, location: The Singing Fox, format: fr}`
[2023-11-26 10:19 AM] rsulfuratus: and also ``<current:F>`` in your campaignInfo format
[2023-11-26 10:19 AM] rsulfuratus: the campaignInfo should override the whereabouts format string
[2023-11-26 10:21 AM] rsulfuratus: when you determine a format string the order should be something like:
    required defaults `< type defaults `< page defaults `< whereabouts format string `< campaign info format string / affiliation format string
[2023-11-26 10:22 AM] rsulfuratus: the presumption is that if you are adding a specific override string for a campaignInfo line, you know what it should generate and you wantt to have a specific, exact format
[2023-11-26 10:27 AM] Deciusmus: That last bit is hardest
[2023-11-26 10:27 AM] Deciusmus: because the string format doesn't know where the format string is coming from
[2023-11-26 10:30 AM] rsulfuratus: i think the way to do it is just have the string formatter trust the string it is passed and not try to update it
[2023-11-26 10:30 AM] Deciusmus: but it needs to for whereabouts
[2023-11-26 10:31 AM] Deciusmus: anyway, will think about it
[2023-11-26 10:46 AM] rsulfuratus: architecturally, the way I would do this in python is try to build a data object for each page that contained everything - all possible locations, all possible affiliations, all format strings. but, i think that doesn't make sense for the javascript functions which need to work on continually updated pages instead of a fixed directory of static text
[2023-11-26 10:48 AM] rsulfuratus: but i have the feeling that 1300 lines of code is more than we need for what we are trying to do and there is probably a clever way to simpilfy things that would also make some of this easier
[2023-11-26 10:48 AM] rsulfuratus: i'm just not sure what it is yet
[2023-11-26 10:49 AM] Deciusmus: I pushed a spec, fyi
[2023-11-26 10:49 AM] Deciusmus: or more accurately, documentation
[2023-11-26 10:52 AM] Deciusmus: The problem is that the format hierarchies are a bit of a pain here. The simplest would be to have something like ! mean ‚Äúthis wins‚Äù
[2023-11-26 10:53 AM] Deciusmus: So if you have a format string of !f in the party line it wins over the whereabouts format
[2023-11-26 10:54 AM] Deciusmus: That could be useful in general if you wanted a generic table to always show something
[2023-11-26 10:56 AM] rsulfuratus: yes
[2023-11-26 10:59 AM] rsulfuratus: i'm not going to spend a ton of time on this today as I've got other things to do but i am currently trying to just make sure I understand all the new code in case I want to try to work on python implementation
[2023-11-26 11:06 AM] Deciusmus: Makes sense. We are going out hiking today so also not spending much time on it but might implement the ! rule as discussed above. The key for python is to just reimplement the string formatter I think. The get_xxx functions are really simple now
[2023-11-26 01:09 PM] rsulfuratus: assume you are out hiking, i am switching between work work and going over code. opening issues for each class to track questions/potential refactors/potential bugs
[2023-11-26 01:09 PM] rsulfuratus: not going to edit any code at the moment
[2023-11-26 04:19 PM] rsulfuratus: okay lied about not editing code, pushed some edits to code_cleanup branch
[2023-11-26 05:02 PM] Deciusmus: so I think you are not quite right about how whereabouts should work...  I'm leaving some comments on the github issue
[2023-11-26 05:04 PM] Deciusmus: but I do think that last known should contain the current, i.e. last known is never undefined
[2023-11-26 05:22 PM] rsulfuratus: look at the code in code_cleanup, it is way shorter and so far displays identical things, except fixes the bug in Apollyon where it doesn't display a last known location
[2023-11-26 05:23 PM] rsulfuratus: i had to change the part of to check if current location is unknown instead of exists
[2023-11-26 05:24 PM] rsulfuratus: so far the only difference is that if you have a home but not an origin, you get "Origin unknown" text, which I like, but would be easy to remove either via code or a format string
[2023-11-26 05:32 PM] Deciusmus: I am not sure I agree that causing all the locations to exist with "unknowns" is better
[2023-11-26 05:32 PM] Deciusmus: `*`all the whereabouts
[2023-11-26 05:32 PM] rsulfuratus: why not?
[2023-11-26 05:32 PM] Deciusmus: it removes context - you can't decide things based on whether it exists or not
[2023-11-26 05:33 PM] Deciusmus: Maybe there are not any cases you care, but I think origin is at least one of them
[2023-11-26 05:33 PM] Deciusmus: You need some mechanism to conditionally display origin as unknown or not unknown
[2023-11-26 05:33 PM] Deciusmus: But I think it is clearer as a property of the page:
[2023-11-26 05:34 PM] rsulfuratus: so, what I wanted to eventually do was have "display this if it is unknown" be a format string
[2023-11-26 05:34 PM] Deciusmus: i.e. I want to be able to distinguish between "this person's origin is canonically unknown" vs "no thoughts on origin"
[2023-11-26 05:34 PM] Deciusmus: but it shouldn't be a display string
[2023-11-26 05:35 PM] rsulfuratus: I guess I don't see those as being any different
[2023-11-26 05:35 PM] Deciusmus: I think its nicer to add the unknown whereabout than add the display string
[2023-11-26 05:35 PM] Deciusmus: although I suppose it depends on where you come down on the default
[2023-11-26 05:35 PM] Deciusmus: if you think the default should be everyone has an unknown origin, if their home has a start date, I guess that makes sense
[2023-11-26 05:35 PM] rsulfuratus: the use case for a format string is to get:
    Current Location: the Emerald Song, unknown
[2023-11-26 05:36 PM] Deciusmus: but is that an origin?
[2023-11-26 05:36 PM] Deciusmus: that is a home or current whereabout, right?
[2023-11-26 05:36 PM] rsulfuratus: yes, the location chain always follows current
[2023-11-26 05:36 PM] Deciusmus: I mean, more accurately, that is an argument for having the whereabout have a defined unknown location
[2023-11-26 05:37 PM] Deciusmus: But it doesn't have to be so for home and origin, necessarily
[2023-11-26 05:37 PM] rsulfuratus: but back to the origin unknown case, I consider:
    - {type: home, start: 1725, location:  Tollen } 
    to mean that yes, canonically, the origin is unknown
[2023-11-26 05:38 PM] rsulfuratus: the only way you can ever have an unknown origin is to have no known location at birth, which can only arise if you intentionally make it so that there is no known origin at birth
[2023-11-26 05:38 PM] Deciusmus: right although you broke that case I think in your refactor
[2023-11-26 05:38 PM] Deciusmus: But, yes, I see the point. The setting of a start date on home implies unknown origin
[2023-11-26 05:39 PM] Deciusmus: actually nevermind it does work
[2023-11-26 05:44 PM] Deciusmus: Anyway have to start dinner more in a bit though
[2023-11-26 06:26 PM] Deciusmus: So I thought about this some more when I was making dinner (now in the oven) and I think the basic concern is that the codebase is getting littered with "if location == "unknown"" which would be much clearer if the location was just undefined
[2023-11-26 06:28 PM] Deciusmus: That is, I would:
    
    (a) change logic so that last known is returned always (if there is either a last known or a current)
    (b) change logic so that current, lastknown, etc always are returned, but the location is undefined, if it isn't known
    (c) change follow logic for last known so it follows at the last known date only if it is in the past, current date otherwise
    (d) change string formatter so that last known doesn't fall back to current
[2023-11-26 06:29 PM] Deciusmus: Then I would add the following strings to metadata.json
    
    whereaboutsOriginUnknown - used if the origin is not known
    whereaboutsCurrentUnknown - used if the current is not known
    whereaboutsHomeUnknown - used if the home is not known
    whereaboutsLastKnownUnknown - used if the last known is not known
    
    and remove the whereaboutsUnknown
[2023-11-26 06:30 PM] Deciusmus: Then, the get_Whereabouts logic adds the unknown case into the format string generation, i.e. so the "home" string is either past/unknown/etc
[2023-11-26 06:30 PM] rsulfuratus: see, I have the exact opposite opinion. I think that if you want to filter unknown locations, you should explicitly say so in the code
[2023-11-26 06:31 PM] rsulfuratus: so far I've only had to add one single filter, with the get location from parts code
[2023-11-26 06:31 PM] rsulfuratus: everything else works exactly as it is, because the only time it matters if a location is unknown is for display
[2023-11-26 06:31 PM] rsulfuratus: internally, an undefined location is just an unknown location
[2023-11-26 06:31 PM] Deciusmus: see, I disagree
[2023-11-26 06:32 PM] Deciusmus: and you have special cases in the get_whereabouts as well
[2023-11-26 06:32 PM] rsulfuratus: but that is where you should have special cases
[2023-11-26 06:32 PM] rsulfuratus: part of the issue is that java and python have very different ideas about what undefined means
[2023-11-26 06:33 PM] rsulfuratus: filtering on whereabouts.location == "Unknown" works
[2023-11-26 06:33 PM] Deciusmus: I mean, technically this should be null not undefined
[2023-11-26 06:33 PM] Deciusmus: I just didn't know the different when I starting writing the code
[2023-11-26 06:33 PM] Deciusmus: but filtering on !whereabouts.location works better
[2023-11-26 06:34 PM] Deciusmus: I'm not sure what use case you are envisioning
[2023-11-26 06:35 PM] rsulfuratus: filtering on location being falsey requires that:
    a) we add special handling for unknown locations, because by default they get removed
    b) I need to carefully debug python code because falsey is not defined the same way in python and java
[2023-11-26 06:35 PM] Deciusmus: To me, writing code like:
    
    if (home.location == "Unknown") formatStr = whereaboutsUnknownHome
    
    is really messy
[2023-11-26 06:35 PM] rsulfuratus: but it is telling me expiclity what the code is trying to do
[2023-11-26 06:36 PM] Deciusmus: I'm not sure where you are envisioning (a), I guess is the problem
[2023-11-26 06:36 PM] rsulfuratus: it also means that you get the same results for { type: away, location: Unknown } and { type: away } which to me is the desired behavior
[2023-11-26 06:37 PM] rsulfuratus: if I want to generate a table in dataviewjs with all items without defined makers, for example
[2023-11-26 06:37 PM] rsulfuratus: or without defined Owners
[2023-11-26 06:38 PM] Deciusmus: sure, but 
    
    something like:
    
    where(f =>` !util.gw(f).origin.location)
    
    is much more pleasant to read than
    
    where(f =>` util.gw(f).origin.location == "Unknown")
[2023-11-26 06:39 PM] Deciusmus: First, just because it is shorter, so it is nicer
[2023-11-26 06:39 PM] Deciusmus: Second, because the "unknown" logic elides the difference between "not defined" and "defined as not known"
[2023-11-26 06:39 PM] rsulfuratus: So I think the second point is our fundamental disagreement
[2023-11-26 06:39 PM] rsulfuratus: I want to elide that difference
[2023-11-26 06:39 PM] Deciusmus: Why?
[2023-11-26 06:40 PM] Deciusmus: If I am doing data cleanup, I don't want to be bothered with the stuff someone has explicitly defined as unkown
[2023-11-26 06:40 PM] Deciusmus: I'm not sure the use case you want them to be the same, actually
[2023-11-26 06:43 PM] Deciusmus: If I am creating a table of all of the people either in or based in a place, I might do something like:
    
    where(f =>` util.inOrBasedInLoc(f, "Cleenseau")
    map(f =>` `[util.s(f, "`<name>`"), util.s(f, "`<current:1>`")]`
[2023-11-26 06:43 PM] rsulfuratus: so one alternative that might work for both of us is to keep the idea of an unknown whereabout, but just have location = null for unknown whereabouts
[2023-11-26 06:43 PM] Deciusmus: That was my proposal above!
[2023-11-26 06:44 PM] Deciusmus: üôÇ
[2023-11-26 06:44 PM] rsulfuratus: oh I thought you were saying whereabout.origin = null
[2023-11-26 06:44 PM] rsulfuratus: not whereabout.origin.location = null
[2023-11-26 06:44 PM] Deciusmus: no, whereabouts.origin.location
[2023-11-26 06:45 PM] Deciusmus: I am proposing:
    (a) whereabout with no location represents the canonical "undefined" location
    (b) if you want to "force" the whereabout to appear as "defined", you can set the location to something like "unknown" or "somewhere in Taelgar" or "drifting on the winds"
[2023-11-26 06:45 PM] Deciusmus: which is a "defined-undefined"
[2023-11-26 06:45 PM] Deciusmus: and is treated just like any other place
[2023-11-26 06:46 PM] rsulfuratus: it does make the get_Whereabouts logic a little more complex but I think that is manageable
[2023-11-26 06:47 PM] Deciusmus: I actually think it makes it simpler
[2023-11-26 06:47 PM] rsulfuratus: I do not like at all needing to write " type: home, location: unknown" to force an unknown origin, though, that is just pointless extra typing
[2023-11-26 06:47 PM] Deciusmus: You introduce a "unknown" format string for each type
[2023-11-26 06:48 PM] rsulfuratus: originally I was going to propose exactly that - you have a pastKnown, pastUnknown, currentKnown, and currentUnknown for each type
[2023-11-26 06:48 PM] Deciusmus: So the idea is:
    
    this line:
    
    ```originString = StringFormatter.getFormattedString(displayDefaults.whereaboutsOrigin, file, pageYear)```
    
    becomes
    
    ```originString = StringFormatter.getFormattedString(origin.location? displayDefaults.whereaboutsOrigin : displayDefaults.whereaboutsOriginUnknown, file, pageYear)```
[2023-11-26 06:48 PM] Deciusmus: I don't think you need all that complexity
[2023-11-26 06:48 PM] Deciusmus: no one cares about past vs current unknown
[2023-11-26 06:49 PM] Deciusmus: Then, if you want to see "origin: unknown" you just set the display default
[2023-11-26 06:49 PM] Deciusmus: Or rather, the default display default would be Origin: Unknown, if we decided
[2023-11-26 06:49 PM] Deciusmus: whichever way
[2023-11-26 06:50 PM] rsulfuratus: can you think of an example page where a) origin is unknown and b) you don't want unknown origin to be displayed?
[2023-11-26 06:50 PM] rsulfuratus: anyway, we are about to eat dinner
[2023-11-26 06:50 PM] rsulfuratus: i'll think about it a bit
[2023-11-26 06:50 PM] Deciusmus: No
[2023-11-26 06:51 PM] rsulfuratus: treating unknown as special locations feels a bit more complicated to me but I need to think about it
[2023-11-26 07:10 PM] rsulfuratus: okay, so if we use null for unknown locations, what should happen in each of these cases:
    - { type: away, location: unknown}
    - { type: away, location: ""}
    - { type: away, location: }
    - { type: away }
[2023-11-26 07:13 PM] rsulfuratus: and I guess one could add for fun:
    - {type: away, location: null }
    - {type: away, location: undefined }
[2023-11-26 07:16 PM] rsulfuratus: and also, should these be treated the same or different:
    - {type: home, end: 1000 }
    - {type: home, location: home1 }
    
    vs
    
    - {type: home, start: 1001, location: home1 }
[2023-11-26 07:16 PM] rsulfuratus: (presuming born date is `< 1000 or missing)
[2023-11-26 07:17 PM] Deciusmus: Location: unknown implies the string ‚Äúunknown‚Äù right?
[2023-11-26 07:19 PM] Deciusmus: I think the rule is simpler than I made it sound
[2023-11-26 07:19 PM] Deciusmus: Stringformatter.getFormattedString("`<current>`") already returns "Unknown" if there is no current whereabout
[2023-11-26 07:19 PM] Deciusmus: so the rule for get_whereabouts is:
    
    if (home.location == origin.location) {
         output home
    } else {
        output origin
        output home
    }
    
    If (current.location != home.location) {
    if (current.location == lastknown.location) {
             output current
    } else i{
             output current
              output last known
    }
    }
[2023-11-26 07:22 PM] rsulfuratus: that is not quite right, because if current is unknown and home is unknown you still want to output current
[2023-11-26 07:22 PM] Deciusmus: right I guess you want something like:
    
    if (home.location && home.location != current.location)
[2023-11-26 07:23 PM] rsulfuratus: but this implies:
    - {type: home, end: 1000, location: unknown}
    for a date after 1000 with a born before 1000 will return:
    output origin
    output home
    
    because unknown != null
[2023-11-26 07:23 PM] rsulfuratus: but I don't think you want:
[2023-11-26 07:23 PM] Deciusmus: why?
[2023-11-26 07:24 PM] rsulfuratus: there is no valid home so it is null; origin is unknown
[2023-11-26 07:24 PM] Deciusmus: if the only line is type: home, end: 1000, location: Unknown that is both the home and the origin
[2023-11-26 07:24 PM] Deciusmus: Ah, after 1000
[2023-11-26 07:24 PM] Deciusmus: if the current date is after 1000 you will get
    
    Origin: unknown
    Home: unknown
[2023-11-26 07:24 PM] Deciusmus: sure
[2023-11-26 07:25 PM] Deciusmus: I'm not sure that is wrong though
[2023-11-26 07:25 PM] rsulfuratus: this is why i was asking about how to process unknown locations
[2023-11-26 07:25 PM] Deciusmus: Like, why did you write the words:
    
    "location: unknown"
    
    instead of the shorter
    
    "location:"
[2023-11-26 07:26 PM] rsulfuratus: that one might not be wrong, but:
    - {type: home, end: 1000}
    
    should definitely just return:
    Origin: unknown
    
    and 
    - {type: home, end: 1000, location: ""}
    should probably also return 
    Origin: unknown
[2023-11-26 07:26 PM] rsulfuratus: but null != ""
[2023-11-26 07:26 PM] rsulfuratus: and I think null != undefined but I'm not sure because java is weird
[2023-11-26 07:26 PM] rsulfuratus: so you need to convert to null explicity, I think
[2023-11-26 07:27 PM] Deciusmus: I think you are getting bogged down in the implementation
[2023-11-26 07:27 PM] Deciusmus: What are you trying to express with
    
    * type: home, end: 1000
[2023-11-26 07:27 PM] Deciusmus: It seems like, in general, an odd line to ever write on its own
[2023-11-26 07:28 PM] rsulfuratus: moved from somewhere to somewhere but I'm not sure where
[2023-11-26 07:28 PM] rsulfuratus: grash for exampl
[2023-11-26 07:28 PM] Deciusmus: It seems arbitrary to me that you prefer to see
    
    Origin: unknown
    vs
    Home: unknown
[2023-11-26 07:28 PM] rsulfuratus: I just don't want to see both
[2023-11-26 07:28 PM] Deciusmus: but you wont
[2023-11-26 07:29 PM] Deciusmus: assuming "==" is defined in a rational way
[2023-11-26 07:29 PM] rsulfuratus: if one is "" and the other is null you will
[2023-11-26 07:29 PM] rsulfuratus: I think
[2023-11-26 07:29 PM] rsulfuratus: but I don't really understand java falsey-ness very well
[2023-11-26 07:29 PM] Deciusmus: but again, you are getting caught up in (a) trying to make "hard" cases and (b) implementation details
[2023-11-26 07:30 PM] rsulfuratus: well I am trying to change my code to match this spec
[2023-11-26 07:30 PM] Deciusmus: it is kinda reasonable to say a couple of different things
    
    1) we already normalize whereabouts, so it is trivial to decide that "", " ", "     ", undefined, null all equal undefined in the normalization code
    2) we are not writing this code for an arbitrary set of 1000s of users, I'm not convinced there is any reason why it would be difficult to just change the location tag to location:
[2023-11-26 07:31 PM] rsulfuratus: it is one line of code
[2023-11-26 07:31 PM] rsulfuratus: but I have to make a decision about whether falsely values are considered null or not
[2023-11-26 07:31 PM] Deciusmus: Well, I would put it more simply, which is to say that any line that contains only whitespace is considered equal to any line that is contains only whitespace
[2023-11-26 07:33 PM] Deciusmus: if I didn't trust javascript I'd write it as something like
    
    if (location == undefined ||  location == null  || location.length == 0 || location.isWhitespace()) normalizedLoc = undefined
[2023-11-26 07:34 PM] Deciusmus: but I think it is a relatively unimportant bit of logic
[2023-11-26 08:18 PM] Deciusmus: I think this is actually the right logic:
    
    ```if (whereabout.origin.location != whereabout.home.location) {
            // display origin if it is not the same as home //
            displayString += originString + "\n"    
        } 
        
        // always display home
        displayString += homeString + "\n"
    
        // we want to display the current location only if
        //  (a) it is different from home
        //  (b) or we don't have a home
    
        if (!home.location || whereabout.home.location != whereabout.current.location) {        
            displayString += currentString + "\n"
        }
    
        // we display the last known location only if
        //  (a) it is different from current
        //  (b) it is different from home
        //  (c) it is set (i.e. not unknown)
        if (whereabout.lastKnown.location != whereabout.current.location && 
            whereabout.lastKnown.location != whereabout.home.location &&
            whereabout.lastKnown.location) {
            displayString += knownString + "\n"
        }
    ```
[2023-11-26 08:18 PM] Deciusmus: The idea is that we 
    (a) always show home
    (b) show origin if it is not home
    (c) show current if it is different from home or we don't have a home
    (d) show last known if it is different from something we have already shown
[2023-11-26 08:19 PM] rsulfuratus: I think you can simplify (d) - I think you only ever show lastknown if current is unknown
[2023-11-26 08:19 PM] Deciusmus: so change (a) to current is unkown
[2023-11-26 08:19 PM] rsulfuratus: (and lastknown is not unknown)
[2023-11-26 08:20 PM] Deciusmus: do you want to show it if home is known?
[2023-11-26 08:20 PM] Deciusmus: i.e. a last known @ home? I guess
[2023-11-26 08:20 PM] rsulfuratus: yes, if current is unknown
[2023-11-26 08:20 PM] rsulfuratus: or I guess maybe not
[2023-11-26 08:20 PM] rsulfuratus: I'm not sure
[2023-11-26 08:20 PM] Deciusmus: I think only if home is also unknown
[2023-11-26 08:21 PM] rsulfuratus: right, if home is known it implies last known = home
[2023-11-26 08:21 PM] Deciusmus: i.e. if you have
    
    home: X, end: 1100
    
    in 1101
    
    I think you have
    
    home: unknown
    current: unknown
    last known: X
[2023-11-26 08:21 PM] Deciusmus: but I think that is fine
[2023-11-26 08:22 PM] Deciusmus: I actually think you show last known only if both home & current are unknown and it is known
[2023-11-26 08:22 PM] rsulfuratus: I think by default the whereaboutsHomeUnknown = ""
[2023-11-26 08:22 PM] Deciusmus: Oh, I didn't bother with any of that
[2023-11-26 08:22 PM] Deciusmus: I didn't think we needed it?
[2023-11-26 08:23 PM] rsulfuratus: the use case that occurs to me is when you have an item where you want to display " Current owner: unknown"
[2023-11-26 08:23 PM] Deciusmus: isn't that going to work with current location: unknown though
[2023-11-26 08:23 PM] Deciusmus: I actually think the whereaboutsHomeUnkown, etc strings are not that useful
[2023-11-26 08:24 PM] rsulfuratus: so I think the problem is that for items, you have to treat home as special, and away as always an actual location
[2023-11-26 08:24 PM] rsulfuratus: e.g., if you want an item to be "Make in: `<location>`", Owner: `<person>`", how do you do that?
[2023-11-26 08:25 PM] Deciusmus: Do you want to distinguish between the "owner" and the "location"?
[2023-11-26 08:25 PM] Deciusmus: the only reason I can think of to use "type: away" for items is if you want to say: this item is not with its owner
[2023-11-26 08:25 PM] rsulfuratus: sure
[2023-11-26 08:26 PM] rsulfuratus: maybe I'm overcomplicated it
[2023-11-26 08:26 PM] Deciusmus: But I think it is, in general, fine to show:
    
    Origin: unknown
    Home: unknown
    Current Location: unknown
    
    It is rare that anyone bother's to setup whereabouts that would generate that
[2023-11-26 08:26 PM] Deciusmus: So why not show it if you do?
[2023-11-26 08:27 PM] Deciusmus: (and actually, with the rules above, you'd never get that
[2023-11-26 08:27 PM] Deciusmus: it would just be
    
    Origin: somewhere
    home: unknown
    current location: unknown
[2023-11-26 08:27 PM] rsulfuratus: well, won't:
    - {type: home, end: 1700, location: place}
    generate that for anything after 1700?
[2023-11-26 08:27 PM] rsulfuratus: your second thing
[2023-11-26 08:27 PM] Deciusmus: yes
[2023-11-26 08:27 PM] rsulfuratus: that is actually quite common in my experience
[2023-11-26 08:28 PM] Deciusmus: really? what's the in-world example? someone you know left home but you haven't decided where they went?
[2023-11-26 08:28 PM] rsulfuratus: e.g. for an item with a known maker and an unknown owner
[2023-11-26 08:28 PM] rsulfuratus: which is a decent number of items that are worth having whereabouts for
[2023-11-26 08:28 PM] rsulfuratus: that are not possessed by a member of the party
[2023-11-26 08:29 PM] rsulfuratus: it is also common for people who were born somewhere, and are now wandering
[2023-11-26 08:29 PM] rsulfuratus: which is a decent number of NPCs
[2023-11-26 08:29 PM] rsulfuratus: they would usually have subsequent away lines
[2023-11-26 08:30 PM] Deciusmus: I am not convinced - for npcs at least - that it isn't better to just add something like
    
    type: home, location: on the road, start: 1701
[2023-11-26 08:30 PM] Deciusmus: then you get:
    
    origin: somewhere
    home: on the road
    current location location: unknown
    last known location: (somewhere or an away line)
[2023-11-26 08:31 PM] rsulfuratus: but the whole point is they don't have a home
[2023-11-26 08:31 PM] Deciusmus: If I wanted across an NPC of yours, I would strongly prefer to know if you intended them to be wandering or hadn't made up a home
[2023-11-26 08:31 PM] Deciusmus: `*`wandered across
[2023-11-26 08:32 PM] Deciusmus: imagine you have an NPC in Tollen you create, and what you know about them is:
    
    * they were born in Embry
    * they settled in tollen in the 1730s
[2023-11-26 08:33 PM] Deciusmus: I want the whereabouts structure to be able to express the difference between that and
    
    * they were born in Embry
    * they wandered, unsettled, without a fixed home, until the 1730s when they settled in tollen
[2023-11-26 08:33 PM] Deciusmus: The first NPC is fair game to be running an inn in Telham. The second one, probably not
[2023-11-26 08:35 PM] Deciusmus: I mean, it's all a bit edge-case
[2023-11-26 08:36 PM] rsulfuratus: I guess in that case though I would just think you could trust the implicit unknown location
[2023-11-26 08:36 PM] rsulfuratus: Eg if embry has an end date, fair game
[2023-11-26 08:37 PM] rsulfuratus: Rather of embry has an end date, then everything until the next start date is ‚Äútruly unknown could be anywhere‚Äù
[2023-11-26 08:39 PM] rsulfuratus: If embry doesn‚Äôt have an end date, best to assume they moved straight from embry to Tollen
[2023-11-26 08:39 PM] rsulfuratus: I am just not sure why I‚Äôd want to always have to type an extra line instead of just setting an end date
[2023-11-26 08:40 PM] rsulfuratus: The way whereabouts works makes it implicit that dates on home locations have meaning
[2023-11-26 08:41 PM] rsulfuratus: The exception being people like grash or Apollyon who might have secret locations
[2023-11-26 08:41 PM] rsulfuratus: But that is a different challenge
[2023-11-26 08:41 PM] Deciusmus: but I'm not saying you should type an extra line
[2023-11-26 08:41 PM] Deciusmus: I'm saying you shouldn't UNLESS you want the home to be known definitely as "they didn't have a home"
[2023-11-26 08:42 PM] Deciusmus: I'm arguing there is a difference between:
    
    NPC X has an unknown home and
    NPC X has no home
[2023-11-26 08:43 PM] rsulfuratus: I think if you want to communicate a person was in a fixed location but you don‚Äôt know where, you use type = home location = unknown
[2023-11-26 08:43 PM] rsulfuratus: I can‚Äôt think of anyone I‚Äôve made up for whom that is true
[2023-11-26 08:44 PM] Deciusmus: Sorry, I am not sure I am being clear
[2023-11-26 08:44 PM] rsulfuratus: Going back to your Tollen/embry example, the difference for me is whether the origin line has an end
[2023-11-26 08:45 PM] Deciusmus: I don't mean "fixed location, don't know where". I mean a difference between
    
    * I don't know what this person was doing between 1721 and 1742. They could have been having a family, they could have been adventuring, they could have been doing anything
    
    VS
    
    * This person left home in 1721, and wandered about for a while, mostly in greater Sembara, and they ended in 1742 in Tollen
[2023-11-26 08:46 PM] Deciusmus: in both cases you have an end date on home 1 (Embry) of 1721 and a start date on home 2 (Tollen) of 1742
[2023-11-26 08:47 PM] Deciusmus: The real question is, in that period, how do you show the "home" line. The options are:
    
    Origin: Embry
    Home: Unknown
    Current Location: Unknown
    Last Known Location (1721): Embry
    
    VS
    
    Origin: Embry
    Current Location: Unknown
    Last Known Location (1721): Embry
    
    --
    
    Basically, the question is, is there meaning in showing an unknown home
[2023-11-26 08:47 PM] Deciusmus: Previously, we had declared that we don't show unknown anything except current location
[2023-11-26 08:47 PM] Deciusmus: But now we are moving towards showing unknown origins, which is fine, but I am not sure what the argument is for unknown origins but not unknown hoes
[2023-11-26 08:47 PM] Deciusmus: `*`homes
[2023-11-26 08:48 PM] rsulfuratus: Ah okay, yes, in the case where I know someone left embry in 1721 and wandered with no home for a while until they settled in Tollen in 1742, I would probably explicitly set home to ‚Äúunknown‚Äù or ‚Äúwandering‚Äù
[2023-11-26 08:48 PM] rsulfuratus: But that is very rare edge case
[2023-11-26 08:49 PM] Deciusmus: I don
[2023-11-26 08:49 PM] Deciusmus: I don
[2023-11-26 08:49 PM] Deciusmus: argh
[2023-11-26 08:49 PM] Deciusmus: I don't think the question is about representation, exactly. Just what an "unknown" home means in display turns
[2023-11-26 08:49 PM] Deciusmus: `*`terms
[2023-11-26 08:50 PM] rsulfuratus: I would argue a ‚Äúnull‚Äù home should never be displayed
[2023-11-26 08:50 PM] Deciusmus: I just don't understand why home and origin is different
[2023-11-26 08:50 PM] rsulfuratus: I have lots of NPCs from somewhere but who are wanderers with no current home
[2023-11-26 08:51 PM] Deciusmus: see I have lots of NPCs from "not here" but who are settled in Cleenseau with a current home üôÇ
[2023-11-26 08:51 PM] rsulfuratus: Eg Dee Wildcloak, Antonia/Vola arguably, Sura, Havdar arguably,
[2023-11-26 08:51 PM] Deciusmus: I mean, I agree with the origin: unknown, because it helps distinguish
[2023-11-26 08:51 PM] Deciusmus: I actually like being able to set a start on home and get Origin: unknown
[2023-11-26 08:52 PM] Deciusmus: its a quick way to distinguish natives from transplants
[2023-11-26 08:52 PM] rsulfuratus: Exactly
[2023-11-26 08:53 PM] Deciusmus: But for me at least I feel like the same logic applies to home. If I set end: xxx on an NPC in the Cleenseau orbit, I probably mean they left to settle down somewhere else
[2023-11-26 08:54 PM] Deciusmus: it is likely the difference between a game set very heavily in one place, where it is more worthwhile to have details about dozens of minor NPCs, so the PCs keep running into the same people and they develop a bit of versimilitude vs a travelling ame
[2023-11-26 08:54 PM] rsulfuratus: But you will have a current location in that case
[2023-11-26 08:54 PM] Deciusmus: I haven't decided where they have left for
[2023-11-26 08:54 PM] rsulfuratus: Current location unknown then
[2023-11-26 08:54 PM] Deciusmus: yeah, but I like seeing Home: unknown as well
[2023-11-26 08:54 PM] Deciusmus: is my argument
[2023-11-26 08:54 PM] Deciusmus: but I'm not sure I care too much, honestly
[2023-11-26 08:54 PM] Deciusmus: I don't want to make the code more complicated
[2023-11-26 08:55 PM] Deciusmus: But if you don't like the "home: unknown" I'm happy to set the home to never show if null
[2023-11-26 08:55 PM] rsulfuratus: I guess to me:
    Origin: Clee
    Current Location: Unknown
    
    Is pretty clearly a person who left for parts unknown
[2023-11-26 08:55 PM] Deciusmus: in that case I can always add a 
    
    type: home, location: somewhere east of Clee
[2023-11-26 08:55 PM] rsulfuratus: But this is why I was working on having unknown and known display strings
[2023-11-26 08:55 PM] rsulfuratus: Then it is just a question of defaults
[2023-11-26 08:55 PM] Deciusmus: Well, yes, the real solution is that üôÇ
[2023-11-26 08:56 PM] Deciusmus: but it seemed more complicated than it was worth
[2023-11-26 08:56 PM] rsulfuratus: I have it nearly working in my branch
[2023-11-26 08:56 PM] Deciusmus: although this 40 minutes of mostly pointless back and forth argues otherwise üôÇ
[2023-11-26 08:56 PM] rsulfuratus: It is not hard
[2023-11-26 08:56 PM] rsulfuratus: I think the only ones you car about are home and origin
[2023-11-26 08:57 PM] rsulfuratus: Home is the only one that needs 4 display strings
[2023-11-26 08:57 PM] Deciusmus: sure, I mean if you end up deleting whereaboutsUnknown and adding whereaboutsOriginUnknown, whereaboutsHomeUnknown, and whereaboutsCurrentUnknown
[2023-11-26 08:57 PM] Deciusmus: and current, although logically that is the existing whereaboutsUnknown
[2023-11-26 08:57 PM] Deciusmus: which is not used anymore
[2023-11-26 08:58 PM] Deciusmus: I don't think you need 4 for home even
[2023-11-26 08:59 PM] Deciusmus: I guess you need the dead unknown to avoid a special case of blank
[2023-11-26 08:59 PM] Deciusmus: but I can't imagine a scenario where you'd want it anything other than blank
[2023-11-26 09:02 PM] Deciusmus: so you will have:
    
    whereaboutsOriginUnknown
    whereaboutsHomePastUnknown
    whereaboutsHomeUnknown
    whereaboutsCurrentUnknown
[2023-11-26 09:02 PM] Deciusmus: ?
[2023-11-26 09:02 PM] Deciusmus: I presume last known is never shown if it is unknown, that doesn't make sense
[2023-11-26 09:03 PM] Deciusmus: I pushed a fix to stringmanager to your branch
[2023-11-26 09:07 PM] Deciusmus: we should always display origin if it is unknown
[2023-11-26 09:09 PM] Deciusmus: I also pushed the ! stuff
[2023-11-26 09:09 PM] Deciusmus: if the format string has ! we use it, not the whereabout format
[2023-11-26 09:44 PM] rsulfuratus: pushed some more updates
[2023-11-26 09:46 PM] rsulfuratus: going to clean up setting default displayDefaults and then go to bed

