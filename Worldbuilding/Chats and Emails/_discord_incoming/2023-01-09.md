# Discord DM â€“ 2023-01-09

[2023-01-09 12:21 PM] Deciusmus: this is basically the org that current taelgarverse site is using?
[2023-01-09 12:21 PM] rsulfuratus: yes
[2023-01-09 12:21 PM] Deciusmus: I like it
[2023-01-09 12:22 PM] Deciusmus: I may need to come up with a better way to handle divergence between 1719 and 1748 for people, but this won't impact that
[2023-01-09 12:23 PM] Deciusmus: (For example, I don't want Robert I's death date to be visible to my PCs)
[2023-01-09 12:24 PM] rsulfuratus: yeah the NPC info is a bit tricky to make seemless. there is probably some way to make the basic info block be regenerated
[2023-01-09 12:24 PM] Deciusmus: I don't really need it seemless because I don't plan on exposing the general folder
[2023-01-09 12:25 PM] Deciusmus: but for specific NPCs that appear in both places and where the details matter, I probably need a solution
[2023-01-09 12:25 PM] Deciusmus: One comment would be the PC folder, it might make sense to split it by campaign
[2023-01-09 12:26 PM] rsulfuratus: yeah I was debating the PC folder. especially because it is currently a bit unwieldy with all the guest players, but also because I was going to add Mawar and Isaac's Great Library campaign
[2023-01-09 12:26 PM] Deciusmus: I like having it shared
[2023-01-09 12:26 PM] Deciusmus: that part is fine. But I might want to only publish in the sidebar the pcs from my game
[2023-01-09 12:26 PM] rsulfuratus: yeah probably having PCs split into subdirs by campaign would make it simplest
[2023-01-09 12:27 PM] Deciusmus: yeah
[2023-01-09 12:28 PM] Deciusmus: also with the shared people folder we are much more likely to come across name clashes
[2023-01-09 12:28 PM] rsulfuratus: that just makes the world more realistic
[2023-01-09 12:28 PM] Deciusmus: But I think that is probably relatively easy to handle either via folders or (from XXX) or whatever to distinguish
[2023-01-09 12:29 PM] Deciusmus: Yeah, the name clashes should exist. My Sembaran royal family has lots of them
[2023-01-09 12:29 PM] rsulfuratus: I already have one name clash from the Deno'qai, there are two Zevi's
[2023-01-09 12:29 PM] rsulfuratus: I just add "of the" or "from"
[2023-01-09 12:29 PM] Deciusmus: yeah that works
[2023-01-09 12:31 PM] Deciusmus: Feel free to merge your reorg btw when you get a chance
[2023-01-09 12:31 PM] rsulfuratus: okay
[2023-01-09 12:32 PM] Deciusmus: I'm about to go grab lunch but then I'm going to spend a bit of time adding NPCs from my first session last night
[2023-01-09 12:32 PM] rsulfuratus: okay let me merge reorg to main now then
[2023-01-09 12:32 PM] Deciusmus: yeah that would be good
[2023-01-09 12:52 PM] Deciusmus: The one problem with shared NPCs is stuff like this:
    
    https://github.com/tsackton/taelgar/blob/main/People/Fey/Agata.md
[2023-01-09 12:53 PM] Deciusmus: A lot of dead links there for me, and some back link weirdness if end up with a session 28
[2023-01-09 12:53 PM] rsulfuratus: right. one thing I was going to do soon is to rename all the session notes to something like DF: Session 1
[2023-01-09 12:53 PM] rsulfuratus: that way I can have great library or mawar sessions as well without causing problems
[2023-01-09 12:54 PM] rsulfuratus: that would at least fix the backlink issues
[2023-01-09 12:54 PM] rsulfuratus: but info leaking across campaigns is harder to generically fix
[2023-01-09 12:58 PM] rsulfuratus: you could have a callout box for campaign events. would be kind of cool for someone like vistra (or lyra) who ends up interacting with PCs from multiple campaigns
[2023-01-09 12:58 PM] rsulfuratus: it would still be random information lurking around but that doesn't really bother me too much. I don't think for example that you are going to use Agata as a major enemy in your campaign, since obviously she can't be killed by your players without causing a major divergence
[2023-01-09 12:59 PM] Deciusmus: yeah
[2023-01-09 01:00 PM] Deciusmus: So my basic thinking is:
    * It is kinda cool to have a ready made set of pre-made characters who can be shared across campaigns, and that was one of the goals for the date convergence
    * I really don't care if one of my PCs knows that Vistra ends up in Tokra in 50 years or whatever
[2023-01-09 01:00 PM] Deciusmus: * Broken links are a bit annoying, but really only because of linting tools and similar that will find broken links
[2023-01-09 01:00 PM] Deciusmus: * Incorrect backlinks are in fact something we should try to avoid
[2023-01-09 01:02 PM] rsulfuratus: yeah, agree with all of this. incorrect backlinks should be pretty easy by just naming session notes with a campaign prefix, which I'm going to do anyway so I can track multiple campaigns in one vault
[2023-01-09 01:03 PM] Deciusmus: Finally.. there are a small number of cases where I think it might be important to have different versions of the same document.
    
    My plan was to have a CleenseauCampaign specific version, i.e. 
    
    ElaineII-CleenseauCampaign
    
    And then have a script that replaces and restores the "real" version before publishing to the web
[2023-01-09 01:04 PM] Deciusmus: this I'd only use for key plot stuff, like for example the fact that in 1722 Robert I is reveleated to be a lich
[2023-01-09 01:05 PM] rsulfuratus: right, that makes sense. basically anything where there is a historical event that is guaranteed to happen (so is history, from the point of view of Dunmar campaign) but hasn't happened yet in Cleenseau campaign.
[2023-01-09 01:06 PM] rsulfuratus: this may become more relevant if, for example, you all ever go to Sembara in the Dunmar campaign
[2023-01-09 01:06 PM] Deciusmus: right
[2023-01-09 01:07 PM] Deciusmus: It also might be worth thinking about spoiler tags for "medium" stuff
[2023-01-09 01:07 PM] Deciusmus: That is, each NPC has differing levels of importance in each campaign
[2023-01-09 01:08 PM] Deciusmus: I think by far the most likely source of overlap is background in both, or minor in one and background in the other
[2023-01-09 01:09 PM] Deciusmus: It is probably worth putting "post my game" events under a spoiler tag for NPCs that originating as minor NPCs in my game that are being reused in yours.
[2023-01-09 01:13 PM] Deciusmus: And if the games ever end up in more co-located geographies we can tweak process a bit.
[2023-01-09 01:19 PM] Deciusmus: Do you know if there is a way to regenerate a template other than deleting and recreating?
[2023-01-09 01:49 PM] Deciusmus: where would you put something like "The Cleenseau Garrison of the Army of the West"?
[2023-01-09 01:50 PM] Deciusmus: My pcs met Ida, the captain, and at least for my own notes I want a article about her command structure
[2023-01-09 01:50 PM] Deciusmus: Gazeteer? or Organizations?
[2023-01-09 01:50 PM] Deciusmus: I would think Gazeteer... but what do you think?
[2023-01-09 01:50 PM] rsulfuratus: could be gazeteer or organizations...gets a bit tricky
[2023-01-09 01:51 PM] rsulfuratus: I don't have a good consistent set of rules for what goes in each. e.g., the Dunmari mystai cults could easily be in cosmology/religion
[2023-01-09 01:53 PM] rsulfuratus: one solution might be to tag organizations specifically with an organization tag, and not have a specific organization directory. they go in gazetteer/`<geographic location>`, cosmology/religion, or people/groups, depending on whether they are associated with a particular country/place (Sembaran armies, Deno'qai tribes, Chardonian societies), religion (Dunmari mystery cults), or ambiguous (The Cleansed, The Rangers)
[2023-01-09 01:55 PM] rsulfuratus: I am also going to start tagging NPCs with DF (if introduced in Dunmari Frontier campaign), GL (Isaac's campaign), MC (Mawar), etc. You can add if things are introduced in your campaign. that gives an easy way to track game-relevant info as the vault grows
[2023-01-09 01:57 PM] rsulfuratus: the solution for dynamic NPC information is probably dataview plus customjs plugin.
[2023-01-09 01:57 PM] rsulfuratus: https://github.com/saml-dev/obsidian-custom-js
[2023-01-09 01:59 PM] rsulfuratus: tricky bit would be getting it to work with the obsidian html export. it would mean the templater template would be a dataview block that would load information from fantasy calendar and the yaml frontmatter. but would need that to be exportable to html, which it might not be. or might require some hacky fiddling to get it to work.
[2023-01-09 02:41 PM] Deciusmus: I like People\Groups + Gazetter
[2023-01-09 02:45 PM] Deciusmus: https://github.com/obsidian-html/obsidian-html/issues/271
[2023-01-09 02:52 PM] rsulfuratus: hmm that is pretty nice. could probably actually get pretty tricky using the fantasy calendar "today" feature to set up a bunch of javascript/dataview blocks to build pages appropriate for a given time. I'm not concerned if it takes an hour to export for the website so could get quite complicated
[2023-01-09 02:55 PM] Deciusmus: My main concern would be if it got complicated to actually use obsidian in play to read the note ðŸ™‚
[2023-01-09 02:55 PM] rsulfuratus: well it would work fine in reader view always, since that is what you render with the plugins
[2023-01-09 02:55 PM] Deciusmus: Right, I guess it would potentially just be tricky when editing the note at times
[2023-01-09 02:56 PM] rsulfuratus: yeah, you'd have gibberish javascript blocks instead of markdown in source view
[2023-01-09 03:29 PM] Deciusmus: location: "[[Cleenseau]]"
    will correctly link the location
[2023-01-09 04:42 PM] rsulfuratus: dataview and especially dataviewjs is ridiculously flexible, and in theory you can have a separate script with all the javascript. unless you have 'source view' checked it keeps rendered blocks in the edit view, so not even annoying to edit
[2023-01-09 04:43 PM] rsulfuratus: my javascript is not good enough to (quickly) figure it out, but in theory it should be possible to move all the code in the template to an external script and replace it with a dataviewjs block that creates the entire summary info appropriate for the current day based on fantasy calendar
[2023-01-09 04:43 PM] rsulfuratus: in principle it should even be possible to load a Chronology or Events section from another (non-exported) note or notes that auto-populates a chronology correct for the time.
[2023-01-09 04:46 PM] rsulfuratus: I'd still need to hide future events for Dunmar behind `%%`SECRET `%%` tags or have a future events note that is not shared, but otherwise might be pretty nice
[2023-01-09 04:47 PM] rsulfuratus: just need to figure out the javascript to auto-build the NPC bio information and the chronology/events information. maybe also a location section
[2023-01-09 04:48 PM] rsulfuratus: anyway something to play around with
[2023-01-09 07:44 PM] rsulfuratus: ha. got it working (very preliminarily)
[2023-01-09 08:06 PM] rsulfuratus: here is what I'm working on. DataviewTest has the code to render npc frontmatter with dataviewjs and customjs. npcUtils.js is the (current) class with functions that is loaded. one issue so far, is I'm not sure how to access the fantasy calendar api in either the customjs script or the dataviewjs block
[2023-01-09 08:07 PM] rsulfuratus: 
Attachment (npcUtils.js):
```js
class npcUtils {
    getPronouns(gender,pronouns) {
        
        // if pronouns are defined in note metadata, use those
        
        if (pronouns) {
            return pronouns
        }

        // otherwise calculate pronouns from note metadata gender
        
        if (gender == "male") {
            return "he/him"
        } else if (gender == "female") {
            return "she/her"
        } else if (gender == "nonbinary") {
            return "they/them"
        }

        // if no gender, return unknown gender

        return "unknown gender"
    }
    getSpecies(species) {
        if (!species) {
            return "unknown species"
        } else {
            return species
        }
    }
    getAncestry(ancestry) {
        if (ancestry) {
            return " (" + ancestry + ")"
        }
        return ""
    }
}
```
Attachment (DataviewTest.md):
```md
---
name: Tester
gender: nonbinary
species: elf
ancestry: Drankorian
---

```dataviewjs
await forceLoadCustomJS();
const {npcUtils} = customJS
let pronouns = npcUtils.getPronouns(dv.current().gender, dv.current().pronouns)
let species = npcUtils.getSpecies(dv.current().species)
let ancestry = npcUtils.getAncestry(dv.current().ancestry)
dv.header(1,dv.current().name)
dv.span(">[!info]+ Biographical Summary" + "\n" + ">" + species + ancestry + ", " + pronouns + "\n")

```
```
[2023-01-09 08:15 PM] rsulfuratus: anyway, seems like it would have potential for autogenerating a lot of stuff
[2023-01-09 08:36 PM] Deciusmus: FantasyCalendarAPI doesn't work?
[2023-01-09 08:46 PM] rsulfuratus: not in the dataviewjs block
[2023-01-09 08:46 PM] rsulfuratus: ```Evaluation Error: TypeError: Cannot read properties of undefined (reading 'current')
        at eval (eval at `<anonymous>` (plugin:dataview), `<anonymous>`:3:58)
        at async DataviewJSRenderer.render (plugin:dataview:19766:13)```
[2023-01-09 08:48 PM] rsulfuratus: same error but at npcUtils.getCurrentYear if I add ```getCurrentYear() {
            return FantasyCalendarAPI.getCalendars()`[0]`.current.year
        }```
[2023-01-09 08:54 PM] rsulfuratus: this maybe has a clue: https://github.com/saml-dev/obsidian-custom-js/issues/35
[2023-01-09 08:56 PM] Deciusmus: it is probably window.FantastyCalendarAPI
[2023-01-09 08:56 PM] Deciusmus: (spelled correctly)
[2023-01-09 09:01 PM] rsulfuratus: hmm that kinda works but it doesn't look like the information about what the current date is from fantasy calendar is passed correctly
[2023-01-09 09:01 PM] rsulfuratus: `window.FantasyCalendarAPI.getCalendars()`[0]`` is undefined and so .current and .current.year don't return anything
[2023-01-09 09:23 PM] Deciusmus: https://github.com/fantasycalendar/obsidian-fantasy-calendar/issues/76
[2023-01-09 09:24 PM] Deciusmus: Might be the issue if you read into the details
[2023-01-09 09:24 PM] Deciusmus: If the data view is trying to process before the calendar data has loaded
[2023-01-09 11:04 PM] Deciusmus: If you want to see the session notes for my game : https://msackton.github.io/taelgar1720/
[2023-01-09 11:09 PM] rsulfuratus: btw I figured out the calendar issue, somehow when I was copying things with iCloud I lost my calendar data, so there was nothing there anyway. restored from backup and it is working
[2023-01-09 11:10 PM] rsulfuratus: I almost have npcUtils working to autogenerate a NPC biosketch from yaml + javascript. if the died yaml is after current date, it acts like the person is alive
[2023-01-09 11:12 PM] rsulfuratus: are you generating your NPC list from dataview? or is that manual

