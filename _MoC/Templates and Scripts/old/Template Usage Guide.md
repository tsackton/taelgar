# Templates Documentation

This file contains documentation for the usage of the templates within the templates folder. Currrently, there are three major complex templates for management of headers and metadata.

## generate-header
This template generates a header block based on the metadata within the frontmatter of the file. It currently generates a Wikipedia style bio-block based on the page type:

#### NPCS
>[!info]+ Biographical Summary
> (species) ((ancestry)) (pronouns)
> [[Page Dates#get_PageDatedValue|get_PageDatedValue]] (if elf: ka)
> [[Whereabouts and Location Specification (old)#get_Homewhereabouts|get_HomeWhereabouts]]
> ([[Whereabouts and Last Seen By Party (old)|Last Seen by Party Info]])
> [[Whereabouts and Location Specification (old)#get_CurrentWhereabouts|get_CurrentWhereabouts]]

The species and ancestry sections are linked if possible:
* species outputs a link to the page with a matching "speciesDescriptor: " frontmatter tag
* ancestry outputs a link to the page with the matching "cultureDescriptor:" frontmatter tag

If no link is found, these output as raw text.

### PCs
Currently identical to NPCs

### Rulers 
>[!info]+ Biographical Summary
> (species) ((ancestry)) (pronouns)
> [[Page Dates#get_PageDatedValue|get_PageDatedValue]] (if elf: ka)
>[[Page Dates#get_RegnalValue|get_RegnalValue]]
>> [[Whereabouts and Location Specification (old)#get_Homewhereabouts|get_HomeWhereabouts]]
>> ([[Whereabouts and Last Seen By Party (old)|Last Seen by Party Info]])
>> [[Whereabouts and Location Specification (old)#get_CurrentWhereabouts|get_CurrentWhereabouts]]

### Items

>[!info]+ Summary
>>Worth: (gpValue) gold pieces
>>Owner: (owner)
>>Maker: (maker)
>>  [[Page Dates#get_PageDatedValue|get_PageDatedValue]] 
>>  Mechnics (linked to D&D Beyond)
## regenerate-header
This template is expected to be run on files with a type already defined. The primary usage of this is to delete the header generated by generate-header and reinsert the generate-header template. This allows a quick refresh of a header after changing metadata.

This template will delete data from your file, and uses raw read/write APIs from the Obsidian Vault API. It is recommended that you save your file before running this in order to ensure that the template is always reading the newest data from disk.

The header is defined as the set of lines between the end of the YAML frontmatter and the first blank line.

This template makes no use of configuration. 

### updateFrontmatter
This template updates the front matter section to remove or fixup some old ways of doing things and then calls regenerate-header. It should be considered somewhat dangerous and may be buggy.

#### Configuration Rules

The configuration file has a single property, `types`, which is an array of type objects. Each type object has:
* A string type name, i.e. NPC, Item, Building
* An array of strings, frontmatter, which is a list of the frontmatter to insert for this type
* An array of strings, initial tags, which is a list of tags to set for this type if the type has no tags
* An array of strings, typeFolderNames, which is a list of regexes that will be applied to the full relative path of the file to auto-determine the type. Note that order matters, i.e. the code uses the first match. So if you have a match on People and one on PCs, make sure the PCs is listed first in the file as People is also in the PC 

Note that the JavaScript function used by the template allows for a parameter for setting the type, so instead of making complex regex it is also possible to just define a ruler or PC type and have those invoked with different hotkeys to create a PC or Ruler as needed.

Example file:
```json
{
    "types": [
        {
                "typeName": "NPC",
                "typeFolderNames": [ "People" ],
                "frontmatter": [
                    "species",
                    "born",
                    "ancestry",
                    "gender",
                    "died",                    
                    "affiliations"
                ],      
                "supportsWhereabouts": true,
                "initialTags": [
                    "NPC/unsorted"
                ]            
        },
       {
                "typeName": "Item",
                "typeFolderNames": [ "Things" ],
                "frontmatter": [
                    "created",
                    "destroyed",
                    "magic",
                    "dbbLink"
                ],      
                "initialTags": [
                    ""
                ]            
        }

    ]

}
```

This also supports a custom map, in `taelgarConfig.json`, that maps from file type -> folder -> default tags. Currently this only supports the leaf folder name but may be enhanced in the future to include regex support.